var Box2D={};(function(b,f){if(!(Object.prototype.defineProperty instanceof Function)&&Object.prototype.__defineGetter__ instanceof Function&&Object.prototype.__defineSetter__ instanceof Function){Object.defineProperty=function(j,h,g){if(g.get instanceof Function){j.__defineGetter__(h,g.get)}if(g.set instanceof Function){j.__defineSetter__(h,g.set)}}}function c(){}b.inherit=function(g,h){var j=g;c.prototype=h.prototype;g.prototype=new c;g.prototype.constructor=j};b.generateCallback=function e(h,g){return function(){g.apply(h,arguments)}};b.NVector=function a(j){if(j===f){j=0}var h=new Array(j||0);for(var g=0;g<j;++g){h[g]=0}return h};b.is=function d(h,g){if(h===null){return false}if((g instanceof Function)&&(h instanceof g)){return true}if((h.constructor.__implements!=f)&&(h.constructor.__implements[g])){return true}return false};b.parseUInt=function(g){return Math.abs(parseInt(g))}})(Box2D);var Vector=Array;var Vector_a2j_Number=Box2D.NVector;if(typeof(Box2D)==="undefined"){Box2D={}}if(typeof(Box2D.Collision)==="undefined"){Box2D.Collision={}}if(typeof(Box2D.Collision.Shapes)==="undefined"){Box2D.Collision.Shapes={}}if(typeof(Box2D.Common)==="undefined"){Box2D.Common={}}if(typeof(Box2D.Common.Math)==="undefined"){Box2D.Common.Math={}}if(typeof(Box2D.Dynamics)==="undefined"){Box2D.Dynamics={}}if(typeof(Box2D.Dynamics.Contacts)==="undefined"){Box2D.Dynamics.Contacts={}}if(typeof(Box2D.Dynamics.Controllers)==="undefined"){Box2D.Dynamics.Controllers={}}if(typeof(Box2D.Dynamics.Joints)==="undefined"){Box2D.Dynamics.Joints={}}(function(){Box2D.Collision.IBroadPhase="Box2D.Collision.IBroadPhase";function ae(){ae.b2AABB.apply(this,arguments)}Box2D.Collision.b2AABB=ae;function aB(){aB.b2Bound.apply(this,arguments)}Box2D.Collision.b2Bound=aB;function aQ(){aQ.b2BoundValues.apply(this,arguments);if(this.constructor===aQ){this.b2BoundValues.apply(this,arguments)}}Box2D.Collision.b2BoundValues=aQ;function D(){D.b2Collision.apply(this,arguments)}Box2D.Collision.b2Collision=D;function F(){F.b2ContactID.apply(this,arguments);if(this.constructor===F){this.b2ContactID.apply(this,arguments)}}Box2D.Collision.b2ContactID=F;function aj(){aj.b2ContactPoint.apply(this,arguments)}Box2D.Collision.b2ContactPoint=aj;function aG(){aG.b2Distance.apply(this,arguments)}Box2D.Collision.b2Distance=aG;function g(){g.b2DistanceInput.apply(this,arguments)}Box2D.Collision.b2DistanceInput=g;function p(){p.b2DistanceOutput.apply(this,arguments)}Box2D.Collision.b2DistanceOutput=p;function U(){U.b2DistanceProxy.apply(this,arguments)}Box2D.Collision.b2DistanceProxy=U;function m(){m.b2DynamicTree.apply(this,arguments);if(this.constructor===m){this.b2DynamicTree.apply(this,arguments)}}Box2D.Collision.b2DynamicTree=m;function aO(){aO.b2DynamicTreeBroadPhase.apply(this,arguments)}Box2D.Collision.b2DynamicTreeBroadPhase=aO;function aA(){aA.b2DynamicTreeNode.apply(this,arguments)}Box2D.Collision.b2DynamicTreeNode=aA;function S(){S.b2DynamicTreePair.apply(this,arguments)}Box2D.Collision.b2DynamicTreePair=S;function T(){T.b2Manifold.apply(this,arguments);if(this.constructor===T){this.b2Manifold.apply(this,arguments)}}Box2D.Collision.b2Manifold=T;function M(){M.b2ManifoldPoint.apply(this,arguments);if(this.constructor===M){this.b2ManifoldPoint.apply(this,arguments)}}Box2D.Collision.b2ManifoldPoint=M;function W(){W.b2Point.apply(this,arguments)}Box2D.Collision.b2Point=W;function aa(){aa.b2RayCastInput.apply(this,arguments);if(this.constructor===aa){this.b2RayCastInput.apply(this,arguments)}}Box2D.Collision.b2RayCastInput=aa;function n(){n.b2RayCastOutput.apply(this,arguments)}Box2D.Collision.b2RayCastOutput=n;function h(){h.b2Segment.apply(this,arguments)}Box2D.Collision.b2Segment=h;function aE(){aE.b2SeparationFunction.apply(this,arguments)}Box2D.Collision.b2SeparationFunction=aE;function aM(){aM.b2Simplex.apply(this,arguments);if(this.constructor===aM){this.b2Simplex.apply(this,arguments)}}Box2D.Collision.b2Simplex=aM;function B(){B.b2SimplexCache.apply(this,arguments)}Box2D.Collision.b2SimplexCache=B;function aU(){aU.b2SimplexVertex.apply(this,arguments)}Box2D.Collision.b2SimplexVertex=aU;function at(){at.b2TimeOfImpact.apply(this,arguments)}Box2D.Collision.b2TimeOfImpact=at;function aJ(){aJ.b2TOIInput.apply(this,arguments)}Box2D.Collision.b2TOIInput=aJ;function aN(){aN.b2WorldManifold.apply(this,arguments);if(this.constructor===aN){this.b2WorldManifold.apply(this,arguments)}}Box2D.Collision.b2WorldManifold=aN;function aH(){aH.ClipVertex.apply(this,arguments)}Box2D.Collision.ClipVertex=aH;function ac(){ac.Features.apply(this,arguments)}Box2D.Collision.Features=ac;function aR(){aR.b2CircleShape.apply(this,arguments);if(this.constructor===aR){this.b2CircleShape.apply(this,arguments)}}Box2D.Collision.Shapes.b2CircleShape=aR;function d(){d.b2EdgeChainDef.apply(this,arguments);if(this.constructor===d){this.b2EdgeChainDef.apply(this,arguments)}}Box2D.Collision.Shapes.b2EdgeChainDef=d;function aL(){aL.b2EdgeShape.apply(this,arguments);if(this.constructor===aL){this.b2EdgeShape.apply(this,arguments)}}Box2D.Collision.Shapes.b2EdgeShape=aL;function ai(){ai.b2MassData.apply(this,arguments)}Box2D.Collision.Shapes.b2MassData=ai;function aK(){aK.b2PolygonShape.apply(this,arguments);if(this.constructor===aK){this.b2PolygonShape.apply(this,arguments)}}Box2D.Collision.Shapes.b2PolygonShape=aK;function aw(){aw.b2Shape.apply(this,arguments);if(this.constructor===aw){this.b2Shape.apply(this,arguments)}}Box2D.Collision.Shapes.b2Shape=aw;Box2D.Common.b2internal="Box2D.Common.b2internal";function ap(){ap.b2Color.apply(this,arguments);if(this.constructor===ap){this.b2Color.apply(this,arguments)}}Box2D.Common.b2Color=ap;function z(){z.b2Settings.apply(this,arguments)}Box2D.Common.b2Settings=z;function R(){R.b2Mat22.apply(this,arguments);if(this.constructor===R){this.b2Mat22.apply(this,arguments)}}Box2D.Common.Math.b2Mat22=R;function s(){s.b2Mat33.apply(this,arguments);if(this.constructor===s){this.b2Mat33.apply(this,arguments)}}Box2D.Common.Math.b2Mat33=s;function ad(){ad.b2Math.apply(this,arguments)}Box2D.Common.Math.b2Math=ad;function av(){av.b2Sweep.apply(this,arguments)}Box2D.Common.Math.b2Sweep=av;function f(){f.b2Transform.apply(this,arguments);if(this.constructor===f){this.b2Transform.apply(this,arguments)}}Box2D.Common.Math.b2Transform=f;function au(){au.b2Vec2.apply(this,arguments);if(this.constructor===au){this.b2Vec2.apply(this,arguments)}}Box2D.Common.Math.b2Vec2=au;function ar(){ar.b2Vec3.apply(this,arguments);if(this.constructor===ar){this.b2Vec3.apply(this,arguments)}}Box2D.Common.Math.b2Vec3=ar;function H(){H.b2Body.apply(this,arguments);if(this.constructor===H){this.b2Body.apply(this,arguments)}}Box2D.Dynamics.b2Body=H;function o(){o.b2BodyDef.apply(this,arguments);if(this.constructor===o){this.b2BodyDef.apply(this,arguments)}}Box2D.Dynamics.b2BodyDef=o;function am(){am.b2ContactFilter.apply(this,arguments)}Box2D.Dynamics.b2ContactFilter=am;function ak(){ak.b2ContactImpulse.apply(this,arguments)}Box2D.Dynamics.b2ContactImpulse=ak;function y(){y.b2ContactListener.apply(this,arguments)}Box2D.Dynamics.b2ContactListener=y;function C(){C.b2ContactManager.apply(this,arguments);if(this.constructor===C){this.b2ContactManager.apply(this,arguments)}}Box2D.Dynamics.b2ContactManager=C;function P(){P.b2DebugDraw.apply(this,arguments);if(this.constructor===P){this.b2DebugDraw.apply(this,arguments)}}Box2D.Dynamics.b2DebugDraw=P;function E(){E.b2DestructionListener.apply(this,arguments)}Box2D.Dynamics.b2DestructionListener=E;function aC(){aC.b2FilterData.apply(this,arguments)}Box2D.Dynamics.b2FilterData=aC;function aP(){aP.b2Fixture.apply(this,arguments);if(this.constructor===aP){this.b2Fixture.apply(this,arguments)}}Box2D.Dynamics.b2Fixture=aP;function a(){a.b2FixtureDef.apply(this,arguments);if(this.constructor===a){this.b2FixtureDef.apply(this,arguments)}}Box2D.Dynamics.b2FixtureDef=a;function aS(){aS.b2Island.apply(this,arguments);if(this.constructor===aS){this.b2Island.apply(this,arguments)}}Box2D.Dynamics.b2Island=aS;function v(){v.b2TimeStep.apply(this,arguments)}Box2D.Dynamics.b2TimeStep=v;function t(){t.b2World.apply(this,arguments);if(this.constructor===t){this.b2World.apply(this,arguments)}}Box2D.Dynamics.b2World=t;function e(){e.b2CircleContact.apply(this,arguments)}Box2D.Dynamics.Contacts.b2CircleContact=e;function u(){u.b2Contact.apply(this,arguments);if(this.constructor===u){this.b2Contact.apply(this,arguments)}}Box2D.Dynamics.Contacts.b2Contact=u;function N(){N.b2ContactConstraint.apply(this,arguments);if(this.constructor===N){this.b2ContactConstraint.apply(this,arguments)}}Box2D.Dynamics.Contacts.b2ContactConstraint=N;function V(){V.b2ContactConstraintPoint.apply(this,arguments)}Box2D.Dynamics.Contacts.b2ContactConstraintPoint=V;function b(){b.b2ContactEdge.apply(this,arguments)}Box2D.Dynamics.Contacts.b2ContactEdge=b;function az(){az.b2ContactFactory.apply(this,arguments);if(this.constructor===az){this.b2ContactFactory.apply(this,arguments)}}Box2D.Dynamics.Contacts.b2ContactFactory=az;function l(){l.b2ContactRegister.apply(this,arguments)}Box2D.Dynamics.Contacts.b2ContactRegister=l;function w(){w.b2ContactResult.apply(this,arguments)}Box2D.Dynamics.Contacts.b2ContactResult=w;function Y(){Y.b2ContactSolver.apply(this,arguments);if(this.constructor===Y){this.b2ContactSolver.apply(this,arguments)}}Box2D.Dynamics.Contacts.b2ContactSolver=Y;function aY(){aY.b2EdgeAndCircleContact.apply(this,arguments)}Box2D.Dynamics.Contacts.b2EdgeAndCircleContact=aY;function r(){r.b2NullContact.apply(this,arguments);if(this.constructor===r){this.b2NullContact.apply(this,arguments)}}Box2D.Dynamics.Contacts.b2NullContact=r;function ay(){ay.b2PolyAndCircleContact.apply(this,arguments)}Box2D.Dynamics.Contacts.b2PolyAndCircleContact=ay;function A(){A.b2PolyAndEdgeContact.apply(this,arguments)}Box2D.Dynamics.Contacts.b2PolyAndEdgeContact=A;function X(){X.b2PolygonContact.apply(this,arguments)}Box2D.Dynamics.Contacts.b2PolygonContact=X;function ax(){ax.b2PositionSolverManifold.apply(this,arguments);if(this.constructor===ax){this.b2PositionSolverManifold.apply(this,arguments)}}Box2D.Dynamics.Contacts.b2PositionSolverManifold=ax;function ab(){ab.b2BuoyancyController.apply(this,arguments)}Box2D.Dynamics.Controllers.b2BuoyancyController=ab;function aD(){aD.b2ConstantAccelController.apply(this,arguments)}Box2D.Dynamics.Controllers.b2ConstantAccelController=aD;function j(){j.b2ConstantForceController.apply(this,arguments)}Box2D.Dynamics.Controllers.b2ConstantForceController=j;function an(){an.b2Controller.apply(this,arguments)}Box2D.Dynamics.Controllers.b2Controller=an;function ag(){ag.b2ControllerEdge.apply(this,arguments)}Box2D.Dynamics.Controllers.b2ControllerEdge=ag;function O(){O.b2GravityController.apply(this,arguments)}Box2D.Dynamics.Controllers.b2GravityController=O;function J(){J.b2TensorDampingController.apply(this,arguments)}Box2D.Dynamics.Controllers.b2TensorDampingController=J;function I(){I.b2DistanceJoint.apply(this,arguments);if(this.constructor===I){this.b2DistanceJoint.apply(this,arguments)}}Box2D.Dynamics.Joints.b2DistanceJoint=I;function aI(){aI.b2DistanceJointDef.apply(this,arguments);if(this.constructor===aI){this.b2DistanceJointDef.apply(this,arguments)}}Box2D.Dynamics.Joints.b2DistanceJointDef=aI;function q(){q.b2FrictionJoint.apply(this,arguments);if(this.constructor===q){this.b2FrictionJoint.apply(this,arguments)}}Box2D.Dynamics.Joints.b2FrictionJoint=q;function aX(){aX.b2FrictionJointDef.apply(this,arguments);if(this.constructor===aX){this.b2FrictionJointDef.apply(this,arguments)}}Box2D.Dynamics.Joints.b2FrictionJointDef=aX;function x(){x.b2GearJoint.apply(this,arguments);if(this.constructor===x){this.b2GearJoint.apply(this,arguments)}}Box2D.Dynamics.Joints.b2GearJoint=x;function L(){L.b2GearJointDef.apply(this,arguments);if(this.constructor===L){this.b2GearJointDef.apply(this,arguments)}}Box2D.Dynamics.Joints.b2GearJointDef=L;function aW(){aW.b2Jacobian.apply(this,arguments)}Box2D.Dynamics.Joints.b2Jacobian=aW;function ah(){ah.b2Joint.apply(this,arguments);if(this.constructor===ah){this.b2Joint.apply(this,arguments)}}Box2D.Dynamics.Joints.b2Joint=ah;function aq(){aq.b2JointDef.apply(this,arguments);if(this.constructor===aq){this.b2JointDef.apply(this,arguments)}}Box2D.Dynamics.Joints.b2JointDef=aq;function ao(){ao.b2JointEdge.apply(this,arguments)}Box2D.Dynamics.Joints.b2JointEdge=ao;function k(){k.b2LineJoint.apply(this,arguments);if(this.constructor===k){this.b2LineJoint.apply(this,arguments)}}Box2D.Dynamics.Joints.b2LineJoint=k;function aF(){aF.b2LineJointDef.apply(this,arguments);if(this.constructor===aF){this.b2LineJointDef.apply(this,arguments)}}Box2D.Dynamics.Joints.b2LineJointDef=aF;function aV(){aV.b2MouseJoint.apply(this,arguments);if(this.constructor===aV){this.b2MouseJoint.apply(this,arguments)}}Box2D.Dynamics.Joints.b2MouseJoint=aV;function K(){K.b2MouseJointDef.apply(this,arguments);if(this.constructor===K){this.b2MouseJointDef.apply(this,arguments)}}Box2D.Dynamics.Joints.b2MouseJointDef=K;function aT(){aT.b2PrismaticJoint.apply(this,arguments);if(this.constructor===aT){this.b2PrismaticJoint.apply(this,arguments)}}Box2D.Dynamics.Joints.b2PrismaticJoint=aT;function af(){af.b2PrismaticJointDef.apply(this,arguments);if(this.constructor===af){this.b2PrismaticJointDef.apply(this,arguments)}}Box2D.Dynamics.Joints.b2PrismaticJointDef=af;function aZ(){aZ.b2PulleyJoint.apply(this,arguments);if(this.constructor===aZ){this.b2PulleyJoint.apply(this,arguments)}}Box2D.Dynamics.Joints.b2PulleyJoint=aZ;function Z(){Z.b2PulleyJointDef.apply(this,arguments);if(this.constructor===Z){this.b2PulleyJointDef.apply(this,arguments)}}Box2D.Dynamics.Joints.b2PulleyJointDef=Z;function c(){c.b2RevoluteJoint.apply(this,arguments);if(this.constructor===c){this.b2RevoluteJoint.apply(this,arguments)}}Box2D.Dynamics.Joints.b2RevoluteJoint=c;function G(){G.b2RevoluteJointDef.apply(this,arguments);if(this.constructor===G){this.b2RevoluteJointDef.apply(this,arguments)}}Box2D.Dynamics.Joints.b2RevoluteJointDef=G;function al(){al.b2WeldJoint.apply(this,arguments);if(this.constructor===al){this.b2WeldJoint.apply(this,arguments)}}Box2D.Dynamics.Joints.b2WeldJoint=al;function Q(){Q.b2WeldJointDef.apply(this,arguments);if(this.constructor===Q){this.b2WeldJointDef.apply(this,arguments)}}Box2D.Dynamics.Joints.b2WeldJointDef=Q})();Box2D.postDefs=[];(function(){var x=Box2D.Collision.Shapes.b2CircleShape,P=Box2D.Collision.Shapes.b2EdgeChainDef,U=Box2D.Collision.Shapes.b2EdgeShape,B=Box2D.Collision.Shapes.b2MassData,n=Box2D.Collision.Shapes.b2PolygonShape,j=Box2D.Collision.Shapes.b2Shape,o=Box2D.Common.b2Color,C=Box2D.Common.b2internal,c=Box2D.Common.b2Settings,u=Box2D.Common.Math.b2Mat22,h=Box2D.Common.Math.b2Mat33,m=Box2D.Common.Math.b2Math,p=Box2D.Common.Math.b2Sweep,e=Box2D.Common.Math.b2Transform,G=Box2D.Common.Math.b2Vec2,E=Box2D.Common.Math.b2Vec3,O=Box2D.Collision.b2AABB,b=Box2D.Collision.b2Bound,D=Box2D.Collision.b2BoundValues,q=Box2D.Collision.b2Collision,I=Box2D.Collision.b2ContactID,s=Box2D.Collision.b2ContactPoint,y=Box2D.Collision.b2Distance,d=Box2D.Collision.b2DistanceInput,z=Box2D.Collision.b2DistanceOutput,S=Box2D.Collision.b2DistanceProxy,w=Box2D.Collision.b2DynamicTree,L=Box2D.Collision.b2DynamicTreeBroadPhase,T=Box2D.Collision.b2DynamicTreeNode,A=Box2D.Collision.b2DynamicTreePair,J=Box2D.Collision.b2Manifold,R=Box2D.Collision.b2ManifoldPoint,r=Box2D.Collision.b2Point,l=Box2D.Collision.b2RayCastInput,v=Box2D.Collision.b2RayCastOutput,K=Box2D.Collision.b2Segment,N=Box2D.Collision.b2SeparationFunction,t=Box2D.Collision.b2Simplex,g=Box2D.Collision.b2SimplexCache,f=Box2D.Collision.b2SimplexVertex,M=Box2D.Collision.b2TimeOfImpact,Q=Box2D.Collision.b2TOIInput,a=Box2D.Collision.b2WorldManifold,k=Box2D.Collision.ClipVertex,H=Box2D.Collision.Features,F=Box2D.Collision.IBroadPhase;O.b2AABB=function(){this.lowerBound=new G();this.upperBound=new G()};O.prototype.IsValid=function(){var W=this.upperBound.x-this.lowerBound.x;var V=this.upperBound.y-this.lowerBound.y;var X=W>=0&&V>=0;X=X&&this.lowerBound.IsValid()&&this.upperBound.IsValid();return X};O.prototype.GetCenter=function(){return new G((this.lowerBound.x+this.upperBound.x)/2,(this.lowerBound.y+this.upperBound.y)/2)};O.prototype.GetExtents=function(){return new G((this.upperBound.x-this.lowerBound.x)/2,(this.upperBound.y-this.lowerBound.y)/2)};O.prototype.Contains=function(W){var V=true;V=V&&this.lowerBound.x<=W.lowerBound.x;V=V&&this.lowerBound.y<=W.lowerBound.y;V=V&&W.upperBound.x<=this.upperBound.x;V=V&&W.upperBound.y<=this.upperBound.y;return V};O.prototype.RayCast=function(Y,aj){var V=(-Number.MAX_VALUE);var af=Number.MAX_VALUE;var X=aj.p1.x;var W=aj.p1.y;var aa=aj.p2.x-aj.p1.x;var Z=aj.p2.y-aj.p1.y;var ah=Math.abs(aa);var ae=Math.abs(Z);var ai=Y.normal;var ac=0;var ag=0;var ad=0;var ab=0;var ak=0;if(ah<Number.MIN_VALUE){if(X<this.lowerBound.x||this.upperBound.x<X){return false}}else{ac=1/aa;ag=(this.lowerBound.x-X)*ac;ad=(this.upperBound.x-X)*ac;ak=(-1);if(ag>ad){ab=ag;ag=ad;ad=ab;ak=1}if(ag>V){ai.x=ak;ai.y=0;V=ag}af=Math.min(af,ad);if(V>af){return false}}if(ae<Number.MIN_VALUE){if(W<this.lowerBound.y||this.upperBound.y<W){return false}}else{ac=1/Z;ag=(this.lowerBound.y-W)*ac;ad=(this.upperBound.y-W)*ac;ak=(-1);if(ag>ad){ab=ag;ag=ad;ad=ab;ak=1}if(ag>V){ai.y=ak;ai.x=0;V=ag}af=Math.min(af,ad);if(V>af){return false}}Y.fraction=V;return true};O.prototype.TestOverlap=function(V){var X=V.lowerBound.x-this.upperBound.x;var W=V.lowerBound.y-this.upperBound.y;var Z=this.lowerBound.x-V.upperBound.x;var Y=this.lowerBound.y-V.upperBound.y;if(X>0||W>0){return false}if(Z>0||Y>0){return false}return true};O.Combine=function(X,V){var W=new O();W.Combine(X,V);return W};O.prototype.Combine=function(W,V){this.lowerBound.x=Math.min(W.lowerBound.x,V.lowerBound.x);this.lowerBound.y=Math.min(W.lowerBound.y,V.lowerBound.y);this.upperBound.x=Math.max(W.upperBound.x,V.upperBound.x);this.upperBound.y=Math.max(W.upperBound.y,V.upperBound.y)};b.b2Bound=function(){};b.prototype.IsLower=function(){return(this.value&1)==0};b.prototype.IsUpper=function(){return(this.value&1)==1};b.prototype.Swap=function(W){var Y=this.value;var X=this.proxy;var V=this.stabbingCount;this.value=W.value;this.proxy=W.proxy;this.stabbingCount=W.stabbingCount;W.value=Y;W.proxy=X;W.stabbingCount=V};D.b2BoundValues=function(){};D.prototype.b2BoundValues=function(){this.lowerValues=new Vector_a2j_Number();this.lowerValues[0]=0;this.lowerValues[1]=0;this.upperValues=new Vector_a2j_Number();this.upperValues[0]=0;this.upperValues[1]=0};q.b2Collision=function(){};q.ClipSegmentToLine=function(ad,Y,ab,W){if(W===undefined){W=0}var X;var Z=0;X=Y[0];var af=X.v;X=Y[1];var ae=X.v;var ac=ab.x*af.x+ab.y*af.y-W;var aa=ab.x*ae.x+ab.y*ae.y-W;if(ac<=0){ad[Z++].Set(Y[0])}if(aa<=0){ad[Z++].Set(Y[1])}if(ac*aa<0){var ag=ac/(ac-aa);X=ad[Z];var ah=X.v;ah.x=af.x+ag*(ae.x-af.x);ah.y=af.y+ag*(ae.y-af.y);X=ad[Z];var V;if(ac>0){V=Y[0];X.id=V.id}else{V=Y[1];X.id=V.id}++Z}return Z};q.EdgeSeparation=function(ao,X,ap,am,V){if(ap===undefined){ap=0}var ad=parseInt(ao.m_vertexCount);var aa=ao.m_vertices;var au=ao.m_normals;var ac=parseInt(am.m_vertexCount);var Y=am.m_vertices;var ak;var ab;ak=X.R;ab=au[ap];var ag=(ak.col1.x*ab.x+ak.col2.x*ab.y);var af=(ak.col1.y*ab.x+ak.col2.y*ab.y);ak=V.R;var aq=(ak.col1.x*ag+ak.col1.y*af);var an=(ak.col2.x*ag+ak.col2.y*af);var ae=0;var al=Number.MAX_VALUE;for(var at=0;at<ac;++at){ab=Y[at];var ar=ab.x*aq+ab.y*an;if(ar<al){al=ar;ae=at}}ab=aa[ap];ak=X.R;var Z=X.position.x+(ak.col1.x*ab.x+ak.col2.x*ab.y);var W=X.position.y+(ak.col1.y*ab.x+ak.col2.y*ab.y);ab=Y[ae];ak=V.R;var aj=V.position.x+(ak.col1.x*ab.x+ak.col2.x*ab.y);var ah=V.position.y+(ak.col1.y*ab.x+ak.col2.y*ab.y);aj-=Z;ah-=W;var ai=aj*ag+ah*af;return ai};q.FindMaxSeparation=function(ap,ak,X,aj,W){var ag=parseInt(ak.m_vertexCount);var at=ak.m_normals;var Y;var ai;ai=W.R;Y=aj.m_centroid;var ab=W.position.x+(ai.col1.x*Y.x+ai.col2.x*Y.y);var aa=W.position.y+(ai.col1.y*Y.x+ai.col2.y*Y.y);ai=X.R;Y=ak.m_centroid;ab-=X.position.x+(ai.col1.x*Y.x+ai.col2.x*Y.y);aa-=X.position.y+(ai.col1.y*Y.x+ai.col2.y*Y.y);var ad=(ab*X.R.col1.x+aa*X.R.col1.y);var ac=(ab*X.R.col2.x+aa*X.R.col2.y);var af=0;var V=(-Number.MAX_VALUE);for(var ao=0;ao<ag;++ao){Y=at[ao];var am=(Y.x*ad+Y.y*ac);if(am>V){V=am;af=ao}}var al=q.EdgeSeparation(ak,X,af,aj,W);var ae=parseInt(af-1>=0?af-1:ag-1);var aq=q.EdgeSeparation(ak,X,ae,aj,W);var an=parseInt(af+1<ag?af+1:0);var ar=q.EdgeSeparation(ak,X,an,aj,W);var Z=0;var ah=0;var au=0;if(aq>al&&aq>ar){au=(-1);Z=ae;ah=aq}else{if(ar>al){au=1;Z=an;ah=ar}else{ap[0]=af;return al}}while(true){if(au==(-1)){af=Z-1>=0?Z-1:ag-1}else{af=Z+1<ag?Z+1:0}al=q.EdgeSeparation(ak,X,af,aj,W);if(al>ah){Z=af;ah=al}else{break}}ap[0]=Z;return ah};q.FindIncidentEdge=function(ar,ag,W,ah,ae,V){if(ah===undefined){ah=0}var aa=parseInt(ag.m_vertexCount);var aq=ag.m_normals;var Z=parseInt(ae.m_vertexCount);var X=ae.m_vertices;var ap=ae.m_normals;var ac;var Y;ac=W.R;Y=aq[ah];var ai=(ac.col1.x*Y.x+ac.col2.x*Y.y);var af=(ac.col1.y*Y.x+ac.col2.y*Y.y);ac=V.R;var aj=(ac.col1.x*ai+ac.col1.y*af);af=(ac.col2.x*ai+ac.col2.y*af);ai=aj;var ab=0;var ad=Number.MAX_VALUE;for(var ao=0;ao<Z;++ao){Y=ap[ao];var ak=(ai*Y.x+af*Y.y);if(ak<ad){ad=ak;ab=ao}}var al;var an=parseInt(ab);var am=parseInt(an+1<Z?an+1:0);al=ar[0];Y=X[an];ac=V.R;al.v.x=V.position.x+(ac.col1.x*Y.x+ac.col2.x*Y.y);al.v.y=V.position.y+(ac.col1.y*Y.x+ac.col2.y*Y.y);al.id.features.referenceEdge=ah;al.id.features.incidentEdge=an;al.id.features.incidentVertex=0;al=ar[1];Y=X[am];ac=V.R;al.v.x=V.position.x+(ac.col1.x*Y.x+ac.col2.x*Y.y);al.v.y=V.position.y+(ac.col1.y*Y.x+ac.col2.y*Y.y);al.id.features.referenceEdge=ah;al.id.features.incidentEdge=am;al.id.features.incidentVertex=1};q.MakeClipPointVector=function(){var V=new Vector(2);V[0]=new k();V[1]=new k();return V};q.CollidePolygons=function(at,ad,Z,ac,Y){var an;at.m_pointCount=0;var af=ad.m_radius+ac.m_radius;var aK=0;q.s_edgeAO[0]=aK;var aF=q.FindMaxSeparation(q.s_edgeAO,ad,Z,ac,Y);aK=q.s_edgeAO[0];if(aF>af){return}var aJ=0;q.s_edgeBO[0]=aJ;var aD=q.FindMaxSeparation(q.s_edgeBO,ac,Y,ad,Z);aJ=q.s_edgeBO[0];if(aD>af){return}var am;var al;var ak;var ai;var V=0;var aO=0;var X=0.98;var aL=0.001;var aI;if(aD>X*aF+aL){am=ac;al=ad;ak=Y;ai=Z;V=aJ;at.m_type=J.e_faceB;aO=1}else{am=ad;al=ac;ak=Z;ai=Y;V=aK;at.m_type=J.e_faceA;aO=0}var W=q.s_incidentEdge;q.FindIncidentEdge(W,am,ak,V,al,ai);var az=parseInt(am.m_vertexCount);var ap=am.m_vertices;var ah=ap[V];var ag;if(V+1<az){ag=ap[parseInt(V+1)]}else{ag=ap[0]}var ay=q.s_localTangent;ay.Set(ag.x-ah.x,ag.y-ah.y);ay.Normalize();var ar=q.s_localNormal;ar.x=ay.y;ar.y=(-ay.x);var aB=q.s_planePoint;aB.Set(0.5*(ah.x+ag.x),0.5*(ah.y+ag.y));var aC=q.s_tangent;aI=ak.R;aC.x=(aI.col1.x*ay.x+aI.col2.x*ay.y);aC.y=(aI.col1.y*ay.x+aI.col2.y*ay.y);var ae=q.s_tangent2;ae.x=(-aC.x);ae.y=(-aC.y);var aE=q.s_normal;aE.x=aC.y;aE.y=(-aC.x);var aH=q.s_v11;var aG=q.s_v12;aH.x=ak.position.x+(aI.col1.x*ah.x+aI.col2.x*ah.y);aH.y=ak.position.y+(aI.col1.y*ah.x+aI.col2.y*ah.y);aG.x=ak.position.x+(aI.col1.x*ag.x+aI.col2.x*ag.y);aG.y=ak.position.y+(aI.col1.y*ag.x+aI.col2.y*ag.y);var aA=aE.x*aH.x+aE.y*aH.y;var ax=(-aC.x*aH.x)-aC.y*aH.y+af;var aw=aC.x*aG.x+aC.y*aG.y+af;var av=q.s_clipPoints1;var au=q.s_clipPoints2;var aN=0;aN=q.ClipSegmentToLine(av,W,ae,ax);if(aN<2){return}aN=q.ClipSegmentToLine(au,av,aC,aw);if(aN<2){return}at.m_localPlaneNormal.SetV(ar);at.m_localPoint.SetV(aB);var ao=0;for(var aM=0;aM<c.b2_maxManifoldPoints;++aM){an=au[aM];var aj=aE.x*an.v.x+aE.y*an.v.y-aA;if(aj<=af){var aq=at.m_points[ao];aI=ai.R;var ab=an.v.x-ai.position.x;var aa=an.v.y-ai.position.y;aq.m_localPoint.x=(ab*aI.col1.x+aa*aI.col1.y);aq.m_localPoint.y=(ab*aI.col2.x+aa*aI.col2.y);aq.m_id.Set(an.id);aq.m_id.features.flip=aO;++ao}}at.m_pointCount=ao};q.CollideCircles=function(aa,ac,ae,Z,ad){aa.m_pointCount=0;var ah;var aj;ah=ae.R;aj=ac.m_p;var af=ae.position.x+(ah.col1.x*aj.x+ah.col2.x*aj.y);var ab=ae.position.y+(ah.col1.y*aj.x+ah.col2.y*aj.y);ah=ad.R;aj=Z.m_p;var W=ad.position.x+(ah.col1.x*aj.x+ah.col2.x*aj.y);var V=ad.position.y+(ah.col1.y*aj.x+ah.col2.y*aj.y);var Y=W-af;var X=V-ab;var ai=Y*Y+X*X;var ag=ac.m_radius+Z.m_radius;if(ai>ag*ag){return}aa.m_type=J.e_circles;aa.m_localPoint.SetV(ac.m_p);aa.m_localPlaneNormal.SetZero();aa.m_pointCount=1;aa.m_points[0].m_localPoint.SetV(Z.m_p);aa.m_points[0].m_id.key=0};q.CollidePolygonAndCircle=function(au,an,Y,ag,X){au.m_pointCount=0;var af;var ad=0;var ac=0;var aC=0;var aB=0;var ab;var al;al=X.R;ab=ag.m_p;var az=X.position.x+(al.col1.x*ab.x+al.col2.x*ab.y);var ay=X.position.y+(al.col1.y*ab.x+al.col2.y*ab.y);ad=az-Y.position.x;ac=ay-Y.position.y;al=Y.R;var ar=(ad*al.col1.x+ac*al.col1.y);var ap=(ad*al.col2.x+ac*al.col2.y);var at=0;var aA=0;var ak=(-Number.MAX_VALUE);var ae=an.m_radius+ag.m_radius;var am=parseInt(an.m_vertexCount);var ah=an.m_vertices;var aq=an.m_normals;for(var aw=0;aw<am;++aw){ab=ah[aw];ad=ar-ab.x;ac=ap-ab.y;ab=aq[aw];var ao=ab.x*ad+ab.y*ac;if(ao>ae){return}if(ao>ak){ak=ao;aA=aw}}var W=parseInt(aA);var V=parseInt(W+1<am?W+1:0);var aa=ah[W];var Z=ah[V];if(ak<Number.MIN_VALUE){au.m_pointCount=1;au.m_type=J.e_faceA;au.m_localPlaneNormal.SetV(aq[aA]);au.m_localPoint.x=0.5*(aa.x+Z.x);au.m_localPoint.y=0.5*(aa.y+Z.y);au.m_points[0].m_localPoint.SetV(ag.m_p);au.m_points[0].m_id.key=0;return}var ax=(ar-aa.x)*(Z.x-aa.x)+(ap-aa.y)*(Z.y-aa.y);var av=(ar-Z.x)*(aa.x-Z.x)+(ap-Z.y)*(aa.y-Z.y);if(ax<=0){if((ar-aa.x)*(ar-aa.x)+(ap-aa.y)*(ap-aa.y)>ae*ae){return}au.m_pointCount=1;au.m_type=J.e_faceA;au.m_localPlaneNormal.x=ar-aa.x;au.m_localPlaneNormal.y=ap-aa.y;au.m_localPlaneNormal.Normalize();au.m_localPoint.SetV(aa);au.m_points[0].m_localPoint.SetV(ag.m_p);au.m_points[0].m_id.key=0}else{if(av<=0){if((ar-Z.x)*(ar-Z.x)+(ap-Z.y)*(ap-Z.y)>ae*ae){return}au.m_pointCount=1;au.m_type=J.e_faceA;au.m_localPlaneNormal.x=ar-Z.x;au.m_localPlaneNormal.y=ap-Z.y;au.m_localPlaneNormal.Normalize();au.m_localPoint.SetV(Z);au.m_points[0].m_localPoint.SetV(ag.m_p);au.m_points[0].m_id.key=0}else{var aj=0.5*(aa.x+Z.x);var ai=0.5*(aa.y+Z.y);ak=(ar-aj)*aq[W].x+(ap-ai)*aq[W].y;if(ak>ae){return}au.m_pointCount=1;au.m_type=J.e_faceA;au.m_localPlaneNormal.x=aq[W].x;au.m_localPlaneNormal.y=aq[W].y;au.m_localPlaneNormal.Normalize();au.m_localPoint.Set(aj,ai);au.m_points[0].m_localPoint.SetV(ag.m_p);au.m_points[0].m_id.key=0}}};q.TestOverlap=function(W,V){var ab=V.lowerBound;var Z=W.upperBound;var Y=ab.x-Z.x;var X=ab.y-Z.y;ab=W.lowerBound;Z=V.upperBound;var ac=ab.x-Z.x;var aa=ab.y-Z.y;if(Y>0||X>0){return false}if(ac>0||aa>0){return false}return true};Box2D.postDefs.push(function(){Box2D.Collision.b2Collision.s_incidentEdge=q.MakeClipPointVector();Box2D.Collision.b2Collision.s_clipPoints1=q.MakeClipPointVector();Box2D.Collision.b2Collision.s_clipPoints2=q.MakeClipPointVector();Box2D.Collision.b2Collision.s_edgeAO=new Vector_a2j_Number(1);Box2D.Collision.b2Collision.s_edgeBO=new Vector_a2j_Number(1);Box2D.Collision.b2Collision.s_localTangent=new G();Box2D.Collision.b2Collision.s_localNormal=new G();Box2D.Collision.b2Collision.s_planePoint=new G();Box2D.Collision.b2Collision.s_normal=new G();Box2D.Collision.b2Collision.s_tangent=new G();Box2D.Collision.b2Collision.s_tangent2=new G();Box2D.Collision.b2Collision.s_v11=new G();Box2D.Collision.b2Collision.s_v12=new G();Box2D.Collision.b2Collision.b2CollidePolyTempVec=new G();Box2D.Collision.b2Collision.b2_nullFeature=255});I.b2ContactID=function(){this.features=new H()};I.prototype.b2ContactID=function(){this.features._m_id=this};I.prototype.Set=function(V){this.key=V._key};I.prototype.Copy=function(){var V=new I();V.key=this.key;return V};Object.defineProperty(I.prototype,"key",{enumerable:false,configurable:true,get:function(){return this._key}});Object.defineProperty(I.prototype,"key",{enumerable:false,configurable:true,set:function(V){if(V===undefined){V=0}this._key=V;this.features._referenceEdge=this._key&255;this.features._incidentEdge=((this._key&65280)>>8)&255;this.features._incidentVertex=((this._key&16711680)>>16)&255;this.features._flip=((this._key&4278190080)>>24)&255}});s.b2ContactPoint=function(){this.position=new G();this.velocity=new G();this.normal=new G();this.id=new I()};y.b2Distance=function(){};y.Distance=function(ab,aj,ah){++y.b2_gjkCalls;var ar=ah.proxyA;var ap=ah.proxyB;var ag=ah.transformA;var af=ah.transformB;var ae=y.s_simplex;ae.ReadCache(aj,ar,ag,ap,af);var Z=ae.m_vertices;var ad=20;var am=y.s_saveA;var al=y.s_saveB;var ai=0;var Y=ae.GetClosestPoint();var X=Y.LengthSquared();var W=X;var ao=0;var ak;var an=0;while(an<ad){ai=ae.m_count;for(ao=0;ao<ai;ao++){am[ao]=Z[ao].indexA;al[ao]=Z[ao].indexB}switch(ae.m_count){case 1:break;case 2:ae.Solve2();break;case 3:ae.Solve3();break;default:c.b2Assert(false)}if(ae.m_count==3){break}ak=ae.GetClosestPoint();W=ak.LengthSquared();if(W>X){}X=W;var at=ae.GetSearchDirection();if(at.LengthSquared()<Number.MIN_VALUE*Number.MIN_VALUE){break}var aq=Z[ae.m_count];aq.indexA=ar.GetSupport(m.MulTMV(ag.R,at.GetNegative()));aq.wA=m.MulX(ag,ar.GetVertex(aq.indexA));aq.indexB=ap.GetSupport(m.MulTMV(af.R,at));aq.wB=m.MulX(af,ap.GetVertex(aq.indexB));aq.w=m.SubtractVV(aq.wB,aq.wA);++an;++y.b2_gjkIters;var V=false;for(ao=0;ao<ai;ao++){if(aq.indexA==am[ao]&&aq.indexB==al[ao]){V=true;break}}if(V){break}++ae.m_count}y.b2_gjkMaxIters=m.Max(y.b2_gjkMaxIters,an);ae.GetWitnessPoints(ab.pointA,ab.pointB);ab.distance=m.SubtractVV(ab.pointA,ab.pointB).Length();ab.iterations=an;ae.WriteCache(aj);if(ah.useRadii){var ac=ar.m_radius;var aa=ap.m_radius;if(ab.distance>ac+aa&&ab.distance>Number.MIN_VALUE){ab.distance-=ac+aa;var au=m.SubtractVV(ab.pointB,ab.pointA);au.Normalize();ab.pointA.x+=ac*au.x;ab.pointA.y+=ac*au.y;ab.pointB.x-=aa*au.x;ab.pointB.y-=aa*au.y}else{ak=new G();ak.x=0.5*(ab.pointA.x+ab.pointB.x);ak.y=0.5*(ab.pointA.y+ab.pointB.y);ab.pointA.x=ab.pointB.x=ak.x;ab.pointA.y=ab.pointB.y=ak.y;ab.distance=0}}};Box2D.postDefs.push(function(){Box2D.Collision.b2Distance.s_simplex=new t();Box2D.Collision.b2Distance.s_saveA=new Vector_a2j_Number(3);Box2D.Collision.b2Distance.s_saveB=new Vector_a2j_Number(3)});d.b2DistanceInput=function(){};z.b2DistanceOutput=function(){this.pointA=new G();this.pointB=new G()};S.b2DistanceProxy=function(){};S.prototype.Set=function(V){switch(V.GetType()){case j.e_circleShape:var X=(V instanceof x?V:null);this.m_vertices=new Vector(1,true);this.m_vertices[0]=X.m_p;this.m_count=1;this.m_radius=X.m_radius;break;case j.e_polygonShape:var W=(V instanceof n?V:null);this.m_vertices=W.m_vertices;this.m_count=W.m_vertexCount;this.m_radius=W.m_radius;break;default:c.b2Assert(false)}};S.prototype.GetSupport=function(Z){var W=0;var Y=this.m_vertices[0].x*Z.x+this.m_vertices[0].y*Z.y;for(var V=1;V<this.m_count;++V){var X=this.m_vertices[V].x*Z.x+this.m_vertices[V].y*Z.y;if(X>Y){W=V;Y=X}}return W};S.prototype.GetSupportVertex=function(Z){var W=0;var Y=this.m_vertices[0].x*Z.x+this.m_vertices[0].y*Z.y;for(var V=1;V<this.m_count;++V){var X=this.m_vertices[V].x*Z.x+this.m_vertices[V].y*Z.y;if(X>Y){W=V;Y=X}}return this.m_vertices[W]};S.prototype.GetVertexCount=function(){return this.m_count};S.prototype.GetVertex=function(V){if(V===undefined){V=0}c.b2Assert(0<=V&&V<this.m_count);return this.m_vertices[V]};w.b2DynamicTree=function(){};w.prototype.b2DynamicTree=function(){this.m_root=null;this.m_freeList=null;this.m_path=0;this.m_insertionCount=0};w.prototype.CreateProxy=function(Y,W){var Z=this.AllocateNode();var X=c.b2_aabbExtension;var V=c.b2_aabbExtension;Z.aabb.lowerBound.x=Y.lowerBound.x-X;Z.aabb.lowerBound.y=Y.lowerBound.y-V;Z.aabb.upperBound.x=Y.upperBound.x+X;Z.aabb.upperBound.y=Y.upperBound.y+V;Z.userData=W;this.InsertLeaf(Z);return Z};w.prototype.DestroyProxy=function(V){this.RemoveLeaf(V);this.FreeNode(V)};w.prototype.MoveProxy=function(Z,X,Y){c.b2Assert(Z.IsLeaf());if(Z.aabb.Contains(X)){return false}this.RemoveLeaf(Z);var W=c.b2_aabbExtension+c.b2_aabbMultiplier*(Y.x>0?Y.x:(-Y.x));var V=c.b2_aabbExtension+c.b2_aabbMultiplier*(Y.y>0?Y.y:(-Y.y));Z.aabb.lowerBound.x=X.lowerBound.x-W;Z.aabb.lowerBound.y=X.lowerBound.y-V;Z.aabb.upperBound.x=X.upperBound.x+W;Z.aabb.upperBound.y=X.upperBound.y+V;this.InsertLeaf(Z);return true};w.prototype.Rebalance=function(X){if(X===undefined){X=0}if(this.m_root==null){return}for(var V=0;V<X;V++){var W=this.m_root;var Y=0;while(W.IsLeaf()==false){W=(this.m_path>>Y)&1?W.child2:W.child1;Y=(Y+1)&31}++this.m_path;this.RemoveLeaf(W);this.InsertLeaf(W)}};w.prototype.GetFatAABB=function(V){return V.aabb};w.prototype.GetUserData=function(V){return V.userData};w.prototype.Query=function(aa,W){if(this.m_root==null){return}var V=new Vector();var Z=0;V[Z++]=this.m_root;while(Z>0){var Y=V[--Z];if(Y.aabb.TestOverlap(W)){if(Y.IsLeaf()){var X=aa(Y);if(!X){return}}else{V[Z++]=Y.child1;V[Z++]=Y.child2}}}};w.prototype.RayCast=function(Z,ae){if(this.m_root==null){return}var Y=ae.p1;var W=ae.p2;var af=m.SubtractVV(Y,W);af.Normalize();var ad=m.CrossFV(1,af);var al=m.AbsV(ad);var ai=ae.maxFraction;var X=new O();var ah=0;var ag=0;ah=Y.x+ai*(W.x-Y.x);ag=Y.y+ai*(W.y-Y.y);X.lowerBound.x=Math.min(Y.x,ah);X.lowerBound.y=Math.min(Y.y,ag);X.upperBound.x=Math.max(Y.x,ah);X.upperBound.y=Math.max(Y.y,ag);var aa=new Vector();var ab=0;aa[ab++]=this.m_root;while(ab>0){var aj=aa[--ab];if(aj.aabb.TestOverlap(X)==false){continue}var am=aj.aabb.GetCenter();var ak=aj.aabb.GetExtents();var ac=Math.abs(ad.x*(Y.x-am.x)+ad.y*(Y.y-am.y))-al.x*ak.x-al.y*ak.y;if(ac>0){continue}if(aj.IsLeaf()){var V=new l();V.p1=ae.p1;V.p2=ae.p2;V.maxFraction=ae.maxFraction;ai=Z(V,aj);if(ai==0){return}if(ai>0){ah=Y.x+ai*(W.x-Y.x);ag=Y.y+ai*(W.y-Y.y);X.lowerBound.x=Math.min(Y.x,ah);X.lowerBound.y=Math.min(Y.y,ag);X.upperBound.x=Math.max(Y.x,ah);X.upperBound.y=Math.max(Y.y,ag)}}else{aa[ab++]=aj.child1;aa[ab++]=aj.child2}}};w.prototype.AllocateNode=function(){if(this.m_freeList){var V=this.m_freeList;this.m_freeList=V.parent;V.parent=null;V.child1=null;V.child2=null;return V}return new T()};w.prototype.FreeNode=function(V){V.parent=this.m_freeList;this.m_freeList=V};w.prototype.InsertLeaf=function(aa){++this.m_insertionCount;if(this.m_root==null){this.m_root=aa;this.m_root.parent=null;return}var V=aa.aabb.GetCenter();var ab=this.m_root;if(ab.IsLeaf()==false){do{var Z=ab.child1;var Y=ab.child2;var X=Math.abs((Z.aabb.lowerBound.x+Z.aabb.upperBound.x)/2-V.x)+Math.abs((Z.aabb.lowerBound.y+Z.aabb.upperBound.y)/2-V.y);var W=Math.abs((Y.aabb.lowerBound.x+Y.aabb.upperBound.x)/2-V.x)+Math.abs((Y.aabb.lowerBound.y+Y.aabb.upperBound.y)/2-V.y);if(X<W){ab=Z}else{ab=Y}}while(ab.IsLeaf()==false)}var ad=ab.parent;var ac=this.AllocateNode();ac.parent=ad;ac.userData=null;ac.aabb.Combine(aa.aabb,ab.aabb);if(ad){if(ab.parent.child1==ab){ad.child1=ac}else{ad.child2=ac}ac.child1=ab;ac.child2=aa;ab.parent=ac;aa.parent=ac;do{if(ad.aabb.Contains(ac.aabb)){break}ad.aabb.Combine(ad.child1.aabb,ad.child2.aabb);ac=ad;ad=ad.parent}while(ad)}else{ac.child1=ab;ac.child2=aa;ab.parent=ac;aa.parent=ac;this.m_root=ac}};w.prototype.RemoveLeaf=function(X){if(X==this.m_root){this.m_root=null;return}var W=X.parent;var Y=W.parent;var Z;if(W.child1==X){Z=W.child2}else{Z=W.child1}if(Y){if(Y.child1==W){Y.child1=Z}else{Y.child2=Z}Z.parent=Y;this.FreeNode(W);while(Y){var V=Y.aabb;Y.aabb=O.Combine(Y.child1.aabb,Y.child2.aabb);if(V.Contains(Y.aabb)){break}Y=Y.parent}}else{this.m_root=Z;Z.parent=null;this.FreeNode(W)}};L.b2DynamicTreeBroadPhase=function(){this.m_tree=new w();this.m_moveBuffer=new Vector();this.m_pairBuffer=new Vector();this.m_pairCount=0};L.prototype.CreateProxy=function(W,V){var X=this.m_tree.CreateProxy(W,V);++this.m_proxyCount;this.BufferMove(X);return X};L.prototype.DestroyProxy=function(V){this.UnBufferMove(V);--this.m_proxyCount;this.m_tree.DestroyProxy(V)};L.prototype.MoveProxy=function(Y,W,X){var V=this.m_tree.MoveProxy(Y,W,X);if(V){this.BufferMove(Y)}};L.prototype.TestOverlap=function(W,V){var Y=this.m_tree.GetFatAABB(W);var X=this.m_tree.GetFatAABB(V);return Y.TestOverlap(X)};L.prototype.GetUserData=function(V){return this.m_tree.GetUserData(V)};L.prototype.GetFatAABB=function(V){return this.m_tree.GetFatAABB(V)};L.prototype.GetProxyCount=function(){return this.m_proxyCount};L.prototype.UpdatePairs=function(ae){var ad=this;ad.m_pairCount=0;var ac=0,Y;for(ac=0;ac<ad.m_moveBuffer.length;++ac){Y=ad.m_moveBuffer[ac];function V(af){if(af==Y){return true}if(ad.m_pairCount==ad.m_pairBuffer.length){ad.m_pairBuffer[ad.m_pairCount]=new A()}var ag=ad.m_pairBuffer[ad.m_pairCount];ag.proxyA=af<Y?af:Y;ag.proxyB=af>=Y?af:Y;++ad.m_pairCount;return true}var aa=ad.m_tree.GetFatAABB(Y);ad.m_tree.Query(V,aa)}ad.m_moveBuffer.length=0;for(var ac=0;ac<ad.m_pairCount;){var W=ad.m_pairBuffer[ac];var Z=ad.m_tree.GetUserData(W.proxyA);var X=ad.m_tree.GetUserData(W.proxyB);ae(Z,X);++ac;while(ac<ad.m_pairCount){var ab=ad.m_pairBuffer[ac];if(ab.proxyA!=W.proxyA||ab.proxyB!=W.proxyB){break}++ac}}};L.prototype.Query=function(W,V){this.m_tree.Query(W,V)};L.prototype.RayCast=function(W,V){this.m_tree.RayCast(W,V)};L.prototype.Validate=function(){};L.prototype.Rebalance=function(V){if(V===undefined){V=0}this.m_tree.Rebalance(V)};L.prototype.BufferMove=function(V){this.m_moveBuffer[this.m_moveBuffer.length]=V};L.prototype.UnBufferMove=function(W){var V=parseInt(this.m_moveBuffer.indexOf(W));this.m_moveBuffer.splice(V,1)};L.prototype.ComparePairs=function(W,V){return 0};L.__implements={};L.__implements[F]=true;T.b2DynamicTreeNode=function(){this.aabb=new O()};T.prototype.IsLeaf=function(){return this.child1==null};A.b2DynamicTreePair=function(){};J.b2Manifold=function(){this.m_pointCount=0};J.prototype.b2Manifold=function(){this.m_points=new Vector(c.b2_maxManifoldPoints);for(var V=0;V<c.b2_maxManifoldPoints;V++){this.m_points[V]=new R()}this.m_localPlaneNormal=new G();this.m_localPoint=new G()};J.prototype.Reset=function(){for(var V=0;V<c.b2_maxManifoldPoints;V++){((this.m_points[V] instanceof R?this.m_points[V]:null)).Reset()}this.m_localPlaneNormal.SetZero();this.m_localPoint.SetZero();this.m_type=0;this.m_pointCount=0};J.prototype.Set=function(V){this.m_pointCount=V.m_pointCount;for(var W=0;W<c.b2_maxManifoldPoints;W++){((this.m_points[W] instanceof R?this.m_points[W]:null)).Set(V.m_points[W])}this.m_localPlaneNormal.SetV(V.m_localPlaneNormal);this.m_localPoint.SetV(V.m_localPoint);this.m_type=V.m_type};J.prototype.Copy=function(){var V=new J();V.Set(this);return V};Box2D.postDefs.push(function(){Box2D.Collision.b2Manifold.e_circles=1;Box2D.Collision.b2Manifold.e_faceA=2;Box2D.Collision.b2Manifold.e_faceB=4});R.b2ManifoldPoint=function(){this.m_localPoint=new G();this.m_id=new I()};R.prototype.b2ManifoldPoint=function(){this.Reset()};R.prototype.Reset=function(){this.m_localPoint.SetZero();this.m_normalImpulse=0;this.m_tangentImpulse=0;this.m_id.key=0};R.prototype.Set=function(V){this.m_localPoint.SetV(V.m_localPoint);this.m_normalImpulse=V.m_normalImpulse;this.m_tangentImpulse=V.m_tangentImpulse;this.m_id.Set(V.m_id)};r.b2Point=function(){this.p=new G()};r.prototype.Support=function(X,W,V){if(W===undefined){W=0}if(V===undefined){V=0}return this.p};r.prototype.GetFirstVertex=function(V){return this.p};l.b2RayCastInput=function(){this.p1=new G();this.p2=new G()};l.prototype.b2RayCastInput=function(X,W,V){if(X===undefined){X=null}if(W===undefined){W=null}if(V===undefined){V=1}if(X){this.p1.SetV(X)}if(W){this.p2.SetV(W)}this.maxFraction=V};v.b2RayCastOutput=function(){this.normal=new G()};K.b2Segment=function(){this.p1=new G();this.p2=new G()};K.prototype.TestSegment=function(ad,al,X,ah){if(ah===undefined){ah=0}var ae=X.p1;var ak=X.p2.x-ae.x;var ai=X.p2.y-ae.y;var Z=this.p2.x-this.p1.x;var Y=this.p2.y-this.p1.y;var ag=Y;var af=(-Z);var am=100*Number.MIN_VALUE;var W=(-(ak*ag+ai*af));if(W>am){var ac=ae.x-this.p1.x;var ab=ae.y-this.p1.y;var aj=(ac*ag+ab*af);if(0<=aj&&aj<=ah*W){var V=(-ak*ab)+ai*ac;if((-am*W)<=V&&V<=W*(1+am)){aj/=W;var aa=Math.sqrt(ag*ag+af*af);ag/=aa;af/=aa;ad[0]=aj;al.Set(ag,af);return true}}}return false};K.prototype.Extend=function(V){this.ExtendForward(V);this.ExtendBackward(V)};K.prototype.ExtendForward=function(X){var W=this.p2.x-this.p1.x;var V=this.p2.y-this.p1.y;var Y=Math.min(W>0?(X.upperBound.x-this.p1.x)/W:W<0?(X.lowerBound.x-this.p1.x)/W:Number.POSITIVE_INFINITY,V>0?(X.upperBound.y-this.p1.y)/V:V<0?(X.lowerBound.y-this.p1.y)/V:Number.POSITIVE_INFINITY);this.p2.x=this.p1.x+W*Y;this.p2.y=this.p1.y+V*Y};K.prototype.ExtendBackward=function(X){var W=(-this.p2.x)+this.p1.x;var V=(-this.p2.y)+this.p1.y;var Y=Math.min(W>0?(X.upperBound.x-this.p2.x)/W:W<0?(X.lowerBound.x-this.p2.x)/W:Number.POSITIVE_INFINITY,V>0?(X.upperBound.y-this.p2.y)/V:V<0?(X.lowerBound.y-this.p2.y)/V:Number.POSITIVE_INFINITY);this.p1.x=this.p2.x+W*Y;this.p1.y=this.p2.y+V*Y};N.b2SeparationFunction=function(){this.m_localPoint=new G();this.m_axis=new G()};N.prototype.Initialize=function(am,aw,ah,av,ag){this.m_proxyA=aw;this.m_proxyB=av;var ab=parseInt(am.count);c.b2Assert(0<ab&&ab<3);var aj;var aa;var Z;var ai;var ap;var ao;var aD=0;var aC=0;var ae=0;var ac=0;var Y=0;var X=0;var af;var W;var al=0;var ad=0;if(ab==1){this.m_type=N.e_points;aj=this.m_proxyA.GetVertex(am.indexA[0]);ai=this.m_proxyB.GetVertex(am.indexB[0]);W=aj;af=ah.R;aD=ah.position.x+(af.col1.x*W.x+af.col2.x*W.y);aC=ah.position.y+(af.col1.y*W.x+af.col2.y*W.y);W=ai;af=ag.R;ae=ag.position.x+(af.col1.x*W.x+af.col2.x*W.y);ac=ag.position.y+(af.col1.y*W.x+af.col2.y*W.y);this.m_axis.x=ae-aD;this.m_axis.y=ac-aC;this.m_axis.Normalize()}else{if(am.indexB[0]==am.indexB[1]){this.m_type=N.e_faceA;aa=this.m_proxyA.GetVertex(am.indexA[0]);Z=this.m_proxyA.GetVertex(am.indexA[1]);ai=this.m_proxyB.GetVertex(am.indexB[0]);this.m_localPoint.x=0.5*(aa.x+Z.x);this.m_localPoint.y=0.5*(aa.y+Z.y);this.m_axis=m.CrossVF(m.SubtractVV(Z,aa),1);this.m_axis.Normalize();W=this.m_axis;af=ah.R;Y=af.col1.x*W.x+af.col2.x*W.y;X=af.col1.y*W.x+af.col2.y*W.y;W=this.m_localPoint;af=ah.R;aD=ah.position.x+(af.col1.x*W.x+af.col2.x*W.y);aC=ah.position.y+(af.col1.y*W.x+af.col2.y*W.y);W=ai;af=ag.R;ae=ag.position.x+(af.col1.x*W.x+af.col2.x*W.y);ac=ag.position.y+(af.col1.y*W.x+af.col2.y*W.y);al=(ae-aD)*Y+(ac-aC)*X;if(al<0){this.m_axis.NegativeSelf()}}else{if(am.indexA[0]==am.indexA[0]){this.m_type=N.e_faceB;ap=this.m_proxyB.GetVertex(am.indexB[0]);ao=this.m_proxyB.GetVertex(am.indexB[1]);aj=this.m_proxyA.GetVertex(am.indexA[0]);this.m_localPoint.x=0.5*(ap.x+ao.x);this.m_localPoint.y=0.5*(ap.y+ao.y);this.m_axis=m.CrossVF(m.SubtractVV(ao,ap),1);this.m_axis.Normalize();W=this.m_axis;af=ag.R;Y=af.col1.x*W.x+af.col2.x*W.y;X=af.col1.y*W.x+af.col2.y*W.y;W=this.m_localPoint;af=ag.R;ae=ag.position.x+(af.col1.x*W.x+af.col2.x*W.y);ac=ag.position.y+(af.col1.y*W.x+af.col2.y*W.y);W=aj;af=ah.R;aD=ah.position.x+(af.col1.x*W.x+af.col2.x*W.y);aC=ah.position.y+(af.col1.y*W.x+af.col2.y*W.y);al=(aD-ae)*Y+(aC-ac)*X;if(al<0){this.m_axis.NegativeSelf()}}else{aa=this.m_proxyA.GetVertex(am.indexA[0]);Z=this.m_proxyA.GetVertex(am.indexA[1]);ap=this.m_proxyB.GetVertex(am.indexB[0]);ao=this.m_proxyB.GetVertex(am.indexB[1]);var au=m.MulX(ah,aj);var ar=m.MulMV(ah.R,m.SubtractVV(Z,aa));var at=m.MulX(ag,ai);var aq=m.MulMV(ag.R,m.SubtractVV(ao,ap));var aB=ar.x*ar.x+ar.y*ar.y;var ay=aq.x*aq.x+aq.y*aq.y;var an=m.SubtractVV(aq,ar);var az=ar.x*an.x+ar.y*an.y;var ax=aq.x*an.x+aq.y*an.y;var aA=ar.x*aq.x+ar.y*aq.y;var V=aB*ay-aA*aA;al=0;if(V!=0){al=m.Clamp((aA*ax-az*ay)/V,0,1)}var ak=(aA*al+ax)/ay;if(ak<0){ak=0;al=m.Clamp((aA-az)/aB,0,1)}aj=new G();aj.x=aa.x+al*(Z.x-aa.x);aj.y=aa.y+al*(Z.y-aa.y);ai=new G();ai.x=ap.x+al*(ao.x-ap.x);ai.y=ap.y+al*(ao.y-ap.y);if(al==0||al==1){this.m_type=N.e_faceB;this.m_axis=m.CrossVF(m.SubtractVV(ao,ap),1);this.m_axis.Normalize();this.m_localPoint=ai;W=this.m_axis;af=ag.R;Y=af.col1.x*W.x+af.col2.x*W.y;X=af.col1.y*W.x+af.col2.y*W.y;W=this.m_localPoint;af=ag.R;ae=ag.position.x+(af.col1.x*W.x+af.col2.x*W.y);ac=ag.position.y+(af.col1.y*W.x+af.col2.y*W.y);W=aj;af=ah.R;aD=ah.position.x+(af.col1.x*W.x+af.col2.x*W.y);aC=ah.position.y+(af.col1.y*W.x+af.col2.y*W.y);ad=(aD-ae)*Y+(aC-ac)*X;if(al<0){this.m_axis.NegativeSelf()}}else{this.m_type=N.e_faceA;this.m_axis=m.CrossVF(m.SubtractVV(Z,aa),1);this.m_localPoint=aj;W=this.m_axis;af=ah.R;Y=af.col1.x*W.x+af.col2.x*W.y;X=af.col1.y*W.x+af.col2.y*W.y;W=this.m_localPoint;af=ah.R;aD=ah.position.x+(af.col1.x*W.x+af.col2.x*W.y);aC=ah.position.y+(af.col1.y*W.x+af.col2.y*W.y);W=ai;af=ag.R;ae=ag.position.x+(af.col1.x*W.x+af.col2.x*W.y);ac=ag.position.y+(af.col1.y*W.x+af.col2.y*W.y);ad=(ae-aD)*Y+(ac-aC)*X;if(al<0){this.m_axis.NegativeSelf()}}}}}};N.prototype.Evaluate=function(ad,ac){var X;var W;var aa;var Z;var V;var ae;var Y=0;var ab;switch(this.m_type){case N.e_points:X=m.MulTMV(ad.R,this.m_axis);W=m.MulTMV(ac.R,this.m_axis.GetNegative());aa=this.m_proxyA.GetSupportVertex(X);Z=this.m_proxyB.GetSupportVertex(W);V=m.MulX(ad,aa);ae=m.MulX(ac,Z);Y=(ae.x-V.x)*this.m_axis.x+(ae.y-V.y)*this.m_axis.y;return Y;case N.e_faceA:ab=m.MulMV(ad.R,this.m_axis);V=m.MulX(ad,this.m_localPoint);W=m.MulTMV(ac.R,ab.GetNegative());Z=this.m_proxyB.GetSupportVertex(W);ae=m.MulX(ac,Z);Y=(ae.x-V.x)*ab.x+(ae.y-V.y)*ab.y;return Y;case N.e_faceB:ab=m.MulMV(ac.R,this.m_axis);ae=m.MulX(ac,this.m_localPoint);X=m.MulTMV(ad.R,ab.GetNegative());aa=this.m_proxyA.GetSupportVertex(X);V=m.MulX(ad,aa);Y=(V.x-ae.x)*ab.x+(V.y-ae.y)*ab.y;return Y;default:c.b2Assert(false);return 0}};Box2D.postDefs.push(function(){Box2D.Collision.b2SeparationFunction.e_points=1;Box2D.Collision.b2SeparationFunction.e_faceA=2;Box2D.Collision.b2SeparationFunction.e_faceB=4});t.b2Simplex=function(){this.m_v1=new f();this.m_v2=new f();this.m_v3=new f();this.m_vertices=new Vector(3)};t.prototype.b2Simplex=function(){this.m_vertices[0]=this.m_v1;this.m_vertices[1]=this.m_v2;this.m_vertices[2]=this.m_v3};t.prototype.ReadCache=function(V,ad,af,ac,ae){c.b2Assert(0<=V.count&&V.count<=3);var W;var X;this.m_count=V.count;var ab=this.m_vertices;for(var Y=0;Y<this.m_count;Y++){var ag=ab[Y];ag.indexA=V.indexA[Y];ag.indexB=V.indexB[Y];W=ad.GetVertex(ag.indexA);X=ac.GetVertex(ag.indexB);ag.wA=m.MulX(af,W);ag.wB=m.MulX(ae,X);ag.w=m.SubtractVV(ag.wB,ag.wA);ag.a=0}if(this.m_count>1){var aa=V.metric;var Z=this.GetMetric();if(Z<0.5*aa||2*aa<Z||Z<Number.MIN_VALUE){this.m_count=0}}if(this.m_count==0){ag=ab[0];ag.indexA=0;ag.indexB=0;W=ad.GetVertex(0);X=ac.GetVertex(0);ag.wA=m.MulX(af,W);ag.wB=m.MulX(ae,X);ag.w=m.SubtractVV(ag.wB,ag.wA);this.m_count=1}};t.prototype.WriteCache=function(V){V.metric=this.GetMetric();V.count=Box2D.parseUInt(this.m_count);var W=this.m_vertices;for(var X=0;X<this.m_count;X++){V.indexA[X]=Box2D.parseUInt(W[X].indexA);V.indexB[X]=Box2D.parseUInt(W[X].indexB)}};t.prototype.GetSearchDirection=function(){switch(this.m_count){case 1:return this.m_v1.w.GetNegative();case 2:var V=m.SubtractVV(this.m_v2.w,this.m_v1.w);var W=m.CrossVV(V,this.m_v1.w.GetNegative());if(W>0){return m.CrossFV(1,V)}else{return m.CrossVF(V,1)}default:c.b2Assert(false);return new G()}};t.prototype.GetClosestPoint=function(){switch(this.m_count){case 0:c.b2Assert(false);return new G();case 1:return this.m_v1.w;case 2:return new G(this.m_v1.a*this.m_v1.w.x+this.m_v2.a*this.m_v2.w.x,this.m_v1.a*this.m_v1.w.y+this.m_v2.a*this.m_v2.w.y);default:c.b2Assert(false);return new G()}};t.prototype.GetWitnessPoints=function(W,V){switch(this.m_count){case 0:c.b2Assert(false);break;case 1:W.SetV(this.m_v1.wA);V.SetV(this.m_v1.wB);break;case 2:W.x=this.m_v1.a*this.m_v1.wA.x+this.m_v2.a*this.m_v2.wA.x;W.y=this.m_v1.a*this.m_v1.wA.y+this.m_v2.a*this.m_v2.wA.y;V.x=this.m_v1.a*this.m_v1.wB.x+this.m_v2.a*this.m_v2.wB.x;V.y=this.m_v1.a*this.m_v1.wB.y+this.m_v2.a*this.m_v2.wB.y;break;case 3:V.x=W.x=this.m_v1.a*this.m_v1.wA.x+this.m_v2.a*this.m_v2.wA.x+this.m_v3.a*this.m_v3.wA.x;V.y=W.y=this.m_v1.a*this.m_v1.wA.y+this.m_v2.a*this.m_v2.wA.y+this.m_v3.a*this.m_v3.wA.y;break;default:c.b2Assert(false);break}};t.prototype.GetMetric=function(){switch(this.m_count){case 0:c.b2Assert(false);return 0;case 1:return 0;case 2:return m.SubtractVV(this.m_v1.w,this.m_v2.w).Length();case 3:return m.CrossVV(m.SubtractVV(this.m_v2.w,this.m_v1.w),m.SubtractVV(this.m_v3.w,this.m_v1.w));default:c.b2Assert(false);return 0}};t.prototype.Solve2=function(){var W=this.m_v1.w;var V=this.m_v2.w;var Y=m.SubtractVV(V,W);var Z=(-(W.x*Y.x+W.y*Y.y));if(Z<=0){this.m_v1.a=1;this.m_count=1;return}var aa=(V.x*Y.x+V.y*Y.y);if(aa<=0){this.m_v2.a=1;this.m_count=1;this.m_v1.Set(this.m_v2);return}var X=1/(aa+Z);this.m_v1.a=aa*X;this.m_v2.a=Z*X;this.m_count=2};t.prototype.Solve3=function(){var aj=this.m_v1.w;var ah=this.m_v2.w;var af=this.m_v3.w;var ak=m.SubtractVV(ah,aj);var Y=m.Dot(aj,ak);var aa=m.Dot(ah,ak);var av=aa;var au=(-Y);var ai=m.SubtractVV(af,aj);var X=m.Dot(aj,ai);var am=m.Dot(af,ai);var an=am;var al=(-X);var ar=m.SubtractVV(af,ah);var aq=m.Dot(ah,ar);var at=m.Dot(af,ar);var ap=at;var ao=(-aq);var ae=m.CrossVV(ak,ai);var ad=ae*m.CrossVV(ah,af);var ac=ae*m.CrossVV(af,aj);var Z=ae*m.CrossVV(aj,ah);if(au<=0&&al<=0){this.m_v1.a=1;this.m_count=1;return}if(av>0&&au>0&&Z<=0){var W=1/(av+au);this.m_v1.a=av*W;this.m_v2.a=au*W;this.m_count=2;return}if(an>0&&al>0&&ac<=0){var V=1/(an+al);this.m_v1.a=an*V;this.m_v3.a=al*V;this.m_count=2;this.m_v2.Set(this.m_v3);return}if(av<=0&&ao<=0){this.m_v2.a=1;this.m_count=1;this.m_v1.Set(this.m_v2);return}if(an<=0&&ap<=0){this.m_v3.a=1;this.m_count=1;this.m_v1.Set(this.m_v3);return}if(ap>0&&ao>0&&ad<=0){var ag=1/(ap+ao);this.m_v2.a=ap*ag;this.m_v3.a=ao*ag;this.m_count=2;this.m_v1.Set(this.m_v3);return}var ab=1/(ad+ac+Z);this.m_v1.a=ad*ab;this.m_v2.a=ac*ab;this.m_v3.a=Z*ab;this.m_count=3};g.b2SimplexCache=function(){this.indexA=new Vector_a2j_Number(3);this.indexB=new Vector_a2j_Number(3)};f.b2SimplexVertex=function(){};f.prototype.Set=function(V){this.wA.SetV(V.wA);this.wB.SetV(V.wB);this.w.SetV(V.w);this.a=V.a;this.indexA=V.indexA;this.indexB=V.indexB};M.b2TimeOfImpact=function(){};M.TimeOfImpact=function(ac){++M.b2_toiCalls;var al=ac.proxyA;var aj=ac.proxyB;var X=ac.sweepA;var W=ac.sweepB;c.b2Assert(X.t0==W.t0);c.b2Assert(1-X.t0>Number.MIN_VALUE);var Y=al.m_radius+aj.m_radius;var ai=ac.tolerance;var Z=0;var ad=1000;var ah=0;var ao=0;M.s_cache.count=0;M.s_distanceInput.useRadii=false;for(;;){X.GetTransform(M.s_xfA,Z);W.GetTransform(M.s_xfB,Z);M.s_distanceInput.proxyA=al;M.s_distanceInput.proxyB=aj;M.s_distanceInput.transformA=M.s_xfA;M.s_distanceInput.transformB=M.s_xfB;y.Distance(M.s_distanceOutput,M.s_cache,M.s_distanceInput);if(M.s_distanceOutput.distance<=0){Z=1;break}M.s_fcn.Initialize(M.s_cache,al,M.s_xfA,aj,M.s_xfB);var aa=M.s_fcn.Evaluate(M.s_xfA,M.s_xfB);if(aa<=0){Z=1;break}if(ah==0){if(aa>Y){ao=m.Max(Y-ai,0.75*Y)}else{ao=m.Max(aa-ai,0.02*Y)}}if(aa-ao<0.5*ai){if(ah==0){Z=1;break}break}var V=Z;var am=Z;var ak=1;var ag=aa;X.GetTransform(M.s_xfA,ak);W.GetTransform(M.s_xfB,ak);var af=M.s_fcn.Evaluate(M.s_xfA,M.s_xfB);if(af>=ao){Z=1;break}var ae=0;for(;;){var ab=0;if(ae&1){ab=am+(ao-ag)*(ak-am)/(af-ag)}else{ab=0.5*(am+ak)}X.GetTransform(M.s_xfA,ab);W.GetTransform(M.s_xfB,ab);var an=M.s_fcn.Evaluate(M.s_xfA,M.s_xfB);if(m.Abs(an-ao)<0.025*ai){V=ab;break}if(an>ao){am=ab;ag=an}else{ak=ab;af=an}++ae;++M.b2_toiRootIters;if(ae==50){break}}M.b2_toiMaxRootIters=m.Max(M.b2_toiMaxRootIters,ae);if(V<(1+100*Number.MIN_VALUE)*Z){break}Z=V;ah++;++M.b2_toiIters;if(ah==ad){break}}M.b2_toiMaxIters=m.Max(M.b2_toiMaxIters,ah);return Z};Box2D.postDefs.push(function(){Box2D.Collision.b2TimeOfImpact.b2_toiCalls=0;Box2D.Collision.b2TimeOfImpact.b2_toiIters=0;Box2D.Collision.b2TimeOfImpact.b2_toiMaxIters=0;Box2D.Collision.b2TimeOfImpact.b2_toiRootIters=0;Box2D.Collision.b2TimeOfImpact.b2_toiMaxRootIters=0;Box2D.Collision.b2TimeOfImpact.s_cache=new g();Box2D.Collision.b2TimeOfImpact.s_distanceInput=new d();Box2D.Collision.b2TimeOfImpact.s_xfA=new e();Box2D.Collision.b2TimeOfImpact.s_xfB=new e();Box2D.Collision.b2TimeOfImpact.s_fcn=new N();Box2D.Collision.b2TimeOfImpact.s_distanceOutput=new z()});Q.b2TOIInput=function(){this.proxyA=new S();this.proxyB=new S();this.sweepA=new p();this.sweepB=new p()};a.b2WorldManifold=function(){this.m_normal=new G()};a.prototype.b2WorldManifold=function(){this.m_points=new Vector(c.b2_maxManifoldPoints);for(var V=0;V<c.b2_maxManifoldPoints;V++){this.m_points[V]=new G()}};a.prototype.Initialize=function(ah,aj,am,ai,al){if(am===undefined){am=0}if(al===undefined){al=0}if(ah.m_pointCount==0){return}var ak=0;var X;var ag;var ab=0;var Z=0;var W=0;var av=0;var ap=0;var ao=0;switch(ah.m_type){case J.e_circles:ag=aj.R;X=ah.m_localPoint;var au=aj.position.x+ag.col1.x*X.x+ag.col2.x*X.y;var ar=aj.position.y+ag.col1.y*X.x+ag.col2.y*X.y;ag=ai.R;X=ah.m_points[0].m_localPoint;var ae=ai.position.x+ag.col1.x*X.x+ag.col2.x*X.y;var ac=ai.position.y+ag.col1.y*X.x+ag.col2.y*X.y;var aa=ae-au;var Y=ac-ar;var aq=aa*aa+Y*Y;if(aq>Number.MIN_VALUE*Number.MIN_VALUE){var an=Math.sqrt(aq);this.m_normal.x=aa/an;this.m_normal.y=Y/an}else{this.m_normal.x=1;this.m_normal.y=0}var V=au+am*this.m_normal.x;var at=ar+am*this.m_normal.y;var af=ae-al*this.m_normal.x;var ad=ac-al*this.m_normal.y;this.m_points[0].x=0.5*(V+af);this.m_points[0].y=0.5*(at+ad);break;case J.e_faceA:ag=aj.R;X=ah.m_localPlaneNormal;ab=ag.col1.x*X.x+ag.col2.x*X.y;Z=ag.col1.y*X.x+ag.col2.y*X.y;ag=aj.R;X=ah.m_localPoint;W=aj.position.x+ag.col1.x*X.x+ag.col2.x*X.y;av=aj.position.y+ag.col1.y*X.x+ag.col2.y*X.y;this.m_normal.x=ab;this.m_normal.y=Z;for(ak=0;ak<ah.m_pointCount;ak++){ag=ai.R;X=ah.m_points[ak].m_localPoint;ap=ai.position.x+ag.col1.x*X.x+ag.col2.x*X.y;ao=ai.position.y+ag.col1.y*X.x+ag.col2.y*X.y;this.m_points[ak].x=ap+0.5*(am-(ap-W)*ab-(ao-av)*Z-al)*ab;this.m_points[ak].y=ao+0.5*(am-(ap-W)*ab-(ao-av)*Z-al)*Z}break;case J.e_faceB:ag=ai.R;X=ah.m_localPlaneNormal;ab=ag.col1.x*X.x+ag.col2.x*X.y;Z=ag.col1.y*X.x+ag.col2.y*X.y;ag=ai.R;X=ah.m_localPoint;W=ai.position.x+ag.col1.x*X.x+ag.col2.x*X.y;av=ai.position.y+ag.col1.y*X.x+ag.col2.y*X.y;this.m_normal.x=(-ab);this.m_normal.y=(-Z);for(ak=0;ak<ah.m_pointCount;ak++){ag=aj.R;X=ah.m_points[ak].m_localPoint;ap=aj.position.x+ag.col1.x*X.x+ag.col2.x*X.y;ao=aj.position.y+ag.col1.y*X.x+ag.col2.y*X.y;this.m_points[ak].x=ap+0.5*(al-(ap-W)*ab-(ao-av)*Z-am)*ab;this.m_points[ak].y=ao+0.5*(al-(ap-W)*ab-(ao-av)*Z-am)*Z}break}};k.ClipVertex=function(){this.v=new G();this.id=new I()};k.prototype.Set=function(V){this.v.SetV(V.v);this.id.Set(V.id)};H.Features=function(){};Object.defineProperty(H.prototype,"referenceEdge",{enumerable:false,configurable:true,get:function(){return this._referenceEdge}});Object.defineProperty(H.prototype,"referenceEdge",{enumerable:false,configurable:true,set:function(V){if(V===undefined){V=0}this._referenceEdge=V;this._m_id._key=(this._m_id._key&4294967040)|(this._referenceEdge&255)}});Object.defineProperty(H.prototype,"incidentEdge",{enumerable:false,configurable:true,get:function(){return this._incidentEdge}});Object.defineProperty(H.prototype,"incidentEdge",{enumerable:false,configurable:true,set:function(V){if(V===undefined){V=0}this._incidentEdge=V;this._m_id._key=(this._m_id._key&4294902015)|((this._incidentEdge<<8)&65280)}});Object.defineProperty(H.prototype,"incidentVertex",{enumerable:false,configurable:true,get:function(){return this._incidentVertex}});Object.defineProperty(H.prototype,"incidentVertex",{enumerable:false,configurable:true,set:function(V){if(V===undefined){V=0}this._incidentVertex=V;this._m_id._key=(this._m_id._key&4278255615)|((this._incidentVertex<<16)&16711680)}});Object.defineProperty(H.prototype,"flip",{enumerable:false,configurable:true,get:function(){return this._flip}});Object.defineProperty(H.prototype,"flip",{enumerable:false,configurable:true,set:function(V){if(V===undefined){V=0}this._flip=V;this._m_id._key=(this._m_id._key&16777215)|((this._flip<<24)&4278190080)}})})();(function(){var u=Box2D.Common.b2Color,O=Box2D.Common.b2internal,c=Box2D.Common.b2Settings,G=Box2D.Collision.Shapes.b2CircleShape,ac=Box2D.Collision.Shapes.b2EdgeChainDef,ah=Box2D.Collision.Shapes.b2EdgeShape,M=Box2D.Collision.Shapes.b2MassData,s=Box2D.Collision.Shapes.b2PolygonShape,l=Box2D.Collision.Shapes.b2Shape,D=Box2D.Common.Math.b2Mat22,k=Box2D.Common.Math.b2Mat33,r=Box2D.Common.Math.b2Math,v=Box2D.Common.Math.b2Sweep,e=Box2D.Common.Math.b2Transform,S=Box2D.Common.Math.b2Vec2,Q=Box2D.Common.Math.b2Vec3,m=Box2D.Dynamics.b2Body,C=Box2D.Dynamics.b2BodyDef,Z=Box2D.Dynamics.b2ContactFilter,B=Box2D.Dynamics.b2ContactImpulse,I=Box2D.Dynamics.b2ContactListener,N=Box2D.Dynamics.b2ContactManager,p=Box2D.Dynamics.b2DebugDraw,f=Box2D.Dynamics.b2DestructionListener,x=Box2D.Dynamics.b2FilterData,ai=Box2D.Dynamics.b2Fixture,t=Box2D.Dynamics.b2FixtureDef,j=Box2D.Dynamics.b2Island,L=Box2D.Dynamics.b2TimeStep,q=Box2D.Dynamics.b2World,ab=Box2D.Collision.b2AABB,b=Box2D.Collision.b2Bound,P=Box2D.Collision.b2BoundValues,w=Box2D.Collision.b2Collision,V=Box2D.Collision.b2ContactID,z=Box2D.Collision.b2ContactPoint,H=Box2D.Collision.b2Distance,d=Box2D.Collision.b2DistanceInput,K=Box2D.Collision.b2DistanceOutput,af=Box2D.Collision.b2DistanceProxy,F=Box2D.Collision.b2DynamicTree,X=Box2D.Collision.b2DynamicTreeBroadPhase,ag=Box2D.Collision.b2DynamicTreeNode,J=Box2D.Collision.b2DynamicTreePair,U=Box2D.Collision.b2Manifold,ae=Box2D.Collision.b2ManifoldPoint,y=Box2D.Collision.b2Point,o=Box2D.Collision.b2RayCastInput,E=Box2D.Collision.b2RayCastOutput,W=Box2D.Collision.b2Segment,aa=Box2D.Collision.b2SeparationFunction,A=Box2D.Collision.b2Simplex,h=Box2D.Collision.b2SimplexCache,g=Box2D.Collision.b2SimplexVertex,Y=Box2D.Collision.b2TimeOfImpact,ad=Box2D.Collision.b2TOIInput,a=Box2D.Collision.b2WorldManifold,n=Box2D.Collision.ClipVertex,T=Box2D.Collision.Features,R=Box2D.Collision.IBroadPhase;Box2D.inherit(G,Box2D.Collision.Shapes.b2Shape);G.prototype.__super=Box2D.Collision.Shapes.b2Shape.prototype;G.b2CircleShape=function(){Box2D.Collision.Shapes.b2Shape.b2Shape.apply(this,arguments);this.m_p=new S()};G.prototype.Copy=function(){var aj=new G();aj.Set(this);return aj};G.prototype.Set=function(aj){this.__super.Set.call(this,aj);if(Box2D.is(aj,G)){var ak=(aj instanceof G?aj:null);this.m_p.SetV(ak.m_p)}};G.prototype.TestPoint=function(al,an){var am=al.R;var ak=al.position.x+(am.col1.x*this.m_p.x+am.col2.x*this.m_p.y);var aj=al.position.y+(am.col1.y*this.m_p.x+am.col2.y*this.m_p.y);ak=an.x-ak;aj=an.y-aj;return(ak*ak+aj*aj)<=this.m_radius*this.m_radius};G.prototype.RayCast=function(am,ax,al){var au=al.R;var ar=al.position.x+(au.col1.x*this.m_p.x+au.col2.x*this.m_p.y);var aq=al.position.y+(au.col1.y*this.m_p.x+au.col2.y*this.m_p.y);var ak=ax.p1.x-ar;var aj=ax.p1.y-aq;var av=(ak*ak+aj*aj)-this.m_radius*this.m_radius;var ap=ax.p2.x-ax.p1.x;var ao=ax.p2.y-ax.p1.y;var at=(ak*ap+aj*ao);var an=(ap*ap+ao*ao);var ay=at*at-an*av;if(ay<0||an<Number.MIN_VALUE){return false}var aw=(-(at+Math.sqrt(ay)));if(0<=aw&&aw<=ax.maxFraction*an){aw/=an;am.fraction=aw;am.normal.x=ak+aw*ap;am.normal.y=aj+aw*ao;am.normal.Normalize();return true}return false};G.prototype.ComputeAABB=function(aj,am){var an=am.R;var al=am.position.x+(an.col1.x*this.m_p.x+an.col2.x*this.m_p.y);var ak=am.position.y+(an.col1.y*this.m_p.x+an.col2.y*this.m_p.y);aj.lowerBound.Set(al-this.m_radius,ak-this.m_radius);aj.upperBound.Set(al+this.m_radius,ak+this.m_radius)};G.prototype.ComputeMass=function(ak,aj){if(aj===undefined){aj=0}ak.mass=aj*c.b2_pi*this.m_radius*this.m_radius;ak.center.SetV(this.m_p);ak.I=ak.mass*(0.5*this.m_radius*this.m_radius+(this.m_p.x*this.m_p.x+this.m_p.y*this.m_p.y))};G.prototype.ComputeSubmergedArea=function(aq,ap,at,ar){if(ap===undefined){ap=0}var ak=r.MulX(at,this.m_p);var ao=(-(r.Dot(aq,ak)-ap));if(ao<(-this.m_radius)+Number.MIN_VALUE){return 0}if(ao>this.m_radius){ar.SetV(ak);return Math.PI*this.m_radius*this.m_radius}var am=this.m_radius*this.m_radius;var an=ao*ao;var aj=am*(Math.asin(ao/this.m_radius)+Math.PI/2)+ao*Math.sqrt(am-an);var al=(-2/3*Math.pow(am-an,1.5)/aj);ar.x=ak.x+aq.x*al;ar.y=ak.y+aq.y*al;return aj};G.prototype.GetLocalPosition=function(){return this.m_p};G.prototype.SetLocalPosition=function(aj){this.m_p.SetV(aj)};G.prototype.GetRadius=function(){return this.m_radius};G.prototype.SetRadius=function(aj){if(aj===undefined){aj=0}this.m_radius=aj};G.prototype.b2CircleShape=function(aj){if(aj===undefined){aj=0}this.__super.b2Shape.call(this);this.m_type=l.e_circleShape;this.m_radius=aj};ac.b2EdgeChainDef=function(){};ac.prototype.b2EdgeChainDef=function(){this.vertexCount=0;this.isALoop=true;this.vertices=[]};Box2D.inherit(ah,Box2D.Collision.Shapes.b2Shape);ah.prototype.__super=Box2D.Collision.Shapes.b2Shape.prototype;ah.b2EdgeShape=function(){Box2D.Collision.Shapes.b2Shape.b2Shape.apply(this,arguments);this.s_supportVec=new S();this.m_v1=new S();this.m_v2=new S();this.m_coreV1=new S();this.m_coreV2=new S();this.m_normal=new S();this.m_direction=new S();this.m_cornerDir1=new S();this.m_cornerDir2=new S()};ah.prototype.TestPoint=function(aj,ak){return false};ah.prototype.RayCast=function(am,aw,al){var ar;var ap=aw.p2.x-aw.p1.x;var an=aw.p2.y-aw.p1.y;ar=al.R;var av=al.position.x+(ar.col1.x*this.m_v1.x+ar.col2.x*this.m_v1.y);var at=al.position.y+(ar.col1.y*this.m_v1.x+ar.col2.y*this.m_v1.y);var aA=al.position.y+(ar.col1.y*this.m_v2.x+ar.col2.y*this.m_v2.y)-at;var ay=(-(al.position.x+(ar.col1.x*this.m_v2.x+ar.col2.x*this.m_v2.y)-av));var aq=100*Number.MIN_VALUE;var ao=(-(ap*aA+an*ay));if(ao>aq){var ak=aw.p1.x-av;var aj=aw.p1.y-at;var au=(ak*aA+aj*ay);if(0<=au&&au<=aw.maxFraction*ao){var ax=(-ap*aj)+an*ak;if((-aq*ao)<=ax&&ax<=ao*(1+aq)){au/=ao;am.fraction=au;var az=Math.sqrt(aA*aA+ay*ay);am.normal.x=aA/az;am.normal.y=ay/az;return true}}}return false};ah.prototype.ComputeAABB=function(al,am){var an=am.R;var ap=am.position.x+(an.col1.x*this.m_v1.x+an.col2.x*this.m_v1.y);var ao=am.position.y+(an.col1.y*this.m_v1.x+an.col2.y*this.m_v1.y);var ak=am.position.x+(an.col1.x*this.m_v2.x+an.col2.x*this.m_v2.y);var aj=am.position.y+(an.col1.y*this.m_v2.x+an.col2.y*this.m_v2.y);if(ap<ak){al.lowerBound.x=ap;al.upperBound.x=ak}else{al.lowerBound.x=ak;al.upperBound.x=ap}if(ao<aj){al.lowerBound.y=ao;al.upperBound.y=aj}else{al.lowerBound.y=aj;al.upperBound.y=ao}};ah.prototype.ComputeMass=function(ak,aj){if(aj===undefined){aj=0}ak.mass=0;ak.center.SetV(this.m_v1);ak.I=0};ah.prototype.ComputeSubmergedArea=function(am,al,aq,an){if(al===undefined){al=0}var ar=new S(am.x*al,am.y*al);var ap=r.MulX(aq,this.m_v1);var ao=r.MulX(aq,this.m_v2);var ak=r.Dot(am,ap)-al;var aj=r.Dot(am,ao)-al;if(ak>0){if(aj>0){return 0}else{ap.x=(-aj/(ak-aj)*ap.x)+ak/(ak-aj)*ao.x;ap.y=(-aj/(ak-aj)*ap.y)+ak/(ak-aj)*ao.y}}else{if(aj>0){ao.x=(-aj/(ak-aj)*ap.x)+ak/(ak-aj)*ao.x;ao.y=(-aj/(ak-aj)*ap.y)+ak/(ak-aj)*ao.y}else{}}an.x=(ar.x+ap.x+ao.x)/3;an.y=(ar.y+ap.y+ao.y)/3;return 0.5*((ap.x-ar.x)*(ao.y-ar.y)-(ap.y-ar.y)*(ao.x-ar.x))};ah.prototype.GetLength=function(){return this.m_length};ah.prototype.GetVertex1=function(){return this.m_v1};ah.prototype.GetVertex2=function(){return this.m_v2};ah.prototype.GetCoreVertex1=function(){return this.m_coreV1};ah.prototype.GetCoreVertex2=function(){return this.m_coreV2};ah.prototype.GetNormalVector=function(){return this.m_normal};ah.prototype.GetDirectionVector=function(){return this.m_direction};ah.prototype.GetCorner1Vector=function(){return this.m_cornerDir1};ah.prototype.GetCorner2Vector=function(){return this.m_cornerDir2};ah.prototype.Corner1IsConvex=function(){return this.m_cornerConvex1};ah.prototype.Corner2IsConvex=function(){return this.m_cornerConvex2};ah.prototype.GetFirstVertex=function(ak){var aj=ak.R;return new S(ak.position.x+(aj.col1.x*this.m_coreV1.x+aj.col2.x*this.m_coreV1.y),ak.position.y+(aj.col1.y*this.m_coreV1.x+aj.col2.y*this.m_coreV1.y))};ah.prototype.GetNextEdge=function(){return this.m_nextEdge};ah.prototype.GetPrevEdge=function(){return this.m_prevEdge};ah.prototype.Support=function(ao,am,ak){if(am===undefined){am=0}if(ak===undefined){ak=0}var an=ao.R;var aq=ao.position.x+(an.col1.x*this.m_coreV1.x+an.col2.x*this.m_coreV1.y);var ap=ao.position.y+(an.col1.y*this.m_coreV1.x+an.col2.y*this.m_coreV1.y);var al=ao.position.x+(an.col1.x*this.m_coreV2.x+an.col2.x*this.m_coreV2.y);var aj=ao.position.y+(an.col1.y*this.m_coreV2.x+an.col2.y*this.m_coreV2.y);if((aq*am+ap*ak)>(al*am+aj*ak)){this.s_supportVec.x=aq;this.s_supportVec.y=ap}else{this.s_supportVec.x=al;this.s_supportVec.y=aj}return this.s_supportVec};ah.prototype.b2EdgeShape=function(ak,aj){this.__super.b2Shape.call(this);this.m_type=l.e_edgeShape;this.m_prevEdge=null;this.m_nextEdge=null;this.m_v1=ak;this.m_v2=aj;this.m_direction.Set(this.m_v2.x-this.m_v1.x,this.m_v2.y-this.m_v1.y);this.m_length=this.m_direction.Normalize();this.m_normal.Set(this.m_direction.y,(-this.m_direction.x));this.m_coreV1.Set((-c.b2_toiSlop*(this.m_normal.x-this.m_direction.x))+this.m_v1.x,(-c.b2_toiSlop*(this.m_normal.y-this.m_direction.y))+this.m_v1.y);this.m_coreV2.Set((-c.b2_toiSlop*(this.m_normal.x+this.m_direction.x))+this.m_v2.x,(-c.b2_toiSlop*(this.m_normal.y+this.m_direction.y))+this.m_v2.y);this.m_cornerDir1=this.m_normal;this.m_cornerDir2.Set((-this.m_normal.x),(-this.m_normal.y))};ah.prototype.SetPrevEdge=function(am,aj,al,ak){this.m_prevEdge=am;this.m_coreV1=aj;this.m_cornerDir1=al;this.m_cornerConvex1=ak};ah.prototype.SetNextEdge=function(am,aj,al,ak){this.m_nextEdge=am;this.m_coreV2=aj;this.m_cornerDir2=al;this.m_cornerConvex2=ak};M.b2MassData=function(){this.mass=0;this.center=new S(0,0);this.I=0};Box2D.inherit(s,Box2D.Collision.Shapes.b2Shape);s.prototype.__super=Box2D.Collision.Shapes.b2Shape.prototype;s.b2PolygonShape=function(){Box2D.Collision.Shapes.b2Shape.b2Shape.apply(this,arguments)};s.prototype.Copy=function(){var aj=new s();aj.Set(this);return aj};s.prototype.Set=function(aj){this.__super.Set.call(this,aj);if(Box2D.is(aj,s)){var al=(aj instanceof s?aj:null);this.m_centroid.SetV(al.m_centroid);this.m_vertexCount=al.m_vertexCount;this.Reserve(this.m_vertexCount);for(var ak=0;ak<this.m_vertexCount;ak++){this.m_vertices[ak].SetV(al.m_vertices[ak]);this.m_normals[ak].SetV(al.m_normals[ak])}}};s.prototype.SetAsArray=function(ak,an){if(an===undefined){an=0}var aj=new Vector();var am=0,al;for(am=0;am<ak.length;++am){al=ak[am];aj.push(al)}this.SetAsVector(aj,an)};s.AsArray=function(ak,al){if(al===undefined){al=0}var aj=new s();aj.SetAsArray(ak,al);return aj};s.prototype.SetAsVector=function(aj,am){if(am===undefined){am=0}if(am==0){am=aj.length}c.b2Assert(2<=am);this.m_vertexCount=am;this.Reserve(am);var ak=0;for(ak=0;ak<this.m_vertexCount;ak++){this.m_vertices[ak].SetV(aj[ak])}for(ak=0;ak<this.m_vertexCount;++ak){var ao=parseInt(ak);var al=parseInt(ak+1<this.m_vertexCount?ak+1:0);var an=r.SubtractVV(this.m_vertices[al],this.m_vertices[ao]);c.b2Assert(an.LengthSquared()>Number.MIN_VALUE);this.m_normals[ak].SetV(r.CrossVF(an,1));this.m_normals[ak].Normalize()}this.m_centroid=s.ComputeCentroid(this.m_vertices,this.m_vertexCount)};s.AsVector=function(ak,al){if(al===undefined){al=0}var aj=new s();aj.SetAsVector(ak,al);return aj};s.prototype.SetAsBox=function(ak,aj){if(ak===undefined){ak=0}if(aj===undefined){aj=0}this.m_vertexCount=4;this.Reserve(4);this.m_vertices[0].Set((-ak),(-aj));this.m_vertices[1].Set(ak,(-aj));this.m_vertices[2].Set(ak,aj);this.m_vertices[3].Set((-ak),aj);this.m_normals[0].Set(0,(-1));this.m_normals[1].Set(1,0);this.m_normals[2].Set(0,1);this.m_normals[3].Set((-1),0);this.m_centroid.SetZero()};s.AsBox=function(al,ak){if(al===undefined){al=0}if(ak===undefined){ak=0}var aj=new s();aj.SetAsBox(al,ak);return aj};s.prototype.SetAsOrientedBox=function(ao,an,aj,am){if(ao===undefined){ao=0}if(an===undefined){an=0}if(aj===undefined){aj=null}if(am===undefined){am=0}this.m_vertexCount=4;this.Reserve(4);this.m_vertices[0].Set((-ao),(-an));this.m_vertices[1].Set(ao,(-an));this.m_vertices[2].Set(ao,an);this.m_vertices[3].Set((-ao),an);this.m_normals[0].Set(0,(-1));this.m_normals[1].Set(1,0);this.m_normals[2].Set(0,1);this.m_normals[3].Set((-1),0);this.m_centroid=aj;var al=new e();al.position=aj;al.R.Set(am);for(var ak=0;ak<this.m_vertexCount;++ak){this.m_vertices[ak]=r.MulX(al,this.m_vertices[ak]);this.m_normals[ak]=r.MulMV(al.R,this.m_normals[ak])}};s.AsOrientedBox=function(an,am,ak,al){if(an===undefined){an=0}if(am===undefined){am=0}if(ak===undefined){ak=null}if(al===undefined){al=0}var aj=new s();aj.SetAsOrientedBox(an,am,ak,al);return aj};s.prototype.SetAsEdge=function(ak,aj){this.m_vertexCount=2;this.Reserve(2);this.m_vertices[0].SetV(ak);this.m_vertices[1].SetV(aj);this.m_centroid.x=0.5*(ak.x+aj.x);this.m_centroid.y=0.5*(ak.y+aj.y);this.m_normals[0]=r.CrossVF(r.SubtractVV(aj,ak),1);this.m_normals[0].Normalize();this.m_normals[1].x=(-this.m_normals[0].x);this.m_normals[1].y=(-this.m_normals[0].y)};s.AsEdge=function(al,ak){var aj=new s();aj.SetAsEdge(al,ak);return aj};s.prototype.TestPoint=function(aq,ak){var at;var ao=aq.R;var ar=ak.x-aq.position.x;var ap=ak.y-aq.position.y;var am=(ar*ao.col1.x+ap*ao.col1.y);var al=(ar*ao.col2.x+ap*ao.col2.y);for(var an=0;an<this.m_vertexCount;++an){at=this.m_vertices[an];ar=am-at.x;ap=al-at.y;at=this.m_normals[an];var aj=(at.x*ar+at.y*ap);if(aj>0){return false}}return true};s.prototype.RayCast=function(aq,at,au){var aB=0;var aA=at.maxFraction;var aw=0;var av=0;var ar;var am;aw=at.p1.x-au.position.x;av=at.p1.y-au.position.y;ar=au.R;var ay=(aw*ar.col1.x+av*ar.col1.y);var ax=(aw*ar.col2.x+av*ar.col2.y);aw=at.p2.x-au.position.x;av=at.p2.y-au.position.y;ar=au.R;var al=(aw*ar.col1.x+av*ar.col1.y);var ak=(aw*ar.col2.x+av*ar.col2.y);var ao=al-ay;var an=ak-ax;var ap=parseInt((-1));for(var az=0;az<this.m_vertexCount;++az){am=this.m_vertices[az];aw=am.x-ay;av=am.y-ax;am=this.m_normals[az];var aC=(am.x*aw+am.y*av);var aj=(am.x*ao+am.y*an);if(aj==0){if(aC<0){return false}}else{if(aj<0&&aC<aB*aj){aB=aC/aj;ap=az}else{if(aj>0&&aC<aA*aj){aA=aC/aj}}}if(aA<aB-Number.MIN_VALUE){return false}}if(ap>=0){aq.fraction=aB;ar=au.R;am=this.m_normals[ap];aq.normal.x=(ar.col1.x*am.x+ar.col2.x*am.y);aq.normal.y=(ar.col1.y*am.x+ar.col2.y*am.y);return true}return false};s.prototype.ComputeAABB=function(ao,aq){var ap=aq.R;var au=this.m_vertices[0];var at=aq.position.x+(ap.col1.x*au.x+ap.col2.x*au.y);var ar=aq.position.y+(ap.col1.y*au.x+ap.col2.y*au.y);var am=at;var al=ar;for(var an=1;an<this.m_vertexCount;++an){au=this.m_vertices[an];var ak=aq.position.x+(ap.col1.x*au.x+ap.col2.x*au.y);var aj=aq.position.y+(ap.col1.y*au.x+ap.col2.y*au.y);at=at<ak?at:ak;ar=ar<aj?ar:aj;am=am>ak?am:ak;al=al>aj?al:aj}ao.lowerBound.x=at-this.m_radius;ao.lowerBound.y=ar-this.m_radius;ao.upperBound.x=am+this.m_radius;ao.upperBound.y=al+this.m_radius};s.prototype.ComputeMass=function(av,ar){if(ar===undefined){ar=0}if(this.m_vertexCount==2){av.center.x=0.5*(this.m_vertices[0].x+this.m_vertices[1].x);av.center.y=0.5*(this.m_vertices[0].y+this.m_vertices[1].y);av.mass=0;av.I=0;return}var at=0;var aq=0;var aH=0;var au=0;var aF=0;var aE=0;var ap=1/3;for(var aG=0;aG<this.m_vertexCount;++aG){var am=this.m_vertices[aG];var al=aG+1<this.m_vertexCount?this.m_vertices[parseInt(aG+1)]:this.m_vertices[0];var aD=am.x-aF;var aB=am.y-aE;var ak=al.x-aF;var aJ=al.y-aE;var ay=aD*aJ-aB*ak;var ao=0.5*ay;aH+=ao;at+=ao*ap*(aF+am.x+al.x);aq+=ao*ap*(aE+am.y+al.y);var az=aF;var ax=aE;var aC=aD;var aj=aB;var aA=ak;var aI=aJ;var an=ap*(0.25*(aC*aC+aA*aC+aA*aA)+(az*aC+az*aA))+0.5*az*az;var aw=ap*(0.25*(aj*aj+aI*aj+aI*aI)+(ax*aj+ax*aI))+0.5*ax*ax;au+=ay*(an+aw)}av.mass=ar*aH;at*=1/aH;aq*=1/aH;av.center.Set(at,aq);av.I=ar*au};s.prototype.ComputeSubmergedArea=function(aH,au,aA,aE){if(au===undefined){au=0}var ay=r.MulTMV(aA.R,aH);var am=au-r.Dot(aH,aA.position);var aw=new Vector_a2j_Number();var av=0;var an=parseInt((-1));var ak=parseInt((-1));var at=false;var aC=0;for(aC=0;aC<this.m_vertexCount;++aC){aw[aC]=r.Dot(ay,this.m_vertices[aC])-am;var ap=aw[aC]<(-Number.MIN_VALUE);if(aC>0){if(ap){if(!at){an=aC-1;av++}}else{if(at){ak=aC-1;av++}}}at=ap}switch(av){case 0:if(at){var aG=new M();this.ComputeMass(aG,1);aE.SetV(r.MulX(aA,aG.center));return aG.mass}else{return 0}break;case 1:if(an==(-1)){an=this.m_vertexCount-1}else{ak=this.m_vertexCount-1}break}var ax=parseInt((an+1)%this.m_vertexCount);var az=parseInt((ak+1)%this.m_vertexCount);var aB=(0-aw[an])/(aw[ax]-aw[an]);var aI=(0-aw[ak])/(aw[az]-aw[ak]);var aq=new S(this.m_vertices[an].x*(1-aB)+this.m_vertices[ax].x*aB,this.m_vertices[an].y*(1-aB)+this.m_vertices[ax].y*aB);var ao=new S(this.m_vertices[ak].x*(1-aI)+this.m_vertices[az].x*aI,this.m_vertices[ak].y*(1-aI)+this.m_vertices[az].y*aI);var aD=0;var aF=new S();var al=this.m_vertices[ax];var aj;aC=ax;while(aC!=az){aC=(aC+1)%this.m_vertexCount;if(aC==az){aj=ao}else{aj=this.m_vertices[aC]}var ar=0.5*((al.x-aq.x)*(aj.y-aq.y)-(al.y-aq.y)*(aj.x-aq.x));aD+=ar;aF.x+=ar*(aq.x+al.x+aj.x)/3;aF.y+=ar*(aq.y+al.y+aj.y)/3;al=aj}aF.Multiply(1/aD);aE.SetV(r.MulX(aA,aF));return aD};s.prototype.GetVertexCount=function(){return this.m_vertexCount};s.prototype.GetVertices=function(){return this.m_vertices};s.prototype.GetNormals=function(){return this.m_normals};s.prototype.GetSupport=function(an){var ak=0;var am=this.m_vertices[0].x*an.x+this.m_vertices[0].y*an.y;for(var aj=1;aj<this.m_vertexCount;++aj){var al=this.m_vertices[aj].x*an.x+this.m_vertices[aj].y*an.y;if(al>am){ak=aj;am=al}}return ak};s.prototype.GetSupportVertex=function(an){var ak=0;var am=this.m_vertices[0].x*an.x+this.m_vertices[0].y*an.y;for(var aj=1;aj<this.m_vertexCount;++aj){var al=this.m_vertices[aj].x*an.x+this.m_vertices[aj].y*an.y;if(al>am){ak=aj;am=al}}return this.m_vertices[ak]};s.prototype.Validate=function(){return false};s.prototype.b2PolygonShape=function(){this.__super.b2Shape.call(this);this.m_type=l.e_polygonShape;this.m_centroid=new S();this.m_vertices=new Vector();this.m_normals=new Vector()};s.prototype.Reserve=function(ak){if(ak===undefined){ak=0}for(var aj=parseInt(this.m_vertices.length);aj<ak;aj++){this.m_vertices[aj]=new S();this.m_normals[aj]=new S()}};s.ComputeCentroid=function(az,ar){if(ar===undefined){ar=0}var au=new S();var am=0;var aq=0;var ap=0;var an=1/3;for(var ao=0;ao<ar;++ao){var ay=az[ao];var aw=ao+1<ar?az[parseInt(ao+1)]:az[0];var al=ay.x-aq;var ak=ay.y-ap;var av=aw.x-aq;var at=aw.y-ap;var aj=(al*at-ak*av);var ax=0.5*aj;am+=ax;au.x+=ax*an*(aq+ay.x+aw.x);au.y+=ax*an*(ap+ay.y+aw.y)}au.x*=1/am;au.y*=1/am;return au};s.ComputeOBB=function(ay,aB,ar){if(ar===undefined){ar=0}var aD=0;var aw=new Vector(ar+1);for(aD=0;aD<ar;++aD){aw[aD]=aB[aD]}aw[ar]=aw[0];var aq=Number.MAX_VALUE;for(aD=1;aD<=ar;++aD){var aA=aw[parseInt(aD-1)];var az=aw[aD].x-aA.x;var ax=aw[aD].y-aA.y;var an=Math.sqrt(az*az+ax*ax);az/=an;ax/=an;var ak=(-ax);var aj=az;var ap=Number.MAX_VALUE;var ao=Number.MAX_VALUE;var aI=(-Number.MAX_VALUE);var aH=(-Number.MAX_VALUE);for(var aC=0;aC<ar;++aC){var am=aw[aC].x-aA.x;var al=aw[aC].y-aA.y;var aG=(az*am+ax*al);var aF=(ak*am+aj*al);if(aG<ap){ap=aG}if(aF<ao){ao=aF}if(aG>aI){aI=aG}if(aF>aH){aH=aF}}var aE=(aI-ap)*(aH-ao);if(aE<0.95*aq){aq=aE;ay.R.col1.x=az;ay.R.col1.y=ax;ay.R.col2.x=ak;ay.R.col2.y=aj;var au=0.5*(ap+aI);var at=0.5*(ao+aH);var av=ay.R;ay.center.x=aA.x+(av.col1.x*au+av.col2.x*at);ay.center.y=aA.y+(av.col1.y*au+av.col2.y*at);ay.extents.x=0.5*(aI-ap);ay.extents.y=0.5*(aH-ao)}}};Box2D.postDefs.push(function(){Box2D.Collision.Shapes.b2PolygonShape.s_mat=new D()});l.b2Shape=function(){};l.prototype.Copy=function(){return null};l.prototype.Set=function(aj){this.m_radius=aj.m_radius};l.prototype.GetType=function(){return this.m_type};l.prototype.TestPoint=function(aj,ak){return false};l.prototype.RayCast=function(ak,aj,al){return false};l.prototype.ComputeAABB=function(aj,ak){};l.prototype.ComputeMass=function(ak,aj){if(aj===undefined){aj=0}};l.prototype.ComputeSubmergedArea=function(ak,al,aj,am){if(al===undefined){al=0}return 0};l.TestOverlap=function(ak,ap,aj,ao){var an=new d();an.proxyA=new af();an.proxyA.Set(ak);an.proxyB=new af();an.proxyB.Set(aj);an.transformA=ap;an.transformB=ao;an.useRadii=true;var am=new h();am.count=0;var al=new K();H.Distance(al,am,an);return al.distance<10*Number.MIN_VALUE};l.prototype.b2Shape=function(){this.m_type=l.e_unknownShape;this.m_radius=c.b2_linearSlop};Box2D.postDefs.push(function(){Box2D.Collision.Shapes.b2Shape.e_unknownShape=parseInt((-1));Box2D.Collision.Shapes.b2Shape.e_circleShape=0;Box2D.Collision.Shapes.b2Shape.e_polygonShape=1;Box2D.Collision.Shapes.b2Shape.e_edgeShape=2;Box2D.Collision.Shapes.b2Shape.e_shapeTypeCount=3;Box2D.Collision.Shapes.b2Shape.e_hitCollide=1;Box2D.Collision.Shapes.b2Shape.e_missCollide=0;Box2D.Collision.Shapes.b2Shape.e_startsInsideCollide=parseInt((-1))})})();(function(){var g=Box2D.Common.b2Color,d=Box2D.Common.b2internal,k=Box2D.Common.b2Settings,a=Box2D.Common.Math.b2Mat22,h=Box2D.Common.Math.b2Mat33,j=Box2D.Common.Math.b2Math,c=Box2D.Common.Math.b2Sweep,b=Box2D.Common.Math.b2Transform,f=Box2D.Common.Math.b2Vec2,e=Box2D.Common.Math.b2Vec3;g.b2Color=function(){this._r=0;this._g=0;this._b=0};g.prototype.b2Color=function(m,l,n){if(m===undefined){m=0}if(l===undefined){l=0}if(n===undefined){n=0}this._r=Box2D.parseUInt(255*j.Clamp(m,0,1));this._g=Box2D.parseUInt(255*j.Clamp(l,0,1));this._b=Box2D.parseUInt(255*j.Clamp(n,0,1))};g.prototype.Set=function(m,l,n){if(m===undefined){m=0}if(l===undefined){l=0}if(n===undefined){n=0}this._r=Box2D.parseUInt(255*j.Clamp(m,0,1));this._g=Box2D.parseUInt(255*j.Clamp(l,0,1));this._b=Box2D.parseUInt(255*j.Clamp(n,0,1))};Object.defineProperty(g.prototype,"r",{enumerable:false,configurable:true,set:function(l){if(l===undefined){l=0}this._r=Box2D.parseUInt(255*j.Clamp(l,0,1))}});Object.defineProperty(g.prototype,"g",{enumerable:false,configurable:true,set:function(l){if(l===undefined){l=0}this._g=Box2D.parseUInt(255*j.Clamp(l,0,1))}});Object.defineProperty(g.prototype,"b",{enumerable:false,configurable:true,set:function(l){if(l===undefined){l=0}this._b=Box2D.parseUInt(255*j.Clamp(l,0,1))}});Object.defineProperty(g.prototype,"color",{enumerable:false,configurable:true,get:function(){return(this._r<<16)|(this._g<<8)|(this._b)}});k.b2Settings=function(){};k.b2MixFriction=function(m,l){if(m===undefined){m=0}if(l===undefined){l=0}return Math.sqrt(m*l)};k.b2MixRestitution=function(l,m){if(l===undefined){l=0}if(m===undefined){m=0}return l>m?l:m};k.b2Assert=function(l){if(!l){throw"Assertion Failed"}};Box2D.postDefs.push(function(){Box2D.Common.b2Settings.VERSION="2.1alpha";Box2D.Common.b2Settings.USHRT_MAX=65535;Box2D.Common.b2Settings.b2_pi=Math.PI;Box2D.Common.b2Settings.b2_maxManifoldPoints=2;Box2D.Common.b2Settings.b2_aabbExtension=0.1;Box2D.Common.b2Settings.b2_aabbMultiplier=2;Box2D.Common.b2Settings.b2_polygonRadius=2*k.b2_linearSlop;Box2D.Common.b2Settings.b2_linearSlop=0.005;Box2D.Common.b2Settings.b2_angularSlop=2/180*k.b2_pi;Box2D.Common.b2Settings.b2_toiSlop=8*k.b2_linearSlop;Box2D.Common.b2Settings.b2_maxTOIContactsPerIsland=32;Box2D.Common.b2Settings.b2_maxTOIJointsPerIsland=32;Box2D.Common.b2Settings.b2_velocityThreshold=1;Box2D.Common.b2Settings.b2_maxLinearCorrection=0.2;Box2D.Common.b2Settings.b2_maxAngularCorrection=8/180*k.b2_pi;Box2D.Common.b2Settings.b2_maxTranslation=2;Box2D.Common.b2Settings.b2_maxTranslationSquared=k.b2_maxTranslation*k.b2_maxTranslation;Box2D.Common.b2Settings.b2_maxRotation=0.5*k.b2_pi;Box2D.Common.b2Settings.b2_maxRotationSquared=k.b2_maxRotation*k.b2_maxRotation;Box2D.Common.b2Settings.b2_contactBaumgarte=0.2;Box2D.Common.b2Settings.b2_timeToSleep=0.5;Box2D.Common.b2Settings.b2_linearSleepTolerance=0.01;Box2D.Common.b2Settings.b2_angularSleepTolerance=2/180*k.b2_pi})})();(function(){var a=Box2D.Collision.b2AABB,h=Box2D.Common.b2Color,e=Box2D.Common.b2internal,l=Box2D.Common.b2Settings,c=Box2D.Common.Math.b2Mat22,j=Box2D.Common.Math.b2Mat33,k=Box2D.Common.Math.b2Math,d=Box2D.Common.Math.b2Sweep,b=Box2D.Common.Math.b2Transform,g=Box2D.Common.Math.b2Vec2,f=Box2D.Common.Math.b2Vec3;c.b2Mat22=function(){this.col1=new g();this.col2=new g()};c.prototype.b2Mat22=function(){this.SetIdentity()};c.FromAngle=function(n){if(n===undefined){n=0}var m=new c();m.Set(n);return m};c.FromVV=function(o,n){var m=new c();m.SetVV(o,n);return m};c.prototype.Set=function(n){if(n===undefined){n=0}var o=Math.cos(n);var m=Math.sin(n);this.col1.x=o;this.col2.x=(-m);this.col1.y=m;this.col2.y=o};c.prototype.SetVV=function(n,m){this.col1.SetV(n);this.col2.SetV(m)};c.prototype.Copy=function(){var m=new c();m.SetM(this);return m};c.prototype.SetM=function(n){this.col1.SetV(n.col1);this.col2.SetV(n.col2)};c.prototype.AddM=function(n){this.col1.x+=n.col1.x;this.col1.y+=n.col1.y;this.col2.x+=n.col2.x;this.col2.y+=n.col2.y};c.prototype.SetIdentity=function(){this.col1.x=1;this.col2.x=0;this.col1.y=0;this.col2.y=1};c.prototype.SetZero=function(){this.col1.x=0;this.col2.x=0;this.col1.y=0;this.col2.y=0};c.prototype.GetAngle=function(){return Math.atan2(this.col1.y,this.col1.x)};c.prototype.GetInverse=function(o){var n=this.col1.x;var m=this.col2.x;var r=this.col1.y;var q=this.col2.y;var p=n*q-m*r;if(p!=0){p=1/p}o.col1.x=p*q;o.col2.x=(-p*m);o.col1.y=(-p*r);o.col2.y=p*n;return o};c.prototype.Solve=function(q,t,s){if(t===undefined){t=0}if(s===undefined){s=0}var n=this.col1.x;var m=this.col2.x;var p=this.col1.y;var o=this.col2.y;var r=n*o-m*p;if(r!=0){r=1/r}q.x=r*(o*t-m*s);q.y=r*(n*s-p*t);return q};c.prototype.Abs=function(){this.col1.Abs();this.col2.Abs()};j.b2Mat33=function(){this.col1=new f();this.col2=new f();this.col3=new f()};j.prototype.b2Mat33=function(o,n,m){if(o===undefined){o=null}if(n===undefined){n=null}if(m===undefined){m=null}if(!o&&!n&&!m){this.col1.SetZero();this.col2.SetZero();this.col3.SetZero()}else{this.col1.SetV(o);this.col2.SetV(n);this.col3.SetV(m)}};j.prototype.SetVVV=function(o,n,m){this.col1.SetV(o);this.col2.SetV(n);this.col3.SetV(m)};j.prototype.Copy=function(){return new j(this.col1,this.col2,this.col3)};j.prototype.SetM=function(n){this.col1.SetV(n.col1);this.col2.SetV(n.col2);this.col3.SetV(n.col3)};j.prototype.AddM=function(n){this.col1.x+=n.col1.x;this.col1.y+=n.col1.y;this.col1.z+=n.col1.z;this.col2.x+=n.col2.x;this.col2.y+=n.col2.y;this.col2.z+=n.col2.z;this.col3.x+=n.col3.x;this.col3.y+=n.col3.y;this.col3.z+=n.col3.z};j.prototype.SetIdentity=function(){this.col1.x=1;this.col2.x=0;this.col3.x=0;this.col1.y=0;this.col2.y=1;this.col3.y=0;this.col1.z=0;this.col2.z=0;this.col3.z=1};j.prototype.SetZero=function(){this.col1.x=0;this.col2.x=0;this.col3.x=0;this.col1.y=0;this.col2.y=0;this.col3.y=0;this.col1.z=0;this.col2.z=0;this.col3.z=0};j.prototype.Solve22=function(q,t,s){if(t===undefined){t=0}if(s===undefined){s=0}var n=this.col1.x;var m=this.col2.x;var p=this.col1.y;var o=this.col2.y;var r=n*o-m*p;if(r!=0){r=1/r}q.x=r*(o*t-m*s);q.y=r*(n*s-p*t);return q};j.prototype.Solve33=function(r,n,m,z){if(n===undefined){n=0}if(m===undefined){m=0}if(z===undefined){z=0}var y=this.col1.x;var v=this.col1.y;var q=this.col1.z;var x=this.col2.x;var t=this.col2.y;var p=this.col2.z;var w=this.col3.x;var s=this.col3.y;var o=this.col3.z;var u=y*(t*o-p*s)+v*(p*w-x*o)+q*(x*s-t*w);if(u!=0){u=1/u}r.x=u*(n*(t*o-p*s)+m*(p*w-x*o)+z*(x*s-t*w));r.y=u*(y*(m*o-z*s)+v*(z*w-n*o)+q*(n*s-m*w));r.z=u*(y*(t*z-p*m)+v*(p*n-x*z)+q*(x*m-t*n));return r};k.b2Math=function(){};k.IsValid=function(m){if(m===undefined){m=0}return isFinite(m)};k.Dot=function(n,m){return n.x*m.x+n.y*m.y};k.CrossVV=function(n,m){return n.x*m.y-n.y*m.x};k.CrossVF=function(m,o){if(o===undefined){o=0}var n=new g(o*m.y,(-o*m.x));return n};k.CrossFV=function(o,m){if(o===undefined){o=0}var n=new g((-o*m.y),o*m.x);return n};k.MulMV=function(m,n){var o=new g(m.col1.x*n.x+m.col2.x*n.y,m.col1.y*n.x+m.col2.y*n.y);return o};k.MulTMV=function(m,n){var o=new g(k.Dot(n,m.col1),k.Dot(n,m.col2));return o};k.MulX=function(o,n){var m=k.MulMV(o.R,n);m.x+=o.position.x;m.y+=o.position.y;return m};k.MulXT=function(p,o){var n=k.SubtractVV(o,p.position);var m=(n.x*p.R.col1.x+n.y*p.R.col1.y);n.y=(n.x*p.R.col2.x+n.y*p.R.col2.y);n.x=m;return n};k.AddVV=function(n,m){var o=new g(n.x+m.x,n.y+m.y);return o};k.SubtractVV=function(n,m){var o=new g(n.x-m.x,n.y-m.y);return o};k.Distance=function(n,m){var p=n.x-m.x;var o=n.y-m.y;return Math.sqrt(p*p+o*o)};k.DistanceSquared=function(n,m){var p=n.x-m.x;var o=n.y-m.y;return(p*p+o*o)};k.MulFV=function(o,m){if(o===undefined){o=0}var n=new g(o*m.x,o*m.y);return n};k.AddMM=function(m,o){var n=c.FromVV(k.AddVV(m.col1,o.col1),k.AddVV(m.col2,o.col2));return n};k.MulMM=function(m,o){var n=c.FromVV(k.MulMV(m,o.col1),k.MulMV(m,o.col2));return n};k.MulTMM=function(m,q){var o=new g(k.Dot(m.col1,q.col1),k.Dot(m.col2,q.col1));var n=new g(k.Dot(m.col1,q.col2),k.Dot(m.col2,q.col2));var p=c.FromVV(o,n);return p};k.Abs=function(m){if(m===undefined){m=0}return m>0?m:(-m)};k.AbsV=function(n){var m=new g(k.Abs(n.x),k.Abs(n.y));return m};k.AbsM=function(m){var n=c.FromVV(k.AbsV(m.col1),k.AbsV(m.col2));return n};k.Min=function(n,m){if(n===undefined){n=0}if(m===undefined){m=0}return n<m?n:m};k.MinV=function(n,m){var o=new g(k.Min(n.x,m.x),k.Min(n.y,m.y));return o};k.Max=function(n,m){if(n===undefined){n=0}if(m===undefined){m=0}return n>m?n:m};k.MaxV=function(n,m){var o=new g(k.Max(n.x,m.x),k.Max(n.y,m.y));return o};k.Clamp=function(n,m,o){if(n===undefined){n=0}if(m===undefined){m=0}if(o===undefined){o=0}return n<m?m:n>o?o:n};k.ClampV=function(n,m,o){return k.MaxV(m,k.MinV(n,o))};k.Swap=function(n,m){var o=n[0];n[0]=m[0];m[0]=o};k.Random=function(){return Math.random()*2-1};k.RandomRange=function(n,m){if(n===undefined){n=0}if(m===undefined){m=0}var o=Math.random();o=(m-n)*o+n;return o};k.NextPowerOfTwo=function(m){if(m===undefined){m=0}m|=(m>>1)&2147483647;m|=(m>>2)&1073741823;m|=(m>>4)&268435455;m|=(m>>8)&16777215;m|=(m>>16)&65535;return m+1};k.IsPowerOfTwo=function(n){if(n===undefined){n=0}var m=n>0&&(n&(n-1))==0;return m};Box2D.postDefs.push(function(){Box2D.Common.Math.b2Math.b2Vec2_zero=new g(0,0);Box2D.Common.Math.b2Math.b2Mat22_identity=c.FromVV(new g(1,0),new g(0,1));Box2D.Common.Math.b2Math.b2Transform_identity=new b(k.b2Vec2_zero,k.b2Mat22_identity)});d.b2Sweep=function(){this.localCenter=new g();this.c0=new g;this.c=new g()};d.prototype.Set=function(m){this.localCenter.SetV(m.localCenter);this.c0.SetV(m.c0);this.c.SetV(m.c);this.a0=m.a0;this.a=m.a;this.t0=m.t0};d.prototype.Copy=function(){var m=new d();m.localCenter.SetV(this.localCenter);m.c0.SetV(this.c0);m.c.SetV(this.c);m.a0=this.a0;m.a=this.a;m.t0=this.t0;return m};d.prototype.GetTransform=function(n,o){if(o===undefined){o=0}n.position.x=(1-o)*this.c0.x+o*this.c.x;n.position.y=(1-o)*this.c0.y+o*this.c.y;var p=(1-o)*this.a0+o*this.a;n.R.Set(p);var m=n.R;n.position.x-=(m.col1.x*this.localCenter.x+m.col2.x*this.localCenter.y);n.position.y-=(m.col1.y*this.localCenter.x+m.col2.y*this.localCenter.y)};d.prototype.Advance=function(m){if(m===undefined){m=0}if(this.t0<m&&1-this.t0>Number.MIN_VALUE){var n=(m-this.t0)/(1-this.t0);this.c0.x=(1-n)*this.c0.x+n*this.c.x;this.c0.y=(1-n)*this.c0.y+n*this.c.y;this.a0=(1-n)*this.a0+n*this.a;this.t0=m}};b.b2Transform=function(){this.position=new g;this.R=new c()};b.prototype.b2Transform=function(n,m){if(n===undefined){n=null}if(m===undefined){m=null}if(n){this.position.SetV(n);this.R.SetM(m)}};b.prototype.Initialize=function(n,m){this.position.SetV(n);this.R.SetM(m)};b.prototype.SetIdentity=function(){this.position.SetZero();this.R.SetIdentity()};b.prototype.Set=function(m){this.position.SetV(m.position);this.R.SetM(m.R)};b.prototype.GetAngle=function(){return Math.atan2(this.R.col1.y,this.R.col1.x)};g.b2Vec2=function(){};g.prototype.b2Vec2=function(m,n){if(m===undefined){m=0}if(n===undefined){n=0}this.x=m;this.y=n};g.prototype.SetZero=function(){this.x=0;this.y=0};g.prototype.Set=function(m,n){if(m===undefined){m=0}if(n===undefined){n=0}this.x=m;this.y=n};g.prototype.SetV=function(m){this.x=m.x;this.y=m.y};g.prototype.GetNegative=function(){return new g((-this.x),(-this.y))};g.prototype.NegativeSelf=function(){this.x=(-this.x);this.y=(-this.y)};g.Make=function(m,n){if(m===undefined){m=0}if(n===undefined){n=0}return new g(m,n)};g.prototype.Copy=function(){return new g(this.x,this.y)};g.prototype.Add=function(m){this.x+=m.x;this.y+=m.y};g.prototype.Subtract=function(m){this.x-=m.x;this.y-=m.y};g.prototype.Multiply=function(m){if(m===undefined){m=0}this.x*=m;this.y*=m};g.prototype.MulM=function(n){var m=this.x;this.x=n.col1.x*m+n.col2.x*this.y;this.y=n.col1.y*m+n.col2.y*this.y};g.prototype.MulTM=function(n){var m=k.Dot(this,n.col1);this.y=k.Dot(this,n.col2);this.x=m};g.prototype.CrossVF=function(n){if(n===undefined){n=0}var m=this.x;this.x=n*this.y;this.y=(-n*m)};g.prototype.CrossFV=function(n){if(n===undefined){n=0}var m=this.x;this.x=(-n*this.y);this.y=n*m};g.prototype.MinV=function(m){this.x=this.x<m.x?this.x:m.x;this.y=this.y<m.y?this.y:m.y};g.prototype.MaxV=function(m){this.x=this.x>m.x?this.x:m.x;this.y=this.y>m.y?this.y:m.y};g.prototype.Abs=function(){if(this.x<0){this.x=(-this.x)}if(this.y<0){this.y=(-this.y)}};g.prototype.Length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)};g.prototype.LengthSquared=function(){return(this.x*this.x+this.y*this.y)};g.prototype.Normalize=function(){var n=Math.sqrt(this.x*this.x+this.y*this.y);if(n<Number.MIN_VALUE){return 0}var m=1/n;this.x*=m;this.y*=m;return n};g.prototype.IsValid=function(){return k.IsValid(this.x)&&k.IsValid(this.y)};f.b2Vec3=function(){};f.prototype.b2Vec3=function(m,o,n){if(m===undefined){m=0}if(o===undefined){o=0}if(n===undefined){n=0}this.x=m;this.y=o;this.z=n};f.prototype.SetZero=function(){this.x=this.y=this.z=0};f.prototype.Set=function(m,o,n){if(m===undefined){m=0}if(o===undefined){o=0}if(n===undefined){n=0}this.x=m;this.y=o;this.z=n};f.prototype.SetV=function(m){this.x=m.x;this.y=m.y;this.z=m.z};f.prototype.GetNegative=function(){return new f((-this.x),(-this.y),(-this.z))};f.prototype.NegativeSelf=function(){this.x=(-this.x);this.y=(-this.y);this.z=(-this.z)};f.prototype.Copy=function(){return new f(this.x,this.y,this.z)};f.prototype.Add=function(m){this.x+=m.x;this.y+=m.y;this.z+=m.z};f.prototype.Subtract=function(m){this.x-=m.x;this.y-=m.y;this.z-=m.z};f.prototype.Multiply=function(m){if(m===undefined){m=0}this.x*=m;this.y*=m;this.z*=m}})();(function(){var ac=Box2D.Dynamics.Controllers.b2ControllerEdge,O=Box2D.Common.Math.b2Mat22,r=Box2D.Common.Math.b2Mat33,Z=Box2D.Common.Math.b2Math,aq=Box2D.Common.Math.b2Sweep,f=Box2D.Common.Math.b2Transform,ap=Box2D.Common.Math.b2Vec2,an=Box2D.Common.Math.b2Vec3,al=Box2D.Common.b2Color,aM=Box2D.Common.b2internal,y=Box2D.Common.b2Settings,aa=Box2D.Collision.b2AABB,ay=Box2D.Collision.b2Bound,aN=Box2D.Collision.b2BoundValues,C=Box2D.Collision.b2Collision,E=Box2D.Collision.b2ContactID,af=Box2D.Collision.b2ContactPoint,aC=Box2D.Collision.b2Distance,g=Box2D.Collision.b2DistanceInput,o=Box2D.Collision.b2DistanceOutput,R=Box2D.Collision.b2DistanceProxy,l=Box2D.Collision.b2DynamicTree,aK=Box2D.Collision.b2DynamicTreeBroadPhase,ax=Box2D.Collision.b2DynamicTreeNode,P=Box2D.Collision.b2DynamicTreePair,Q=Box2D.Collision.b2Manifold,K=Box2D.Collision.b2ManifoldPoint,T=Box2D.Collision.b2Point,X=Box2D.Collision.b2RayCastInput,m=Box2D.Collision.b2RayCastOutput,h=Box2D.Collision.b2Segment,aA=Box2D.Collision.b2SeparationFunction,aI=Box2D.Collision.b2Simplex,A=Box2D.Collision.b2SimplexCache,aR=Box2D.Collision.b2SimplexVertex,ao=Box2D.Collision.b2TimeOfImpact,aF=Box2D.Collision.b2TOIInput,aJ=Box2D.Collision.b2WorldManifold,aD=Box2D.Collision.ClipVertex,Y=Box2D.Collision.Features,aw=Box2D.Collision.IBroadPhase,aO=Box2D.Collision.Shapes.b2CircleShape,d=Box2D.Collision.Shapes.b2EdgeChainDef,aH=Box2D.Collision.Shapes.b2EdgeShape,ae=Box2D.Collision.Shapes.b2MassData,aG=Box2D.Collision.Shapes.b2PolygonShape,ar=Box2D.Collision.Shapes.b2Shape,G=Box2D.Dynamics.b2Body,n=Box2D.Dynamics.b2BodyDef,ai=Box2D.Dynamics.b2ContactFilter,ag=Box2D.Dynamics.b2ContactImpulse,x=Box2D.Dynamics.b2ContactListener,B=Box2D.Dynamics.b2ContactManager,M=Box2D.Dynamics.b2DebugDraw,D=Box2D.Dynamics.b2DestructionListener,az=Box2D.Dynamics.b2FilterData,aL=Box2D.Dynamics.b2Fixture,a=Box2D.Dynamics.b2FixtureDef,aP=Box2D.Dynamics.b2Island,u=Box2D.Dynamics.b2TimeStep,s=Box2D.Dynamics.b2World,e=Box2D.Dynamics.Contacts.b2CircleContact,t=Box2D.Dynamics.Contacts.b2Contact,L=Box2D.Dynamics.Contacts.b2ContactConstraint,S=Box2D.Dynamics.Contacts.b2ContactConstraintPoint,b=Box2D.Dynamics.Contacts.b2ContactEdge,av=Box2D.Dynamics.Contacts.b2ContactFactory,k=Box2D.Dynamics.Contacts.b2ContactRegister,v=Box2D.Dynamics.Contacts.b2ContactResult,V=Box2D.Dynamics.Contacts.b2ContactSolver,aV=Box2D.Dynamics.Contacts.b2EdgeAndCircleContact,q=Box2D.Dynamics.Contacts.b2NullContact,au=Box2D.Dynamics.Contacts.b2PolyAndCircleContact,z=Box2D.Dynamics.Contacts.b2PolyAndEdgeContact,U=Box2D.Dynamics.Contacts.b2PolygonContact,at=Box2D.Dynamics.Contacts.b2PositionSolverManifold,aj=Box2D.Dynamics.Controllers.b2Controller,H=Box2D.Dynamics.Joints.b2DistanceJoint,aE=Box2D.Dynamics.Joints.b2DistanceJointDef,p=Box2D.Dynamics.Joints.b2FrictionJoint,aU=Box2D.Dynamics.Joints.b2FrictionJointDef,w=Box2D.Dynamics.Joints.b2GearJoint,J=Box2D.Dynamics.Joints.b2GearJointDef,aT=Box2D.Dynamics.Joints.b2Jacobian,ad=Box2D.Dynamics.Joints.b2Joint,am=Box2D.Dynamics.Joints.b2JointDef,ak=Box2D.Dynamics.Joints.b2JointEdge,j=Box2D.Dynamics.Joints.b2LineJoint,aB=Box2D.Dynamics.Joints.b2LineJointDef,aS=Box2D.Dynamics.Joints.b2MouseJoint,I=Box2D.Dynamics.Joints.b2MouseJointDef,aQ=Box2D.Dynamics.Joints.b2PrismaticJoint,ab=Box2D.Dynamics.Joints.b2PrismaticJointDef,aW=Box2D.Dynamics.Joints.b2PulleyJoint,W=Box2D.Dynamics.Joints.b2PulleyJointDef,c=Box2D.Dynamics.Joints.b2RevoluteJoint,F=Box2D.Dynamics.Joints.b2RevoluteJointDef,ah=Box2D.Dynamics.Joints.b2WeldJoint,N=Box2D.Dynamics.Joints.b2WeldJointDef;G.b2Body=function(){this.m_xf=new f();this.m_sweep=new aq();this.m_linearVelocity=new ap();this.m_force=new ap()};G.prototype.connectEdges=function(a1,a0,a4){if(a4===undefined){a4=0}var a3=Math.atan2(a0.GetDirectionVector().y,a0.GetDirectionVector().x);var aY=Math.tan((a3-a4)*0.5);var aX=Z.MulFV(aY,a0.GetDirectionVector());aX=Z.SubtractVV(aX,a0.GetNormalVector());aX=Z.MulFV(y.b2_toiSlop,aX);aX=Z.AddVV(aX,a0.GetVertex1());var a2=Z.AddVV(a1.GetDirectionVector(),a0.GetDirectionVector());a2.Normalize();var aZ=Z.Dot(a1.GetDirectionVector(),a0.GetNormalVector())>0;a1.SetNextEdge(a0,aX,a2,aZ);a0.SetPrevEdge(a1,aX,a2,aZ);return a3};G.prototype.CreateFixture=function(aZ){if(this.m_world.IsLocked()==true){return null}var aY=new aL();aY.Create(this,this.m_xf,aZ);if(this.m_flags&G.e_activeFlag){var aX=this.m_world.m_contactManager.m_broadPhase;aY.CreateProxy(aX,this.m_xf)}aY.m_next=this.m_fixtureList;this.m_fixtureList=aY;++this.m_fixtureCount;aY.m_body=this;if(aY.m_density>0){this.ResetMassData()}this.m_world.m_flags|=s.e_newFixture;return aY};G.prototype.CreateFixture2=function(aY,aX){if(aX===undefined){aX=0}var aZ=new a();aZ.shape=aY;aZ.density=aX;return this.CreateFixture(aZ)};G.prototype.DestroyFixture=function(aY){if(this.m_world.IsLocked()==true){return}var aZ=this.m_fixtureList;var a0=null;var a5=false;while(aZ!=null){if(aZ==aY){if(a0){a0.m_next=aY.m_next}else{this.m_fixtureList=aY.m_next}a5=true;break}a0=aZ;aZ=aZ.m_next}var aX=this.m_contactList;while(aX){var a4=aX.contact;aX=aX.next;var a3=a4.GetFixtureA();var a2=a4.GetFixtureB();if(aY==a3||aY==a2){this.m_world.m_contactManager.Destroy(a4)}}if(this.m_flags&G.e_activeFlag){var a1=this.m_world.m_contactManager.m_broadPhase;aY.DestroyProxy(a1)}else{}aY.Destroy();aY.m_body=null;aY.m_next=null;--this.m_fixtureCount;this.ResetMassData()};G.prototype.SetPositionAndAngle=function(aY,a2){if(a2===undefined){a2=0}var a1;if(this.m_world.IsLocked()==true){return}this.m_xf.R.Set(a2);this.m_xf.position.SetV(aY);var a0=this.m_xf.R;var aZ=this.m_sweep.localCenter;this.m_sweep.c.x=(a0.col1.x*aZ.x+a0.col2.x*aZ.y);this.m_sweep.c.y=(a0.col1.y*aZ.x+a0.col2.y*aZ.y);this.m_sweep.c.x+=this.m_xf.position.x;this.m_sweep.c.y+=this.m_xf.position.y;this.m_sweep.c0.SetV(this.m_sweep.c);this.m_sweep.a0=this.m_sweep.a=a2;var aX=this.m_world.m_contactManager.m_broadPhase;for(a1=this.m_fixtureList;a1;a1=a1.m_next){a1.Synchronize(aX,this.m_xf,this.m_xf)}this.m_world.m_contactManager.FindNewContacts()};G.prototype.SetTransform=function(aX){this.SetPositionAndAngle(aX.position,aX.GetAngle())};G.prototype.GetTransform=function(){return this.m_xf};G.prototype.GetPosition=function(){return this.m_xf.position};G.prototype.SetPosition=function(aX){this.SetPositionAndAngle(aX,this.GetAngle())};G.prototype.GetAngle=function(){return this.m_sweep.a};G.prototype.SetAngle=function(aX){if(aX===undefined){aX=0}this.SetPositionAndAngle(this.GetPosition(),aX)};G.prototype.GetWorldCenter=function(){return this.m_sweep.c};G.prototype.GetLocalCenter=function(){return this.m_sweep.localCenter};G.prototype.SetLinearVelocity=function(aX){if(this.m_type==G.b2_staticBody){return}this.m_linearVelocity.SetV(aX)};G.prototype.GetLinearVelocity=function(){return this.m_linearVelocity};G.prototype.SetAngularVelocity=function(aX){if(aX===undefined){aX=0}if(this.m_type==G.b2_staticBody){return}this.m_angularVelocity=aX};G.prototype.GetAngularVelocity=function(){return this.m_angularVelocity};G.prototype.GetDefinition=function(){var aX=new n();aX.type=this.GetType();aX.allowSleep=(this.m_flags&G.e_allowSleepFlag)==G.e_allowSleepFlag;aX.angle=this.GetAngle();aX.angularDamping=this.m_angularDamping;aX.angularVelocity=this.m_angularVelocity;aX.fixedRotation=(this.m_flags&G.e_fixedRotationFlag)==G.e_fixedRotationFlag;aX.bullet=(this.m_flags&G.e_bulletFlag)==G.e_bulletFlag;aX.awake=(this.m_flags&G.e_awakeFlag)==G.e_awakeFlag;aX.linearDamping=this.m_linearDamping;aX.linearVelocity.SetV(this.GetLinearVelocity());aX.position=this.GetPosition();aX.userData=this.GetUserData();return aX};G.prototype.ApplyForce=function(aY,aX){if(this.m_type!=G.b2_dynamicBody){return}if(this.IsAwake()==false){this.SetAwake(true)}this.m_force.x+=aY.x;this.m_force.y+=aY.y;this.m_torque+=((aX.x-this.m_sweep.c.x)*aY.y-(aX.y-this.m_sweep.c.y)*aY.x)};G.prototype.ApplyTorque=function(aX){if(aX===undefined){aX=0}if(this.m_type!=G.b2_dynamicBody){return}if(this.IsAwake()==false){this.SetAwake(true)}this.m_torque+=aX};G.prototype.ApplyImpulse=function(aY,aX){if(this.m_type!=G.b2_dynamicBody){return}if(this.IsAwake()==false){this.SetAwake(true)}this.m_linearVelocity.x+=this.m_invMass*aY.x;this.m_linearVelocity.y+=this.m_invMass*aY.y};G.prototype.Split=function(a8){var a7=this.GetLinearVelocity().Copy();var a1=this.GetAngularVelocity();var aZ=this.GetWorldCenter();var aY=this;var a9=this.m_world.CreateBody(this.GetDefinition());var a2;for(var a6=aY.m_fixtureList;a6;){if(a8(a6)){var a5=a6.m_next;if(a2){a2.m_next=a5}else{aY.m_fixtureList=a5}aY.m_fixtureCount--;a6.m_next=a9.m_fixtureList;a9.m_fixtureList=a6;a9.m_fixtureCount++;a6.m_body=a9;a6=a5}else{a2=a6;a6=a6.m_next}}aY.ResetMassData();a9.ResetMassData();var a0=aY.GetWorldCenter();var aX=a9.GetWorldCenter();var a4=Z.AddVV(a7,Z.CrossFV(a1,Z.SubtractVV(a0,aZ)));var a3=Z.AddVV(a7,Z.CrossFV(a1,Z.SubtractVV(aX,aZ)));aY.SetLinearVelocity(a4);a9.SetLinearVelocity(a3);aY.SetAngularVelocity(a1);a9.SetAngularVelocity(a1);aY.SynchronizeFixtures();a9.SynchronizeFixtures();return a9};G.prototype.Merge=function(a4){var a3;for(a3=a4.m_fixtureList;a3;){var a2=a3.m_next;a4.m_fixtureCount--;a3.m_next=this.m_fixtureList;this.m_fixtureList=a3;this.m_fixtureCount++;a3.m_body=a7;a3=a2}aX.m_fixtureCount=0;var aX=this;var a7=a4;var aZ=aX.GetWorldCenter();var aY=a7.GetWorldCenter();var a1=aX.GetLinearVelocity().Copy();var a0=a7.GetLinearVelocity().Copy();var a6=aX.GetAngularVelocity();var a5=a7.GetAngularVelocity();aX.ResetMassData();this.SynchronizeFixtures()};G.prototype.GetMass=function(){return this.m_mass};G.prototype.GetInertia=function(){return this.m_I};G.prototype.GetMassData=function(aX){aX.mass=this.m_mass;aX.I=this.m_I;aX.center.SetV(this.m_sweep.localCenter)};G.prototype.SetMassData=function(aX){y.b2Assert(this.m_world.IsLocked()==false);if(this.m_world.IsLocked()==true){return}if(this.m_type!=G.b2_dynamicBody){return}this.m_invMass=0;this.m_I=0;this.m_invI=0;this.m_mass=aX.mass;if(this.m_mass<=0){this.m_mass=1}this.m_invMass=1/this.m_mass;if(aX.I>0&&(this.m_flags&G.e_fixedRotationFlag)==0){this.m_I=aX.I-this.m_mass*(aX.center.x*aX.center.x+aX.center.y*aX.center.y);this.m_invI=1/this.m_I}var aY=this.m_sweep.c.Copy();this.m_sweep.localCenter.SetV(aX.center);this.m_sweep.c0.SetV(Z.MulX(this.m_xf,this.m_sweep.localCenter));this.m_sweep.c.SetV(this.m_sweep.c0);this.m_linearVelocity.x+=this.m_angularVelocity*(-(this.m_sweep.c.y-aY.y));this.m_linearVelocity.y+=this.m_angularVelocity*(+(this.m_sweep.c.x-aY.x))};G.prototype.ResetMassData=function(){this.m_mass=0;this.m_invMass=0;this.m_I=0;this.m_invI=0;this.m_sweep.localCenter.SetZero();if(this.m_type==G.b2_staticBody||this.m_type==G.b2_kinematicBody){return}var aX=ap.Make(0,0);for(var aZ=this.m_fixtureList;aZ;aZ=aZ.m_next){if(aZ.m_density==0){continue}var aY=aZ.GetMassData();this.m_mass+=aY.mass;aX.x+=aY.center.x*aY.mass;aX.y+=aY.center.y*aY.mass;this.m_I+=aY.I}if(this.m_mass>0){this.m_invMass=1/this.m_mass;aX.x*=this.m_invMass;aX.y*=this.m_invMass}else{this.m_mass=1;this.m_invMass=1}if(this.m_I>0&&(this.m_flags&G.e_fixedRotationFlag)==0){this.m_I-=this.m_mass*(aX.x*aX.x+aX.y*aX.y);this.m_I*=this.m_inertiaScale;y.b2Assert(this.m_I>0);this.m_invI=1/this.m_I}else{this.m_I=0;this.m_invI=0}var a0=this.m_sweep.c.Copy();this.m_sweep.localCenter.SetV(aX);this.m_sweep.c0.SetV(Z.MulX(this.m_xf,this.m_sweep.localCenter));this.m_sweep.c.SetV(this.m_sweep.c0);this.m_linearVelocity.x+=this.m_angularVelocity*(-(this.m_sweep.c.y-a0.y));this.m_linearVelocity.y+=this.m_angularVelocity*(+(this.m_sweep.c.x-a0.x))};G.prototype.GetWorldPoint=function(aZ){var aX=this.m_xf.R;var aY=new ap(aX.col1.x*aZ.x+aX.col2.x*aZ.y,aX.col1.y*aZ.x+aX.col2.y*aZ.y);aY.x+=this.m_xf.position.x;aY.y+=this.m_xf.position.y;return aY};G.prototype.GetWorldVector=function(aX){return Z.MulMV(this.m_xf.R,aX)};G.prototype.GetLocalPoint=function(aX){return Z.MulXT(this.m_xf,aX)};G.prototype.GetLocalVector=function(aX){return Z.MulTMV(this.m_xf.R,aX)};G.prototype.GetLinearVelocityFromWorldPoint=function(aX){return new ap(this.m_linearVelocity.x-this.m_angularVelocity*(aX.y-this.m_sweep.c.y),this.m_linearVelocity.y+this.m_angularVelocity*(aX.x-this.m_sweep.c.x))};G.prototype.GetLinearVelocityFromLocalPoint=function(aZ){var aX=this.m_xf.R;var aY=new ap(aX.col1.x*aZ.x+aX.col2.x*aZ.y,aX.col1.y*aZ.x+aX.col2.y*aZ.y);aY.x+=this.m_xf.position.x;aY.y+=this.m_xf.position.y;return new ap(this.m_linearVelocity.x-this.m_angularVelocity*(aY.y-this.m_sweep.c.y),this.m_linearVelocity.y+this.m_angularVelocity*(aY.x-this.m_sweep.c.x))};G.prototype.GetLinearDamping=function(){return this.m_linearDamping};G.prototype.SetLinearDamping=function(aX){if(aX===undefined){aX=0}this.m_linearDamping=aX};G.prototype.GetAngularDamping=function(){return this.m_angularDamping};G.prototype.SetAngularDamping=function(aX){if(aX===undefined){aX=0}this.m_angularDamping=aX};G.prototype.SetType=function(aX){if(aX===undefined){aX=0}if(this.m_type==aX){return}this.m_type=aX;this.ResetMassData();if(this.m_type==G.b2_staticBody){this.m_linearVelocity.SetZero();this.m_angularVelocity=0}this.SetAwake(true);this.m_force.SetZero();this.m_torque=0;for(var aY=this.m_contactList;aY;aY=aY.next){aY.contact.FlagForFiltering()}};G.prototype.GetType=function(){return this.m_type};G.prototype.SetBullet=function(aX){if(aX){this.m_flags|=G.e_bulletFlag}else{this.m_flags&=~G.e_bulletFlag}};G.prototype.IsBullet=function(){return(this.m_flags&G.e_bulletFlag)==G.e_bulletFlag};G.prototype.SetSleepingAllowed=function(aX){if(aX){this.m_flags|=G.e_allowSleepFlag}else{this.m_flags&=~G.e_allowSleepFlag;this.SetAwake(true)}};G.prototype.SetAwake=function(aX){if(aX){this.m_flags|=G.e_awakeFlag;this.m_sleepTime=0}else{this.m_flags&=~G.e_awakeFlag;this.m_sleepTime=0;this.m_linearVelocity.SetZero();this.m_angularVelocity=0;this.m_force.SetZero();this.m_torque=0}};G.prototype.IsAwake=function(){return(this.m_flags&G.e_awakeFlag)==G.e_awakeFlag};G.prototype.SetFixedRotation=function(aX){if(aX){this.m_flags|=G.e_fixedRotationFlag}else{this.m_flags&=~G.e_fixedRotationFlag}this.ResetMassData()};G.prototype.IsFixedRotation=function(){return(this.m_flags&G.e_fixedRotationFlag)==G.e_fixedRotationFlag};G.prototype.SetActive=function(aY){if(aY==this.IsActive()){return}var aX;var aZ;if(aY){this.m_flags|=G.e_activeFlag;aX=this.m_world.m_contactManager.m_broadPhase;for(aZ=this.m_fixtureList;aZ;aZ=aZ.m_next){aZ.CreateProxy(aX,this.m_xf)}}else{this.m_flags&=~G.e_activeFlag;aX=this.m_world.m_contactManager.m_broadPhase;for(aZ=this.m_fixtureList;aZ;aZ=aZ.m_next){aZ.DestroyProxy(aX)}var a0=this.m_contactList;while(a0){var a1=a0;a0=a0.next;this.m_world.m_contactManager.Destroy(a1.contact)}this.m_contactList=null}};G.prototype.IsActive=function(){return(this.m_flags&G.e_activeFlag)==G.e_activeFlag};G.prototype.IsSleepingAllowed=function(){return(this.m_flags&G.e_allowSleepFlag)==G.e_allowSleepFlag};G.prototype.GetFixtureList=function(){return this.m_fixtureList};G.prototype.GetJointList=function(){return this.m_jointList};G.prototype.GetControllerList=function(){return this.m_controllerList};G.prototype.GetContactList=function(){return this.m_contactList};G.prototype.GetNext=function(){return this.m_next};G.prototype.GetUserData=function(){return this.m_userData};G.prototype.SetUserData=function(aX){this.m_userData=aX};G.prototype.GetWorld=function(){return this.m_world};G.prototype.b2Body=function(a0,aZ){this.m_flags=0;if(a0.bullet){this.m_flags|=G.e_bulletFlag}if(a0.fixedRotation){this.m_flags|=G.e_fixedRotationFlag}if(a0.allowSleep){this.m_flags|=G.e_allowSleepFlag}if(a0.awake){this.m_flags|=G.e_awakeFlag}if(a0.active){this.m_flags|=G.e_activeFlag}this.m_world=aZ;this.m_xf.position.SetV(a0.position);this.m_xf.R.Set(a0.angle);this.m_sweep.localCenter.SetZero();this.m_sweep.t0=1;this.m_sweep.a0=this.m_sweep.a=a0.angle;var aY=this.m_xf.R;var aX=this.m_sweep.localCenter;this.m_sweep.c.x=(aY.col1.x*aX.x+aY.col2.x*aX.y);this.m_sweep.c.y=(aY.col1.y*aX.x+aY.col2.y*aX.y);this.m_sweep.c.x+=this.m_xf.position.x;this.m_sweep.c.y+=this.m_xf.position.y;this.m_sweep.c0.SetV(this.m_sweep.c);this.m_jointList=null;this.m_controllerList=null;this.m_contactList=null;this.m_controllerCount=0;this.m_prev=null;this.m_next=null;this.m_linearVelocity.SetV(a0.linearVelocity);this.m_angularVelocity=a0.angularVelocity;this.m_linearDamping=a0.linearDamping;this.m_angularDamping=a0.angularDamping;this.m_force.Set(0,0);this.m_torque=0;this.m_sleepTime=0;this.m_type=a0.type;if(this.m_type==G.b2_dynamicBody){this.m_mass=1;this.m_invMass=1}else{this.m_mass=0;this.m_invMass=0}this.m_I=0;this.m_invI=0;this.m_inertiaScale=a0.inertiaScale;this.m_userData=a0.userData;this.m_fixtureList=null;this.m_fixtureCount=0};G.prototype.SynchronizeFixtures=function(){var a0=G.s_xf1;a0.R.Set(this.m_sweep.a0);var aZ=a0.R;var aY=this.m_sweep.localCenter;a0.position.x=this.m_sweep.c0.x-(aZ.col1.x*aY.x+aZ.col2.x*aY.y);a0.position.y=this.m_sweep.c0.y-(aZ.col1.y*aY.x+aZ.col2.y*aY.y);var a1;var aX=this.m_world.m_contactManager.m_broadPhase;for(a1=this.m_fixtureList;a1;a1=a1.m_next){a1.Synchronize(aX,a0,this.m_xf)}};G.prototype.SynchronizeTransform=function(){this.m_xf.R.Set(this.m_sweep.a);var aY=this.m_xf.R;var aX=this.m_sweep.localCenter;this.m_xf.position.x=this.m_sweep.c.x-(aY.col1.x*aX.x+aY.col2.x*aX.y);this.m_xf.position.y=this.m_sweep.c.y-(aY.col1.y*aX.x+aY.col2.y*aX.y)};G.prototype.ShouldCollide=function(aX){if(this.m_type!=G.b2_dynamicBody&&aX.m_type!=G.b2_dynamicBody){return false}for(var aY=this.m_jointList;aY;aY=aY.next){if(aY.other==aX){if(aY.joint.m_collideConnected==false){return false}}}return true};G.prototype.Advance=function(aX){if(aX===undefined){aX=0}this.m_sweep.Advance(aX);this.m_sweep.c.SetV(this.m_sweep.c0);this.m_sweep.a=this.m_sweep.a0;this.SynchronizeTransform()};Box2D.postDefs.push(function(){Box2D.Dynamics.b2Body.s_xf1=new f();Box2D.Dynamics.b2Body.e_islandFlag=1;Box2D.Dynamics.b2Body.e_awakeFlag=2;Box2D.Dynamics.b2Body.e_allowSleepFlag=4;Box2D.Dynamics.b2Body.e_bulletFlag=8;Box2D.Dynamics.b2Body.e_fixedRotationFlag=16;Box2D.Dynamics.b2Body.e_activeFlag=32;Box2D.Dynamics.b2Body.b2_staticBody=0;Box2D.Dynamics.b2Body.b2_kinematicBody=1;Box2D.Dynamics.b2Body.b2_dynamicBody=2});n.b2BodyDef=function(){this.position=new ap();this.linearVelocity=new ap()};n.prototype.b2BodyDef=function(){this.userData=null;this.position.Set(0,0);this.angle=0;this.linearVelocity.Set(0,0);this.angularVelocity=0;this.linearDamping=0;this.angularDamping=0;this.allowSleep=true;this.awake=true;this.fixedRotation=false;this.bullet=false;this.type=G.b2_staticBody;this.active=true;this.inertiaScale=1};ai.b2ContactFilter=function(){};ai.prototype.ShouldCollide=function(aX,a1){var aZ=aX.GetFilterData();var aY=a1.GetFilterData();if(aZ.groupIndex==aY.groupIndex&&aZ.groupIndex!=0){return aZ.groupIndex>0}var a0=(aZ.maskBits&aY.categoryBits)!=0&&(aZ.categoryBits&aY.maskBits)!=0;return a0};ai.prototype.RayCollide=function(aX,aY){if(!aX){return true}return this.ShouldCollide((aX instanceof aL?aX:null),aY)};Box2D.postDefs.push(function(){Box2D.Dynamics.b2ContactFilter.b2_defaultFilter=new ai()});ag.b2ContactImpulse=function(){this.normalImpulses=new Vector_a2j_Number(y.b2_maxManifoldPoints);this.tangentImpulses=new Vector_a2j_Number(y.b2_maxManifoldPoints)};x.b2ContactListener=function(){};x.prototype.BeginContact=function(aX){};x.prototype.EndContact=function(aX){};x.prototype.PreSolve=function(aX,aY){};x.prototype.PostSolve=function(aX,aY){};Box2D.postDefs.push(function(){Box2D.Dynamics.b2ContactListener.b2_defaultListener=new x()});B.b2ContactManager=function(){};B.prototype.b2ContactManager=function(){this.m_world=null;this.m_contactCount=0;this.m_contactFilter=ai.b2_defaultFilter;this.m_contactListener=x.b2_defaultListener;this.m_contactFactory=new av(this.m_allocator);this.m_broadPhase=new aK()};B.prototype.AddPair=function(aZ,aX){var a3=(aZ instanceof aL?aZ:null);var a2=(aX instanceof aL?aX:null);var a1=a3.GetBody();var a0=a2.GetBody();if(a1==a0){return}var aY=a0.GetContactList();while(aY){if(aY.other==a1){var a6=aY.contact.GetFixtureA();var a4=aY.contact.GetFixtureB();if(a6==a3&&a4==a2){return}if(a6==a2&&a4==a3){return}}aY=aY.next}if(a0.ShouldCollide(a1)==false){return}if(this.m_contactFilter.ShouldCollide(a3,a2)==false){return}var a5=this.m_contactFactory.Create(a3,a2);a3=a5.GetFixtureA();a2=a5.GetFixtureB();a1=a3.m_body;a0=a2.m_body;a5.m_prev=null;a5.m_next=this.m_world.m_contactList;if(this.m_world.m_contactList!=null){this.m_world.m_contactList.m_prev=a5}this.m_world.m_contactList=a5;a5.m_nodeA.contact=a5;a5.m_nodeA.other=a0;a5.m_nodeA.prev=null;a5.m_nodeA.next=a1.m_contactList;if(a1.m_contactList!=null){a1.m_contactList.prev=a5.m_nodeA}a1.m_contactList=a5.m_nodeA;a5.m_nodeB.contact=a5;a5.m_nodeB.other=a1;a5.m_nodeB.prev=null;a5.m_nodeB.next=a0.m_contactList;if(a0.m_contactList!=null){a0.m_contactList.prev=a5.m_nodeB}a0.m_contactList=a5.m_nodeB;++this.m_world.m_contactCount;return};B.prototype.FindNewContacts=function(){this.m_broadPhase.UpdatePairs(Box2D.generateCallback(this,this.AddPair))};B.prototype.Destroy=function(a1){var aX=a1.GetFixtureA();var a0=a1.GetFixtureB();var aZ=aX.GetBody();var aY=a0.GetBody();if(a1.IsTouching()){this.m_contactListener.EndContact(a1)}if(a1.m_prev){a1.m_prev.m_next=a1.m_next}if(a1.m_next){a1.m_next.m_prev=a1.m_prev}if(a1==this.m_world.m_contactList){this.m_world.m_contactList=a1.m_next}if(a1.m_nodeA.prev){a1.m_nodeA.prev.next=a1.m_nodeA.next}if(a1.m_nodeA.next){a1.m_nodeA.next.prev=a1.m_nodeA.prev}if(a1.m_nodeA==aZ.m_contactList){aZ.m_contactList=a1.m_nodeA.next}if(a1.m_nodeB.prev){a1.m_nodeB.prev.next=a1.m_nodeB.next}if(a1.m_nodeB.next){a1.m_nodeB.next.prev=a1.m_nodeB.prev}if(a1.m_nodeB==aY.m_contactList){aY.m_contactList=a1.m_nodeB.next}this.m_contactFactory.Destroy(a1);--this.m_contactCount};B.prototype.Collide=function(){var a3=this.m_world.m_contactList;while(a3){var a1=a3.GetFixtureA();var aZ=a3.GetFixtureB();var aY=a1.GetBody();var aX=aZ.GetBody();if(aY.IsAwake()==false&&aX.IsAwake()==false){a3=a3.GetNext();continue}if(a3.m_flags&t.e_filterFlag){if(aX.ShouldCollide(aY)==false){var a5=a3;a3=a5.GetNext();this.Destroy(a5);continue}if(this.m_contactFilter.ShouldCollide(a1,aZ)==false){a5=a3;a3=a5.GetNext();this.Destroy(a5);continue}a3.m_flags&=~t.e_filterFlag}var a2=a1.m_proxy;var a0=aZ.m_proxy;var a4=this.m_broadPhase.TestOverlap(a2,a0);if(a4==false){a5=a3;a3=a5.GetNext();this.Destroy(a5);continue}a3.Update(this.m_contactListener);a3=a3.GetNext()}};Box2D.postDefs.push(function(){Box2D.Dynamics.b2ContactManager.s_evalCP=new af()});M.b2DebugDraw=function(){};M.prototype.b2DebugDraw=function(){};M.prototype.SetFlags=function(aX){if(aX===undefined){aX=0}};M.prototype.GetFlags=function(){};M.prototype.AppendFlags=function(aX){if(aX===undefined){aX=0}};M.prototype.ClearFlags=function(aX){if(aX===undefined){aX=0}};M.prototype.SetSprite=function(aX){};M.prototype.GetSprite=function(){};M.prototype.SetDrawScale=function(aX){if(aX===undefined){aX=0}};M.prototype.GetDrawScale=function(){};M.prototype.SetLineThickness=function(aX){if(aX===undefined){aX=0}};M.prototype.GetLineThickness=function(){};M.prototype.SetAlpha=function(aX){if(aX===undefined){aX=0}};M.prototype.GetAlpha=function(){};M.prototype.SetFillAlpha=function(aX){if(aX===undefined){aX=0}};M.prototype.GetFillAlpha=function(){};M.prototype.SetXFormScale=function(aX){if(aX===undefined){aX=0}};M.prototype.GetXFormScale=function(){};M.prototype.DrawPolygon=function(aY,aZ,aX){if(aZ===undefined){aZ=0}};M.prototype.DrawSolidPolygon=function(aY,aZ,aX){if(aZ===undefined){aZ=0}};M.prototype.DrawCircle=function(aY,aX,aZ){if(aX===undefined){aX=0}};M.prototype.DrawSolidCircle=function(aY,aX,a0,aZ){if(aX===undefined){aX=0}};M.prototype.DrawSegment=function(aZ,aY,aX){};M.prototype.DrawTransform=function(aX){};Box2D.postDefs.push(function(){Box2D.Dynamics.b2DebugDraw.e_shapeBit=1;Box2D.Dynamics.b2DebugDraw.e_jointBit=2;Box2D.Dynamics.b2DebugDraw.e_aabbBit=4;Box2D.Dynamics.b2DebugDraw.e_pairBit=8;Box2D.Dynamics.b2DebugDraw.e_centerOfMassBit=16;Box2D.Dynamics.b2DebugDraw.e_controllerBit=32});D.b2DestructionListener=function(){};D.prototype.SayGoodbyeJoint=function(aX){};D.prototype.SayGoodbyeFixture=function(aX){};az.b2FilterData=function(){this.categoryBits=1;this.maskBits=65535;this.groupIndex=0};az.prototype.Copy=function(){var aX=new az();aX.categoryBits=this.categoryBits;aX.maskBits=this.maskBits;aX.groupIndex=this.groupIndex;return aX};aL.b2Fixture=function(){this.m_filter=new az()};aL.prototype.GetType=function(){return this.m_shape.GetType()};aL.prototype.GetShape=function(){return this.m_shape};aL.prototype.SetSensor=function(a0){if(this.m_isSensor==a0){return}this.m_isSensor=a0;if(this.m_body==null){return}var aZ=this.m_body.GetContactList();while(aZ){var aY=aZ.contact;var aX=aY.GetFixtureA();var a1=aY.GetFixtureB();if(aX==this||a1==this){aY.SetSensor(aX.IsSensor()||a1.IsSensor())}aZ=aZ.next}};aL.prototype.IsSensor=function(){return this.m_isSensor};aL.prototype.SetFilterData=function(aZ){this.m_filter=aZ.Copy();if(this.m_body){return}var a0=this.m_body.GetContactList();while(a0){var aY=a0.contact;var aX=aY.GetFixtureA();var a1=aY.GetFixtureB();if(aX==this||a1==this){aY.FlagForFiltering()}a0=a0.next}};aL.prototype.GetFilterData=function(){return this.m_filter.Copy()};aL.prototype.GetBody=function(){return this.m_body};aL.prototype.GetNext=function(){return this.m_next};aL.prototype.GetUserData=function(){return this.m_userData};aL.prototype.SetUserData=function(aX){this.m_userData=aX};aL.prototype.TestPoint=function(aX){return this.m_shape.TestPoint(this.m_body.GetTransform(),aX)};aL.prototype.RayCast=function(aY,aX){return this.m_shape.RayCast(aY,aX,this.m_body.GetTransform())};aL.prototype.GetMassData=function(aX){if(aX===undefined){aX=null}if(aX==null){aX=new ae()}this.m_shape.ComputeMass(aX,this.m_density);return aX};aL.prototype.SetDensity=function(aX){if(aX===undefined){aX=0}this.m_density=aX};aL.prototype.GetDensity=function(){return this.m_density};aL.prototype.GetFriction=function(){return this.m_friction};aL.prototype.SetFriction=function(aX){if(aX===undefined){aX=0}this.m_friction=aX};aL.prototype.GetRestitution=function(){return this.m_restitution};aL.prototype.SetRestitution=function(aX){if(aX===undefined){aX=0}this.m_restitution=aX};aL.prototype.GetAABB=function(){return this.m_aabb};aL.prototype.b2Fixture=function(){this.m_aabb=new aa();this.m_userData=null;this.m_body=null;this.m_next=null;this.m_shape=null;this.m_density=0;this.m_friction=0;this.m_restitution=0};aL.prototype.Create=function(aX,aY,aZ){this.m_userData=aZ.userData;this.m_friction=aZ.friction;this.m_restitution=aZ.restitution;this.m_body=aX;this.m_next=null;this.m_filter=aZ.filter.Copy();this.m_isSensor=aZ.isSensor;this.m_shape=aZ.shape.Copy();this.m_density=aZ.density};aL.prototype.Destroy=function(){this.m_shape=null};aL.prototype.CreateProxy=function(aX,aY){this.m_shape.ComputeAABB(this.m_aabb,aY);this.m_proxy=aX.CreateProxy(this.m_aabb,this)};aL.prototype.DestroyProxy=function(aX){if(this.m_proxy==null){return}aX.DestroyProxy(this.m_proxy);this.m_proxy=null};aL.prototype.Synchronize=function(aY,a2,a1){if(!this.m_proxy){return}var aZ=new aa();var aX=new aa();this.m_shape.ComputeAABB(aZ,a2);this.m_shape.ComputeAABB(aX,a1);this.m_aabb.Combine(aZ,aX);var a0=Z.SubtractVV(a1.position,a2.position);aY.MoveProxy(this.m_proxy,this.m_aabb,a0)};a.b2FixtureDef=function(){this.filter=new az()};a.prototype.b2FixtureDef=function(){this.shape=null;this.userData=null;this.friction=0.2;this.restitution=0;this.density=0;this.filter.categoryBits=1;this.filter.maskBits=65535;this.filter.groupIndex=0;this.isSensor=false};aP.b2Island=function(){};aP.prototype.b2Island=function(){this.m_bodies=new Vector();this.m_contacts=new Vector();this.m_joints=new Vector()};aP.prototype.Initialize=function(a3,a1,a0,aY,a2,aX){if(a3===undefined){a3=0}if(a1===undefined){a1=0}if(a0===undefined){a0=0}var aZ=0;this.m_bodyCapacity=a3;this.m_contactCapacity=a1;this.m_jointCapacity=a0;this.m_bodyCount=0;this.m_contactCount=0;this.m_jointCount=0;this.m_allocator=aY;this.m_listener=a2;this.m_contactSolver=aX;for(aZ=this.m_bodies.length;aZ<a3;aZ++){this.m_bodies[aZ]=null}for(aZ=this.m_contacts.length;aZ<a1;aZ++){this.m_contacts[aZ]=null}for(aZ=this.m_joints.length;aZ<a0;aZ++){this.m_joints[aZ]=null}};aP.prototype.Clear=function(){this.m_bodyCount=0;this.m_contactCount=0;this.m_jointCount=0};aP.prototype.Solve=function(aZ,bd,a7){var a4=0;var a3=0;var ba;var a2;for(a4=0;a4<this.m_bodyCount;++a4){ba=this.m_bodies[a4];if(ba.GetType()!=G.b2_dynamicBody){continue}ba.m_linearVelocity.x+=aZ.dt*(bd.x+ba.m_invMass*ba.m_force.x);ba.m_linearVelocity.y+=aZ.dt*(bd.y+ba.m_invMass*ba.m_force.y);ba.m_angularVelocity+=aZ.dt*ba.m_invI*ba.m_torque;ba.m_linearVelocity.Multiply(Z.Clamp(1-aZ.dt*ba.m_linearDamping,0,1));ba.m_angularVelocity*=Z.Clamp(1-aZ.dt*ba.m_angularDamping,0,1)}this.m_contactSolver.Initialize(aZ,this.m_contacts,this.m_contactCount,this.m_allocator);var a0=this.m_contactSolver;a0.InitVelocityConstraints(aZ);for(a4=0;a4<this.m_jointCount;++a4){a2=this.m_joints[a4];a2.InitVelocityConstraints(aZ)}for(a4=0;a4<aZ.velocityIterations;++a4){for(a3=0;a3<this.m_jointCount;++a3){a2=this.m_joints[a3];a2.SolveVelocityConstraints(aZ)}a0.SolveVelocityConstraints()}for(a4=0;a4<this.m_jointCount;++a4){a2=this.m_joints[a4];a2.FinalizeVelocityConstraints()}a0.FinalizeVelocityConstraints();for(a4=0;a4<this.m_bodyCount;++a4){ba=this.m_bodies[a4];if(ba.GetType()==G.b2_staticBody){continue}var a8=aZ.dt*ba.m_linearVelocity.x;var a6=aZ.dt*ba.m_linearVelocity.y;if((a8*a8+a6*a6)>y.b2_maxTranslationSquared){ba.m_linearVelocity.Normalize();ba.m_linearVelocity.x*=y.b2_maxTranslation*aZ.inv_dt;ba.m_linearVelocity.y*=y.b2_maxTranslation*aZ.inv_dt}var bc=aZ.dt*ba.m_angularVelocity;if(bc*bc>y.b2_maxRotationSquared){if(ba.m_angularVelocity<0){ba.m_angularVelocity=(-y.b2_maxRotation*aZ.inv_dt)}else{ba.m_angularVelocity=y.b2_maxRotation*aZ.inv_dt}}ba.m_sweep.c0.SetV(ba.m_sweep.c);ba.m_sweep.a0=ba.m_sweep.a;ba.m_sweep.c.x+=aZ.dt*ba.m_linearVelocity.x;ba.m_sweep.c.y+=aZ.dt*ba.m_linearVelocity.y;ba.m_sweep.a+=aZ.dt*ba.m_angularVelocity;ba.SynchronizeTransform()}for(a4=0;a4<aZ.positionIterations;++a4){var a5=a0.SolvePositionConstraints(y.b2_contactBaumgarte);var a9=true;for(a3=0;a3<this.m_jointCount;++a3){a2=this.m_joints[a3];var aY=a2.SolvePositionConstraints(y.b2_contactBaumgarte);a9=a9&&aY}if(a5&&a9){break}}this.Report(a0.m_constraints);if(a7){var a1=Number.MAX_VALUE;var aX=y.b2_linearSleepTolerance*y.b2_linearSleepTolerance;var bb=y.b2_angularSleepTolerance*y.b2_angularSleepTolerance;for(a4=0;a4<this.m_bodyCount;++a4){ba=this.m_bodies[a4];if(ba.GetType()==G.b2_staticBody){continue}if((ba.m_flags&G.e_allowSleepFlag)==0){ba.m_sleepTime=0;a1=0}if((ba.m_flags&G.e_allowSleepFlag)==0||ba.m_angularVelocity*ba.m_angularVelocity>bb||Z.Dot(ba.m_linearVelocity,ba.m_linearVelocity)>aX){ba.m_sleepTime=0;a1=0}else{ba.m_sleepTime+=aZ.dt;a1=Z.Min(a1,ba.m_sleepTime)}}if(a1>=y.b2_timeToSleep){for(a4=0;a4<this.m_bodyCount;++a4){ba=this.m_bodies[a4];ba.SetAwake(false)}}}};aP.prototype.SolveTOI=function(a0){var a1=0;var aZ=0;this.m_contactSolver.Initialize(a0,this.m_contacts,this.m_contactCount,this.m_allocator);var aY=this.m_contactSolver;for(a1=0;a1<this.m_jointCount;++a1){this.m_joints[a1].InitVelocityConstraints(a0)}for(a1=0;a1<a0.velocityIterations;++a1){aY.SolveVelocityConstraints();for(aZ=0;aZ<this.m_jointCount;++aZ){this.m_joints[aZ].SolveVelocityConstraints(a0)}}for(a1=0;a1<this.m_bodyCount;++a1){var a6=this.m_bodies[a1];if(a6.GetType()==G.b2_staticBody){continue}var a4=a0.dt*a6.m_linearVelocity.x;var a3=a0.dt*a6.m_linearVelocity.y;if((a4*a4+a3*a3)>y.b2_maxTranslationSquared){a6.m_linearVelocity.Normalize();a6.m_linearVelocity.x*=y.b2_maxTranslation*a0.inv_dt;a6.m_linearVelocity.y*=y.b2_maxTranslation*a0.inv_dt}var a8=a0.dt*a6.m_angularVelocity;if(a8*a8>y.b2_maxRotationSquared){if(a6.m_angularVelocity<0){a6.m_angularVelocity=(-y.b2_maxRotation*a0.inv_dt)}else{a6.m_angularVelocity=y.b2_maxRotation*a0.inv_dt}}a6.m_sweep.c0.SetV(a6.m_sweep.c);a6.m_sweep.a0=a6.m_sweep.a;a6.m_sweep.c.x+=a0.dt*a6.m_linearVelocity.x;a6.m_sweep.c.y+=a0.dt*a6.m_linearVelocity.y;a6.m_sweep.a+=a0.dt*a6.m_angularVelocity;a6.SynchronizeTransform()}var a7=0.75;for(a1=0;a1<a0.positionIterations;++a1){var a2=aY.SolvePositionConstraints(a7);var a5=true;for(aZ=0;aZ<this.m_jointCount;++aZ){var aX=this.m_joints[aZ].SolvePositionConstraints(y.b2_contactBaumgarte);a5=a5&&aX}if(a2&&a5){break}}this.Report(aY.m_constraints)};aP.prototype.Report=function(a1){if(this.m_listener==null){return}for(var aY=0;aY<this.m_contactCount;++aY){var a0=this.m_contacts[aY];var aZ=a1[aY];for(var aX=0;aX<aZ.pointCount;++aX){aP.s_impulse.normalImpulses[aX]=aZ.points[aX].normalImpulse;aP.s_impulse.tangentImpulses[aX]=aZ.points[aX].tangentImpulse}this.m_listener.PostSolve(a0,aP.s_impulse)}};aP.prototype.AddBody=function(aX){aX.m_islandIndex=this.m_bodyCount;this.m_bodies[this.m_bodyCount++]=aX};aP.prototype.AddContact=function(aX){this.m_contacts[this.m_contactCount++]=aX};aP.prototype.AddJoint=function(aX){this.m_joints[this.m_jointCount++]=aX};Box2D.postDefs.push(function(){Box2D.Dynamics.b2Island.s_impulse=new ag()});u.b2TimeStep=function(){};u.prototype.Set=function(aX){this.dt=aX.dt;this.inv_dt=aX.inv_dt;this.positionIterations=aX.positionIterations;this.velocityIterations=aX.velocityIterations;this.warmStarting=aX.warmStarting};s.b2World=function(){this.s_stack=new Vector();this.m_contactManager=new B();this.m_contactSolver=new V();this.m_island=new aP()};s.prototype.b2World=function(aZ,aY){this.m_destructionListener=null;this.m_debugDraw=null;this.m_bodyList=null;this.m_contactList=null;this.m_jointList=null;this.m_controllerList=null;this.m_bodyCount=0;this.m_contactCount=0;this.m_jointCount=0;this.m_controllerCount=0;s.m_warmStarting=true;s.m_continuousPhysics=true;this.m_allowSleep=aY;this.m_gravity=aZ;this.m_inv_dt0=0;this.m_contactManager.m_world=this;var aX=new n();this.m_groundBody=this.CreateBody(aX)};s.prototype.SetDestructionListener=function(aX){this.m_destructionListener=aX};s.prototype.SetContactFilter=function(aX){this.m_contactManager.m_contactFilter=aX};s.prototype.SetContactListener=function(aX){this.m_contactManager.m_contactListener=aX};s.prototype.SetDebugDraw=function(aX){this.m_debugDraw=aX};s.prototype.SetBroadPhase=function(aY){var aZ=this.m_contactManager.m_broadPhase;this.m_contactManager.m_broadPhase=aY;for(var aX=this.m_bodyList;aX;aX=aX.m_next){for(var a0=aX.m_fixtureList;a0;a0=a0.m_next){a0.m_proxy=aY.CreateProxy(aZ.GetFatAABB(a0.m_proxy),a0)}}};s.prototype.Validate=function(){this.m_contactManager.m_broadPhase.Validate()};s.prototype.GetProxyCount=function(){return this.m_contactManager.m_broadPhase.GetProxyCount()};s.prototype.CreateBody=function(aY){if(this.IsLocked()==true){return null}var aX=new G(aY,this);aX.m_prev=null;aX.m_next=this.m_bodyList;if(this.m_bodyList){this.m_bodyList.m_prev=aX}this.m_bodyList=aX;++this.m_bodyCount;return aX};s.prototype.DestroyBody=function(a5){if(this.IsLocked()==true){return}var a0=a5.m_jointList;while(a0){var a4=a0;a0=a0.next;if(this.m_destructionListener){this.m_destructionListener.SayGoodbyeJoint(a4.joint)}this.DestroyJoint(a4.joint)}var a2=a5.m_controllerList;while(a2){var aX=a2;a2=a2.nextController;aX.controller.RemoveBody(a5)}var aY=a5.m_contactList;while(aY){var aZ=aY;aY=aY.next;this.m_contactManager.Destroy(aZ.contact)}a5.m_contactList=null;var a3=a5.m_fixtureList;while(a3){var a1=a3;a3=a3.m_next;if(this.m_destructionListener){this.m_destructionListener.SayGoodbyeFixture(a1)}a1.DestroyProxy(this.m_contactManager.m_broadPhase);a1.Destroy()}a5.m_fixtureList=null;a5.m_fixtureCount=0;if(a5.m_prev){a5.m_prev.m_next=a5.m_next}if(a5.m_next){a5.m_next.m_prev=a5.m_prev}if(a5==this.m_bodyList){this.m_bodyList=a5.m_next}--this.m_bodyCount};s.prototype.CreateJoint=function(aZ){var aX=ad.Create(aZ,null);aX.m_prev=null;aX.m_next=this.m_jointList;if(this.m_jointList){this.m_jointList.m_prev=aX}this.m_jointList=aX;++this.m_jointCount;aX.m_edgeA.joint=aX;aX.m_edgeA.other=aX.m_bodyB;aX.m_edgeA.prev=null;aX.m_edgeA.next=aX.m_bodyA.m_jointList;if(aX.m_bodyA.m_jointList){aX.m_bodyA.m_jointList.prev=aX.m_edgeA}aX.m_bodyA.m_jointList=aX.m_edgeA;aX.m_edgeB.joint=aX;aX.m_edgeB.other=aX.m_bodyA;aX.m_edgeB.prev=null;aX.m_edgeB.next=aX.m_bodyB.m_jointList;if(aX.m_bodyB.m_jointList){aX.m_bodyB.m_jointList.prev=aX.m_edgeB}aX.m_bodyB.m_jointList=aX.m_edgeB;var a1=aZ.bodyA;var a0=aZ.bodyB;if(aZ.collideConnected==false){var aY=a0.GetContactList();while(aY){if(aY.other==a1){aY.contact.FlagForFiltering()}aY=aY.next}}return aX};s.prototype.DestroyJoint=function(aX){var aZ=aX.m_collideConnected;if(aX.m_prev){aX.m_prev.m_next=aX.m_next}if(aX.m_next){aX.m_next.m_prev=aX.m_prev}if(aX==this.m_jointList){this.m_jointList=aX.m_next}var a1=aX.m_bodyA;var a0=aX.m_bodyB;a1.SetAwake(true);a0.SetAwake(true);if(aX.m_edgeA.prev){aX.m_edgeA.prev.next=aX.m_edgeA.next}if(aX.m_edgeA.next){aX.m_edgeA.next.prev=aX.m_edgeA.prev}if(aX.m_edgeA==a1.m_jointList){a1.m_jointList=aX.m_edgeA.next}aX.m_edgeA.prev=null;aX.m_edgeA.next=null;if(aX.m_edgeB.prev){aX.m_edgeB.prev.next=aX.m_edgeB.next}if(aX.m_edgeB.next){aX.m_edgeB.next.prev=aX.m_edgeB.prev}if(aX.m_edgeB==a0.m_jointList){a0.m_jointList=aX.m_edgeB.next}aX.m_edgeB.prev=null;aX.m_edgeB.next=null;ad.Destroy(aX,null);--this.m_jointCount;if(aZ==false){var aY=a0.GetContactList();while(aY){if(aY.other==a1){aY.contact.FlagForFiltering()}aY=aY.next}}};s.prototype.AddController=function(aX){aX.m_next=this.m_controllerList;aX.m_prev=null;this.m_controllerList=aX;aX.m_world=this;this.m_controllerCount++;return aX};s.prototype.RemoveController=function(aX){if(aX.m_prev){aX.m_prev.m_next=aX.m_next}if(aX.m_next){aX.m_next.m_prev=aX.m_prev}if(this.m_controllerList==aX){this.m_controllerList=aX.m_next}this.m_controllerCount--};s.prototype.CreateController=function(aX){if(aX.m_world!=this){throw new Error("Controller can only be a member of one world")}aX.m_next=this.m_controllerList;aX.m_prev=null;if(this.m_controllerList){this.m_controllerList.m_prev=aX}this.m_controllerList=aX;++this.m_controllerCount;aX.m_world=this;return aX};s.prototype.DestroyController=function(aX){aX.Clear();if(aX.m_next){aX.m_next.m_prev=aX.m_prev}if(aX.m_prev){aX.m_prev.m_next=aX.m_next}if(aX==this.m_controllerList){this.m_controllerList=aX.m_next}--this.m_controllerCount};s.prototype.SetWarmStarting=function(aX){s.m_warmStarting=aX};s.prototype.SetContinuousPhysics=function(aX){s.m_continuousPhysics=aX};s.prototype.GetBodyCount=function(){return this.m_bodyCount};s.prototype.GetJointCount=function(){return this.m_jointCount};s.prototype.GetContactCount=function(){return this.m_contactCount};s.prototype.SetGravity=function(aX){this.m_gravity=aX};s.prototype.GetGravity=function(){return this.m_gravity};s.prototype.GetGroundBody=function(){return this.m_groundBody};s.prototype.Step=function(aY,a0,aZ){if(aY===undefined){aY=0}if(a0===undefined){a0=0}if(aZ===undefined){aZ=0}if(this.m_flags&s.e_newFixture){this.m_contactManager.FindNewContacts();this.m_flags&=~s.e_newFixture}this.m_flags|=s.e_locked;var aX=s.s_timestep2;aX.dt=aY;aX.velocityIterations=a0;aX.positionIterations=aZ;if(aY>0){aX.inv_dt=1/aY}else{aX.inv_dt=0}aX.dtRatio=this.m_inv_dt0*aY;aX.warmStarting=s.m_warmStarting;this.m_contactManager.Collide();if(aX.dt>0){this.Solve(aX)}if(s.m_continuousPhysics&&aX.dt>0){this.SolveTOI(aX)}if(aX.dt>0){this.m_inv_dt0=aX.inv_dt}this.m_flags&=~s.e_locked};s.prototype.ClearForces=function(){for(var aX=this.m_bodyList;aX;aX=aX.m_next){aX.m_force.SetZero();aX.m_torque=0}};s.prototype.DrawDebugData=function(){if(this.m_debugDraw==null){return}this.m_debugDraw.m_sprite.graphics.clear();var aZ=this.m_debugDraw.GetFlags();var a9=0;var be;var bc;var a3;var a7;var bh;var bf=new ap;var bb=new ap;var ba=new ap;var a4;var a1=new aa();var aY=new aa();var a5=[new ap(),new ap(),new ap(),new ap()];var a6=new al(0,0,0);if(aZ&M.e_shapeBit){for(be=this.m_bodyList;be;be=be.m_next){a4=be.m_xf;for(bc=be.GetFixtureList();bc;bc=bc.m_next){a3=bc.GetShape();if(be.IsActive()==false){a6.Set(0.5,0.5,0.3);this.DrawShape(a3,a4,a6)}else{if(be.GetType()==G.b2_staticBody){a6.Set(0.5,0.9,0.5);this.DrawShape(a3,a4,a6)}else{if(be.GetType()==G.b2_kinematicBody){a6.Set(0.5,0.5,0.9);this.DrawShape(a3,a4,a6)}else{if(be.IsAwake()==false){a6.Set(0.6,0.6,0.6);this.DrawShape(a3,a4,a6)}else{a6.Set(0.9,0.7,0.7);this.DrawShape(a3,a4,a6)}}}}}}}if(aZ&M.e_jointBit){for(a7=this.m_jointList;a7;a7=a7.m_next){this.DrawJoint(a7)}}if(aZ&M.e_controllerBit){for(var bd=this.m_controllerList;bd;bd=bd.m_next){bd.Draw(this.m_debugDraw)}}if(aZ&M.e_pairBit){a6.Set(0.3,0.9,0.9);for(var a8=this.m_contactManager.m_contactList;a8;a8=a8.GetNext()){var bi=a8.GetFixtureA();var bg=a8.GetFixtureB();var a0=bi.GetAABB().GetCenter();var aX=bg.GetAABB().GetCenter();this.m_debugDraw.DrawSegment(a0,aX,a6)}}if(aZ&M.e_aabbBit){bh=this.m_contactManager.m_broadPhase;a5=[new ap(),new ap(),new ap(),new ap()];for(be=this.m_bodyList;be;be=be.GetNext()){if(be.IsActive()==false){continue}for(bc=be.GetFixtureList();bc;bc=bc.GetNext()){var a2=bh.GetFatAABB(bc.m_proxy);a5[0].Set(a2.lowerBound.x,a2.lowerBound.y);a5[1].Set(a2.upperBound.x,a2.lowerBound.y);a5[2].Set(a2.upperBound.x,a2.upperBound.y);a5[3].Set(a2.lowerBound.x,a2.upperBound.y);this.m_debugDraw.DrawPolygon(a5,4,a6)}}}if(aZ&M.e_centerOfMassBit){for(be=this.m_bodyList;be;be=be.m_next){a4=s.s_xf;a4.R=be.m_xf.R;a4.position=be.GetWorldCenter();this.m_debugDraw.DrawTransform(a4)}}};s.prototype.QueryAABB=function(a1,aY){var a0=this;var aX=a0.m_contactManager.m_broadPhase;function aZ(a2){return a1(aX.GetUserData(a2))}aX.Query(aZ,aY)};s.prototype.QueryShape=function(a3,aZ,a1){var a2=this;if(a1===undefined){a1=null}if(a1==null){a1=new f();a1.SetIdentity()}var aX=a2.m_contactManager.m_broadPhase;function a0(a4){var a5=(aX.GetUserData(a4) instanceof aL?aX.GetUserData(a4):null);if(ar.TestOverlap(aZ,a1,a5.GetShape(),a5.GetBody().GetTransform())){return a3(a5)}return true}var aY=new aa();aZ.ComputeAABB(aY,a1);aX.Query(a0,aY)};s.prototype.QueryPoint=function(a2,a1){var a0=this;var aX=a0.m_contactManager.m_broadPhase;function aZ(a3){var a4=(aX.GetUserData(a3) instanceof aL?aX.GetUserData(a3):null);if(a4.TestPoint(a1)){return a2(a4)}return true}var aY=new aa();aY.lowerBound.Set(a1.x-y.b2_linearSlop,a1.y-y.b2_linearSlop);aY.upperBound.Set(a1.x+y.b2_linearSlop,a1.y+y.b2_linearSlop);aX.Query(aZ,aY)};s.prototype.RayCast=function(a4,a3,a1){var a2=this;var aX=a2.m_contactManager.m_broadPhase;var a0=new m;function aZ(a7,a8){var a6=aX.GetUserData(a8);var ba=(a6 instanceof aL?a6:null);var bb=ba.RayCast(a0,a7);if(bb){var a9=a0.fraction;var a5=new ap((1-a9)*a3.x+a9*a1.x,(1-a9)*a3.y+a9*a1.y);return a4(ba,a5,a0.normal,a9)}return a7.maxFraction}var aY=new X(a3,a1);aX.RayCast(aZ,aY)};s.prototype.RayCastOne=function(a1,aY){var a0=this;var aX;function aZ(a4,a2,a5,a3){if(a3===undefined){a3=0}aX=a4;return a3}a0.RayCast(aZ,a1,aY);return aX};s.prototype.RayCastAll=function(a1,aZ){var a0=this;var aX=new Vector();function aY(a4,a2,a5,a3){if(a3===undefined){a3=0}aX[aX.length]=a4;return 1}a0.RayCast(aY,a1,aZ);return aX};s.prototype.GetBodyList=function(){return this.m_bodyList};s.prototype.GetJointList=function(){return this.m_jointList};s.prototype.GetContactList=function(){return this.m_contactList};s.prototype.IsLocked=function(){return(this.m_flags&s.e_locked)>0};s.prototype.Solve=function(aY){var a7;for(var a3=this.m_controllerList;a3;a3=a3.m_next){a3.Step(aY)}var a4=this.m_island;a4.Initialize(this.m_bodyCount,this.m_contactCount,this.m_jointCount,null,this.m_contactManager.m_contactListener,this.m_contactSolver);for(a7=this.m_bodyList;a7;a7=a7.m_next){a7.m_flags&=~G.e_islandFlag}for(var a6=this.m_contactList;a6;a6=a6.m_next){a6.m_flags&=~t.e_islandFlag}for(var a0=this.m_jointList;a0;a0=a0.m_next){a0.m_islandFlag=false}var ba=parseInt(this.m_bodyCount);var a8=this.s_stack;for(var a2=this.m_bodyList;a2;a2=a2.m_next){if(a2.m_flags&G.e_islandFlag){continue}if(a2.IsAwake()==false||a2.IsActive()==false){continue}if(a2.GetType()==G.b2_staticBody){continue}a4.Clear();var a9=0;a8[a9++]=a2;a2.m_flags|=G.e_islandFlag;while(a9>0){a7=a8[--a9];a4.AddBody(a7);if(a7.IsAwake()==false){a7.SetAwake(true)}if(a7.GetType()==G.b2_staticBody){continue}var a5;for(var aX=a7.m_contactList;aX;aX=aX.next){if(aX.contact.m_flags&t.e_islandFlag){continue}if(aX.contact.IsSensor()==true||aX.contact.IsEnabled()==false||aX.contact.IsTouching()==false){continue}a4.AddContact(aX.contact);aX.contact.m_flags|=t.e_islandFlag;a5=aX.other;if(a5.m_flags&G.e_islandFlag){continue}a8[a9++]=a5;a5.m_flags|=G.e_islandFlag}for(var aZ=a7.m_jointList;aZ;aZ=aZ.next){if(aZ.joint.m_islandFlag==true){continue}a5=aZ.other;if(a5.IsActive()==false){continue}a4.AddJoint(aZ.joint);aZ.joint.m_islandFlag=true;if(a5.m_flags&G.e_islandFlag){continue}a8[a9++]=a5;a5.m_flags|=G.e_islandFlag}}a4.Solve(aY,this.m_gravity,this.m_allowSleep);for(var a1=0;a1<a4.m_bodyCount;++a1){a7=a4.m_bodies[a1];if(a7.GetType()==G.b2_staticBody){a7.m_flags&=~G.e_islandFlag}}}for(a1=0;a1<a8.length;++a1){if(!a8[a1]){break}a8[a1]=null}for(a7=this.m_bodyList;a7;a7=a7.m_next){if(a7.IsAwake()==false||a7.IsActive()==false){continue}if(a7.GetType()==G.b2_staticBody){continue}a7.SynchronizeFixtures()}this.m_contactManager.FindNewContacts()};s.prototype.SolveTOI=function(aZ){var bf;var a2;var a0;var bi;var bh;var a5;var a8;var bc=this.m_island;bc.Initialize(this.m_bodyCount,y.b2_maxTOIContactsPerIsland,y.b2_maxTOIJointsPerIsland,null,this.m_contactManager.m_contactListener,this.m_contactSolver);var a6=s.s_queue;for(bf=this.m_bodyList;bf;bf=bf.m_next){bf.m_flags&=~G.e_islandFlag;bf.m_sweep.t0=0}var bd;for(bd=this.m_contactList;bd;bd=bd.m_next){bd.m_flags&=~(t.e_toiFlag|t.e_islandFlag)}for(a8=this.m_jointList;a8;a8=a8.m_next){a8.m_islandFlag=false}for(;;){var a1=null;var a3=1;for(bd=this.m_contactList;bd;bd=bd.m_next){if(bd.IsSensor()==true||bd.IsEnabled()==false||bd.IsContinuous()==false){continue}var a7=1;if(bd.m_flags&t.e_toiFlag){a7=bd.m_toi}else{a2=bd.m_fixtureA;a0=bd.m_fixtureB;bi=a2.m_body;bh=a0.m_body;if((bi.GetType()!=G.b2_dynamicBody||bi.IsAwake()==false)&&(bh.GetType()!=G.b2_dynamicBody||bh.IsAwake()==false)){continue}var a4=bi.m_sweep.t0;if(bi.m_sweep.t0<bh.m_sweep.t0){a4=bh.m_sweep.t0;bi.m_sweep.Advance(a4)}else{if(bh.m_sweep.t0<bi.m_sweep.t0){a4=bi.m_sweep.t0;bh.m_sweep.Advance(a4)}}a7=bd.ComputeTOI(bi.m_sweep,bh.m_sweep);y.b2Assert(0<=a7&&a7<=1);if(a7>0&&a7<1){a7=(1-a7)*a4+a7;if(a7>1){a7=1}}bd.m_toi=a7;bd.m_flags|=t.e_toiFlag}if(Number.MIN_VALUE<a7&&a7<a3){a1=bd;a3=a7}}if(a1==null||1-100*Number.MIN_VALUE<a3){break}a2=a1.m_fixtureA;a0=a1.m_fixtureB;bi=a2.m_body;bh=a0.m_body;s.s_backupA.Set(bi.m_sweep);s.s_backupB.Set(bh.m_sweep);bi.Advance(a3);bh.Advance(a3);a1.Update(this.m_contactManager.m_contactListener);a1.m_flags&=~t.e_toiFlag;if(a1.IsSensor()==true||a1.IsEnabled()==false){bi.m_sweep.Set(s.s_backupA);bh.m_sweep.Set(s.s_backupB);bi.SynchronizeTransform();bh.SynchronizeTransform();continue}if(a1.IsTouching()==false){continue}var aY=bi;if(aY.GetType()!=G.b2_dynamicBody){aY=bh}bc.Clear();var a9=0;var bb=0;a6[a9+bb++]=aY;aY.m_flags|=G.e_islandFlag;while(bb>0){bf=a6[a9++];--bb;bc.AddBody(bf);if(bf.IsAwake()==false){bf.SetAwake(true)}if(bf.GetType()!=G.b2_dynamicBody){continue}for(a5=bf.m_contactList;a5;a5=a5.next){if(bc.m_contactCount==bc.m_contactCapacity){break}if(a5.contact.m_flags&t.e_islandFlag){continue}if(a5.contact.IsSensor()==true||a5.contact.IsEnabled()==false||a5.contact.IsTouching()==false){continue}bc.AddContact(a5.contact);a5.contact.m_flags|=t.e_islandFlag;var aX=a5.other;if(aX.m_flags&G.e_islandFlag){continue}if(aX.GetType()!=G.b2_staticBody){aX.Advance(a3);aX.SetAwake(true)}a6[a9+bb]=aX;++bb;aX.m_flags|=G.e_islandFlag}for(var be=bf.m_jointList;be;be=be.next){if(bc.m_jointCount==bc.m_jointCapacity){continue}if(be.joint.m_islandFlag==true){continue}aX=be.other;if(aX.IsActive()==false){continue}bc.AddJoint(be.joint);be.joint.m_islandFlag=true;if(aX.m_flags&G.e_islandFlag){continue}if(aX.GetType()!=G.b2_staticBody){aX.Advance(a3);aX.SetAwake(true)}a6[a9+bb]=aX;++bb;aX.m_flags|=G.e_islandFlag}}var bg=s.s_timestep;bg.warmStarting=false;bg.dt=(1-a3)*aZ.dt;bg.inv_dt=1/bg.dt;bg.dtRatio=0;bg.velocityIterations=aZ.velocityIterations;bg.positionIterations=aZ.positionIterations;bc.SolveTOI(bg);var ba=0;for(ba=0;ba<bc.m_bodyCount;++ba){bf=bc.m_bodies[ba];bf.m_flags&=~G.e_islandFlag;if(bf.IsAwake()==false){continue}if(bf.GetType()!=G.b2_dynamicBody){continue}bf.SynchronizeFixtures();for(a5=bf.m_contactList;a5;a5=a5.next){a5.contact.m_flags&=~t.e_toiFlag}}for(ba=0;ba<bc.m_contactCount;++ba){bd=bc.m_contacts[ba];bd.m_flags&=~(t.e_toiFlag|t.e_islandFlag)}for(ba=0;ba<bc.m_jointCount;++ba){a8=bc.m_joints[ba];a8.m_islandFlag=false}this.m_contactManager.FindNewContacts()}};s.prototype.DrawJoint=function(a1){var a5=a1.GetBodyA();var a4=a1.GetBodyB();var a3=a5.m_xf;var a2=a4.m_xf;var aZ=a3.position;var aY=a2.position;var a9=a1.GetAnchorA();var a8=a1.GetAnchorB();var a0=s.s_jointColor;switch(a1.m_type){case ad.e_distanceJoint:this.m_debugDraw.DrawSegment(a9,a8,a0);break;case ad.e_pulleyJoint:var aX=((a1 instanceof aW?a1:null));var a7=aX.GetGroundAnchorA();var a6=aX.GetGroundAnchorB();this.m_debugDraw.DrawSegment(a7,a9,a0);this.m_debugDraw.DrawSegment(a6,a8,a0);this.m_debugDraw.DrawSegment(a7,a6,a0);break;case ad.e_mouseJoint:this.m_debugDraw.DrawSegment(a9,a8,a0);break;default:if(a5!=this.m_groundBody){this.m_debugDraw.DrawSegment(aZ,a9,a0)}this.m_debugDraw.DrawSegment(a9,a8,a0);if(a4!=this.m_groundBody){this.m_debugDraw.DrawSegment(aY,a8,a0)}}};s.prototype.DrawShape=function(a7,a8,a3){switch(a7.m_type){case ar.e_circleShape:var a0=((a7 instanceof aO?a7:null));var aY=Z.MulX(a8,a0.m_p);var a5=a0.m_radius;var a2=a8.R.col1;this.m_debugDraw.DrawSolidCircle(aY,a5,a2,a3);break;case ar.e_polygonShape:var a4=0;var aZ=((a7 instanceof aG?a7:null));var aX=parseInt(aZ.GetVertexCount());var a9=aZ.GetVertices();var a6=new Vector(aX);for(a4=0;a4<aX;++a4){a6[a4]=Z.MulX(a8,a9[a4])}this.m_debugDraw.DrawSolidPolygon(a6,aX,a3);break;case ar.e_edgeShape:var a1=(a7 instanceof aH?a7:null);this.m_debugDraw.DrawSegment(Z.MulX(a8,a1.GetVertex1()),Z.MulX(a8,a1.GetVertex2()),a3);break}};Box2D.postDefs.push(function(){Box2D.Dynamics.b2World.s_timestep2=new u();Box2D.Dynamics.b2World.s_xf=new f();Box2D.Dynamics.b2World.s_backupA=new aq();Box2D.Dynamics.b2World.s_backupB=new aq();Box2D.Dynamics.b2World.s_timestep=new u();Box2D.Dynamics.b2World.s_queue=new Vector();Box2D.Dynamics.b2World.s_jointColor=new al(0.5,0.8,0.8);Box2D.Dynamics.b2World.e_newFixture=1;Box2D.Dynamics.b2World.e_locked=2})})();(function(){var av=Box2D.Collision.Shapes.b2CircleShape,c=Box2D.Collision.Shapes.b2EdgeChainDef,an=Box2D.Collision.Shapes.b2EdgeShape,R=Box2D.Collision.Shapes.b2MassData,am=Box2D.Collision.Shapes.b2PolygonShape,aa=Box2D.Collision.Shapes.b2Shape,d=Box2D.Dynamics.Contacts.b2CircleContact,q=Box2D.Dynamics.Contacts.b2Contact,D=Box2D.Dynamics.Contacts.b2ContactConstraint,J=Box2D.Dynamics.Contacts.b2ContactConstraintPoint,b=Box2D.Dynamics.Contacts.b2ContactEdge,ad=Box2D.Dynamics.Contacts.b2ContactFactory,h=Box2D.Dynamics.Contacts.b2ContactRegister,s=Box2D.Dynamics.Contacts.b2ContactResult,M=Box2D.Dynamics.Contacts.b2ContactSolver,ay=Box2D.Dynamics.Contacts.b2EdgeAndCircleContact,n=Box2D.Dynamics.Contacts.b2NullContact,ac=Box2D.Dynamics.Contacts.b2PolyAndCircleContact,v=Box2D.Dynamics.Contacts.b2PolyAndEdgeContact,L=Box2D.Dynamics.Contacts.b2PolygonContact,ab=Box2D.Dynamics.Contacts.b2PositionSolverManifold,B=Box2D.Dynamics.b2Body,l=Box2D.Dynamics.b2BodyDef,U=Box2D.Dynamics.b2ContactFilter,T=Box2D.Dynamics.b2ContactImpulse,t=Box2D.Dynamics.b2ContactListener,x=Box2D.Dynamics.b2ContactManager,E=Box2D.Dynamics.b2DebugDraw,z=Box2D.Dynamics.b2DestructionListener,ah=Box2D.Dynamics.b2FilterData,ar=Box2D.Dynamics.b2Fixture,a=Box2D.Dynamics.b2FixtureDef,aw=Box2D.Dynamics.b2Island,r=Box2D.Dynamics.b2TimeStep,p=Box2D.Dynamics.b2World,V=Box2D.Common.b2Color,at=Box2D.Common.b2internal,u=Box2D.Common.b2Settings,F=Box2D.Common.Math.b2Mat22,o=Box2D.Common.Math.b2Mat33,P=Box2D.Common.Math.b2Math,Z=Box2D.Common.Math.b2Sweep,e=Box2D.Common.Math.b2Transform,Y=Box2D.Common.Math.b2Vec2,W=Box2D.Common.Math.b2Vec3,Q=Box2D.Collision.b2AABB,ag=Box2D.Collision.b2Bound,au=Box2D.Collision.b2BoundValues,y=Box2D.Collision.b2Collision,A=Box2D.Collision.b2ContactID,S=Box2D.Collision.b2ContactPoint,aj=Box2D.Collision.b2Distance,f=Box2D.Collision.b2DistanceInput,m=Box2D.Collision.b2DistanceOutput,I=Box2D.Collision.b2DistanceProxy,j=Box2D.Collision.b2DynamicTree,aq=Box2D.Collision.b2DynamicTreeBroadPhase,af=Box2D.Collision.b2DynamicTreeNode,G=Box2D.Collision.b2DynamicTreePair,H=Box2D.Collision.b2Manifold,C=Box2D.Collision.b2ManifoldPoint,K=Box2D.Collision.b2Point,N=Box2D.Collision.b2RayCastInput,k=Box2D.Collision.b2RayCastOutput,g=Box2D.Collision.b2Segment,ai=Box2D.Collision.b2SeparationFunction,ap=Box2D.Collision.b2Simplex,w=Box2D.Collision.b2SimplexCache,ax=Box2D.Collision.b2SimplexVertex,X=Box2D.Collision.b2TimeOfImpact,al=Box2D.Collision.b2TOIInput,ao=Box2D.Collision.b2WorldManifold,ak=Box2D.Collision.ClipVertex,O=Box2D.Collision.Features,ae=Box2D.Collision.IBroadPhase;Box2D.inherit(d,Box2D.Dynamics.Contacts.b2Contact);d.prototype.__super=Box2D.Dynamics.Contacts.b2Contact.prototype;d.b2CircleContact=function(){Box2D.Dynamics.Contacts.b2Contact.b2Contact.apply(this,arguments)};d.Create=function(az){return new d()};d.Destroy=function(az,aA){};d.prototype.Reset=function(az,aA){this.__super.Reset.call(this,az,aA)};d.prototype.Evaluate=function(){var aA=this.m_fixtureA.GetBody();var az=this.m_fixtureB.GetBody();y.CollideCircles(this.m_manifold,(this.m_fixtureA.GetShape() instanceof av?this.m_fixtureA.GetShape():null),aA.m_xf,(this.m_fixtureB.GetShape() instanceof av?this.m_fixtureB.GetShape():null),az.m_xf)};q.b2Contact=function(){this.m_nodeA=new b();this.m_nodeB=new b();this.m_manifold=new H();this.m_oldManifold=new H()};q.prototype.GetManifold=function(){return this.m_manifold};q.prototype.GetWorldManifold=function(aC){var aD=this.m_fixtureA.GetBody();var aB=this.m_fixtureB.GetBody();var aA=this.m_fixtureA.GetShape();var az=this.m_fixtureB.GetShape();aC.Initialize(this.m_manifold,aD.GetTransform(),aA.m_radius,aB.GetTransform(),az.m_radius)};q.prototype.IsTouching=function(){return(this.m_flags&q.e_touchingFlag)==q.e_touchingFlag};q.prototype.IsContinuous=function(){return(this.m_flags&q.e_continuousFlag)==q.e_continuousFlag};q.prototype.SetSensor=function(az){if(az){this.m_flags|=q.e_sensorFlag}else{this.m_flags&=~q.e_sensorFlag}};q.prototype.IsSensor=function(){return(this.m_flags&q.e_sensorFlag)==q.e_sensorFlag};q.prototype.SetEnabled=function(az){if(az){this.m_flags|=q.e_enabledFlag}else{this.m_flags&=~q.e_enabledFlag}};q.prototype.IsEnabled=function(){return(this.m_flags&q.e_enabledFlag)==q.e_enabledFlag};q.prototype.GetNext=function(){return this.m_next};q.prototype.GetFixtureA=function(){return this.m_fixtureA};q.prototype.GetFixtureB=function(){return this.m_fixtureB};q.prototype.FlagForFiltering=function(){this.m_flags|=q.e_filterFlag};q.prototype.b2Contact=function(){};q.prototype.Reset=function(az,aC){if(az===undefined){az=null}if(aC===undefined){aC=null}this.m_flags=q.e_enabledFlag;if(!az||!aC){this.m_fixtureA=null;this.m_fixtureB=null;return}if(az.IsSensor()||aC.IsSensor()){this.m_flags|=q.e_sensorFlag}var aB=az.GetBody();var aA=aC.GetBody();if(aB.GetType()!=B.b2_dynamicBody||aB.IsBullet()||aA.GetType()!=B.b2_dynamicBody||aA.IsBullet()){this.m_flags|=q.e_continuousFlag}this.m_fixtureA=az;this.m_fixtureB=aC;this.m_manifold.m_pointCount=0;this.m_prev=null;this.m_next=null;this.m_nodeA.contact=null;this.m_nodeA.prev=null;this.m_nodeA.next=null;this.m_nodeA.other=null;this.m_nodeB.contact=null;this.m_nodeB.prev=null;this.m_nodeB.next=null;this.m_nodeB.other=null};q.prototype.Update=function(aA){var az=this.m_oldManifold;this.m_oldManifold=this.m_manifold;this.m_manifold=az;this.m_flags|=q.e_enabledFlag;var aJ=false;var aO=(this.m_flags&q.e_touchingFlag)==q.e_touchingFlag;var aE=this.m_fixtureA.m_body;var aC=this.m_fixtureB.m_body;var aL=this.m_fixtureA.m_aabb.TestOverlap(this.m_fixtureB.m_aabb);if(this.m_flags&q.e_sensorFlag){if(aL){var aD=this.m_fixtureA.GetShape();var aB=this.m_fixtureB.GetShape();var aM=aE.GetTransform();var aK=aC.GetTransform();aJ=aa.TestOverlap(aD,aM,aB,aK)}this.m_manifold.m_pointCount=0}else{if(aE.GetType()!=B.b2_dynamicBody||aE.IsBullet()||aC.GetType()!=B.b2_dynamicBody||aC.IsBullet()){this.m_flags|=q.e_continuousFlag}else{this.m_flags&=~q.e_continuousFlag}if(aL){this.Evaluate();aJ=this.m_manifold.m_pointCount>0;for(var aG=0;aG<this.m_manifold.m_pointCount;++aG){var aH=this.m_manifold.m_points[aG];aH.m_normalImpulse=0;aH.m_tangentImpulse=0;var aN=aH.m_id;for(var aF=0;aF<this.m_oldManifold.m_pointCount;++aF){var aI=this.m_oldManifold.m_points[aF];if(aI.m_id.key==aN.key){aH.m_normalImpulse=aI.m_normalImpulse;aH.m_tangentImpulse=aI.m_tangentImpulse;break}}}}else{this.m_manifold.m_pointCount=0}if(aJ!=aO){aE.SetAwake(true);aC.SetAwake(true)}}if(aJ){this.m_flags|=q.e_touchingFlag}else{this.m_flags&=~q.e_touchingFlag}if(aO==false&&aJ==true){aA.BeginContact(this)}if(aO==true&&aJ==false){aA.EndContact(this)}if((this.m_flags&q.e_sensorFlag)==0){aA.PreSolve(this,this.m_oldManifold)}};q.prototype.Evaluate=function(){};q.prototype.ComputeTOI=function(aA,az){q.s_input.proxyA.Set(this.m_fixtureA.GetShape());q.s_input.proxyB.Set(this.m_fixtureB.GetShape());q.s_input.sweepA=aA;q.s_input.sweepB=az;q.s_input.tolerance=u.b2_linearSlop;return X.TimeOfImpact(q.s_input)};Box2D.postDefs.push(function(){Box2D.Dynamics.Contacts.b2Contact.e_sensorFlag=1;Box2D.Dynamics.Contacts.b2Contact.e_continuousFlag=2;Box2D.Dynamics.Contacts.b2Contact.e_islandFlag=4;Box2D.Dynamics.Contacts.b2Contact.e_toiFlag=8;Box2D.Dynamics.Contacts.b2Contact.e_touchingFlag=16;Box2D.Dynamics.Contacts.b2Contact.e_enabledFlag=32;Box2D.Dynamics.Contacts.b2Contact.e_filterFlag=64;Box2D.Dynamics.Contacts.b2Contact.s_input=new al()});D.b2ContactConstraint=function(){this.localPlaneNormal=new Y();this.localPoint=new Y();this.normal=new Y();this.normalMass=new F();this.K=new F()};D.prototype.b2ContactConstraint=function(){this.points=new Vector(u.b2_maxManifoldPoints);for(var az=0;az<u.b2_maxManifoldPoints;az++){this.points[az]=new J()}};J.b2ContactConstraintPoint=function(){this.localPoint=new Y();this.rA=new Y();this.rB=new Y()};b.b2ContactEdge=function(){};ad.b2ContactFactory=function(){};ad.prototype.b2ContactFactory=function(az){this.m_allocator=az;this.InitializeRegisters()};ad.prototype.AddType=function(aB,aC,aA,az){if(aA===undefined){aA=0}if(az===undefined){az=0}this.m_registers[aA][az].createFcn=aB;this.m_registers[aA][az].destroyFcn=aC;this.m_registers[aA][az].primary=true;if(aA!=az){this.m_registers[az][aA].createFcn=aB;this.m_registers[az][aA].destroyFcn=aC;this.m_registers[az][aA].primary=false}};ad.prototype.InitializeRegisters=function(){this.m_registers=new Vector(aa.e_shapeTypeCount);for(var aA=0;aA<aa.e_shapeTypeCount;aA++){this.m_registers[aA]=new Vector(aa.e_shapeTypeCount);for(var az=0;az<aa.e_shapeTypeCount;az++){this.m_registers[aA][az]=new h()}}this.AddType(d.Create,d.Destroy,aa.e_circleShape,aa.e_circleShape);this.AddType(ac.Create,ac.Destroy,aa.e_polygonShape,aa.e_circleShape);this.AddType(L.Create,L.Destroy,aa.e_polygonShape,aa.e_polygonShape);this.AddType(ay.Create,ay.Destroy,aa.e_edgeShape,aa.e_circleShape);this.AddType(v.Create,v.Destroy,aa.e_polygonShape,aa.e_edgeShape)};ad.prototype.Create=function(az,aF){var aB=parseInt(az.GetType());var aA=parseInt(aF.GetType());var aD=this.m_registers[aB][aA];var aE;if(aD.pool){aE=aD.pool;aD.pool=aE.m_next;aD.poolCount--;aE.Reset(az,aF);return aE}var aC=aD.createFcn;if(aC!=null){if(aD.primary){aE=aC(this.m_allocator);aE.Reset(az,aF);return aE}else{aE=aC(this.m_allocator);aE.Reset(aF,az);return aE}}else{return null}};ad.prototype.Destroy=function(az){if(az.m_manifold.m_pointCount>0){az.m_fixtureA.m_body.SetAwake(true);az.m_fixtureB.m_body.SetAwake(true)}var aB=parseInt(az.m_fixtureA.GetType());var aA=parseInt(az.m_fixtureB.GetType());var aC=this.m_registers[aB][aA];if(true){aC.poolCount++;az.m_next=aC.pool;aC.pool=az}var aD=aC.destroyFcn;aD(az,this.m_allocator)};h.b2ContactRegister=function(){};s.b2ContactResult=function(){this.position=new Y();this.normal=new Y();this.id=new A()};M.b2ContactSolver=function(){this.m_step=new r();this.m_constraints=new Vector()};M.prototype.b2ContactSolver=function(){};M.prototype.Initialize=function(bf,a0,a1,aQ){if(a1===undefined){a1=0}var aV;this.m_step.Set(bf);this.m_allocator=aQ;var bu=0;var bj;var bo;this.m_constraintCount=a1;while(this.m_constraints.length<this.m_constraintCount){this.m_constraints[this.m_constraints.length]=new D()}for(bu=0;bu<a1;++bu){aV=a0[bu];var bd=aV.m_fixtureA;var bb=aV.m_fixtureB;var aF=bd.m_shape;var aD=bb.m_shape;var aX=aF.m_radius;var aW=aD.m_radius;var bx=bd.m_body;var bv=bb.m_body;var ba=aV.GetManifold();var a5=u.b2MixFriction(bd.GetFriction(),bb.GetFriction());var az=u.b2MixRestitution(bd.GetRestitution(),bb.GetRestitution());var aK=bx.m_linearVelocity.x;var aJ=bx.m_linearVelocity.y;var bs=bv.m_linearVelocity.x;var br=bv.m_linearVelocity.y;var a7=bx.m_angularVelocity;var a6=bv.m_angularVelocity;u.b2Assert(ba.m_pointCount>0);M.s_worldManifold.Initialize(ba,bx.m_xf,aX,bv.m_xf,aW);var bl=M.s_worldManifold.m_normal.x;var bk=M.s_worldManifold.m_normal.y;var bg=this.m_constraints[bu];bg.bodyA=bx;bg.bodyB=bv;bg.manifold=ba;bg.normal.x=bl;bg.normal.y=bk;bg.pointCount=ba.m_pointCount;bg.friction=a5;bg.restitution=az;bg.localPlaneNormal.x=ba.m_localPlaneNormal.x;bg.localPlaneNormal.y=ba.m_localPlaneNormal.y;bg.localPoint.x=ba.m_localPoint.x;bg.localPoint.y=ba.m_localPoint.y;bg.radius=aX+aW;bg.type=ba.m_type;for(var bt=0;bt<bg.pointCount;++bt){var a8=ba.m_points[bt];var aB=bg.points[bt];aB.normalImpulse=a8.m_normalImpulse;aB.tangentImpulse=a8.m_tangentImpulse;aB.localPoint.SetV(a8.m_localPoint);var bi=aB.rA.x=M.s_worldManifold.m_points[bt].x-bx.m_sweep.c.x;var bh=aB.rA.y=M.s_worldManifold.m_points[bt].y-bx.m_sweep.c.y;var aZ=aB.rB.x=M.s_worldManifold.m_points[bt].x-bv.m_sweep.c.x;var aY=aB.rB.y=M.s_worldManifold.m_points[bt].y-bv.m_sweep.c.y;var aP=bi*bk-bh*bl;var aM=aZ*bk-aY*bl;aP*=aP;aM*=aM;var a9=bx.m_invMass+bv.m_invMass+bx.m_invI*aP+bv.m_invI*aM;aB.normalMass=1/a9;var aO=bx.m_mass*bx.m_invMass+bv.m_mass*bv.m_invMass;aO+=bx.m_mass*bx.m_invI*aP+bv.m_mass*bv.m_invI*aM;aB.equalizedMass=1/aO;var bp=bk;var bn=(-bl);var aU=bi*bn-bh*bp;var aT=aZ*bn-aY*bp;aU*=aU;aT*=aT;var bw=bx.m_invMass+bv.m_invMass+bx.m_invI*aU+bv.m_invI*aT;aB.tangentMass=1/bw;aB.velocityBias=0;var aN=bs+((-a6*aY))-aK-((-a7*bh));var aL=br+(a6*aZ)-aJ-(a7*bi);var bq=bg.normal.x*aN+bg.normal.y*aL;if(bq<(-u.b2_velocityThreshold)){aB.velocityBias+=(-bg.restitution*bq)}}if(bg.pointCount==2){var aI=bg.points[0];var aH=bg.points[1];var be=bx.m_invMass;var aS=bx.m_invI;var bc=bv.m_invMass;var aR=bv.m_invI;var a3=aI.rA.x*bk-aI.rA.y*bl;var a2=aI.rB.x*bk-aI.rB.y*bl;var aC=aH.rA.x*bk-aH.rA.y*bl;var aA=aH.rB.x*bk-aH.rB.y*bl;var aG=be+bc+aS*a3*a3+aR*a2*a2;var bm=be+bc+aS*aC*aC+aR*aA*aA;var aE=be+bc+aS*a3*aC+aR*a2*aA;var a4=100;if(aG*aG<a4*(aG*bm-aE*aE)){bg.K.col1.Set(aG,aE);bg.K.col2.Set(aE,bm);bg.K.GetInverse(bg.normalMass)}else{bg.pointCount=1}}}};M.prototype.InitVelocityConstraints=function(aJ){var aB;var aS;var aM;for(var aQ=0;aQ<this.m_constraintCount;++aQ){var aT=this.m_constraints[aQ];var aC=aT.bodyA;var aA=aT.bodyB;var aG=aC.m_invMass;var aV=aC.m_invI;var aE=aA.m_invMass;var aU=aA.m_invI;var aF=aT.normal.x;var aD=aT.normal.y;var aI=aD;var aH=(-aF);var aO=0;var aP=0;var aR=0;if(aJ.warmStarting){aR=aT.pointCount;for(aP=0;aP<aR;++aP){var az=aT.points[aP];az.normalImpulse*=aJ.dtRatio;az.tangentImpulse*=aJ.dtRatio;var aL=az.normalImpulse*aF+az.tangentImpulse*aI;var aK=az.normalImpulse*aD+az.tangentImpulse*aH;aC.m_angularVelocity-=aV*(az.rA.x*aK-az.rA.y*aL);aC.m_linearVelocity.x-=aG*aL;aC.m_linearVelocity.y-=aG*aK;aA.m_angularVelocity+=aU*(az.rB.x*aK-az.rB.y*aL);aA.m_linearVelocity.x+=aE*aL;aA.m_linearVelocity.y+=aE*aK}}else{aR=aT.pointCount;for(aP=0;aP<aR;++aP){var aN=aT.points[aP];aN.normalImpulse=0;aN.tangentImpulse=0}}}};M.prototype.SolveVelocityConstraints=function(){var bh=0;var aA;var a5=0;var a4=0;var aL=0;var aJ=0;var bt=0;var bs=0;var aK=0;var aI=0;var bo=0;var bc=0;var bm=0;var br=0;var bq=0;var aQ=0;var aP=0;var bd=0;var bb=0;var a1=0;var aZ=0;var bf;var a6;for(var bi=0;bi<this.m_constraintCount;++bi){var bp=this.m_constraints[bi];var bv=bp.bodyA;var bu=bp.bodyB;var a0=bv.m_angularVelocity;var aW=bu.m_angularVelocity;var ba=bv.m_linearVelocity;var a9=bu.m_linearVelocity;var a3=bv.m_invMass;var aH=bv.m_invI;var a2=bu.m_invMass;var aG=bu.m_invI;var a8=bp.normal.x;var a7=bp.normal.y;var bg=a7;var be=(-a8);var aR=bp.friction;var aF=0;for(bh=0;bh<bp.pointCount;bh++){aA=bp.points[bh];bt=a9.x-aW*aA.rB.y-ba.x+a0*aA.rA.y;bs=a9.y+aW*aA.rB.x-ba.y-a0*aA.rA.x;aI=bt*bg+bs*be;bo=aA.tangentMass*(-aI);bc=aR*aA.normalImpulse;bm=P.Clamp(aA.tangentImpulse+bo,(-bc),bc);bo=bm-aA.tangentImpulse;br=bo*bg;bq=bo*be;ba.x-=a3*br;ba.y-=a3*bq;a0-=aH*(aA.rA.x*bq-aA.rA.y*br);a9.x+=a2*br;a9.y+=a2*bq;aW+=aG*(aA.rB.x*bq-aA.rB.y*br);aA.tangentImpulse=bm}var aO=parseInt(bp.pointCount);if(bp.pointCount==1){aA=bp.points[0];bt=a9.x+((-aW*aA.rB.y))-ba.x-((-a0*aA.rA.y));bs=a9.y+(aW*aA.rB.x)-ba.y-(a0*aA.rA.x);aK=bt*a8+bs*a7;bo=(-aA.normalMass*(aK-aA.velocityBias));bm=aA.normalImpulse+bo;bm=bm>0?bm:0;bo=bm-aA.normalImpulse;br=bo*a8;bq=bo*a7;ba.x-=a3*br;ba.y-=a3*bq;a0-=aH*(aA.rA.x*bq-aA.rA.y*br);a9.x+=a2*br;a9.y+=a2*bq;aW+=aG*(aA.rB.x*bq-aA.rB.y*br);aA.normalImpulse=bm}else{var aV=bp.points[0];var aT=bp.points[1];var aN=aV.normalImpulse;var aM=aT.normalImpulse;var aU=a9.x-aW*aV.rB.y-ba.x+a0*aV.rA.y;var aS=a9.y+aW*aV.rB.x-ba.y-a0*aV.rA.x;var aE=a9.x-aW*aT.rB.y-ba.x+a0*aT.rA.y;var aD=a9.y+aW*aT.rB.x-ba.y-a0*aT.rA.x;var bn=aU*a8+aS*a7;var bl=aE*a8+aD*a7;var aC=bn-aV.velocityBias;var aB=bl-aT.velocityBias;bf=bp.K;aC-=bf.col1.x*aN+bf.col2.x*aM;aB-=bf.col1.y*aN+bf.col2.y*aM;var az=0.001;for(;;){bf=bp.normalMass;var bk=(-(bf.col1.x*aC+bf.col2.x*aB));var bj=(-(bf.col1.y*aC+bf.col2.y*aB));if(bk>=0&&bj>=0){aQ=bk-aN;aP=bj-aM;bd=aQ*a8;bb=aQ*a7;a1=aP*a8;aZ=aP*a7;ba.x-=a3*(bd+a1);ba.y-=a3*(bb+aZ);a0-=aH*(aV.rA.x*bb-aV.rA.y*bd+aT.rA.x*aZ-aT.rA.y*a1);a9.x+=a2*(bd+a1);a9.y+=a2*(bb+aZ);aW+=aG*(aV.rB.x*bb-aV.rB.y*bd+aT.rB.x*aZ-aT.rB.y*a1);aV.normalImpulse=bk;aT.normalImpulse=bj;break}bk=(-aV.normalMass*aC);bj=0;bn=0;bl=bp.K.col1.y*bk+aB;if(bk>=0&&bl>=0){aQ=bk-aN;aP=bj-aM;bd=aQ*a8;bb=aQ*a7;a1=aP*a8;aZ=aP*a7;ba.x-=a3*(bd+a1);ba.y-=a3*(bb+aZ);a0-=aH*(aV.rA.x*bb-aV.rA.y*bd+aT.rA.x*aZ-aT.rA.y*a1);a9.x+=a2*(bd+a1);a9.y+=a2*(bb+aZ);aW+=aG*(aV.rB.x*bb-aV.rB.y*bd+aT.rB.x*aZ-aT.rB.y*a1);aV.normalImpulse=bk;aT.normalImpulse=bj;break}bk=0;bj=(-aT.normalMass*aB);bn=bp.K.col2.x*bj+aC;bl=0;if(bj>=0&&bn>=0){aQ=bk-aN;aP=bj-aM;bd=aQ*a8;bb=aQ*a7;a1=aP*a8;aZ=aP*a7;ba.x-=a3*(bd+a1);ba.y-=a3*(bb+aZ);a0-=aH*(aV.rA.x*bb-aV.rA.y*bd+aT.rA.x*aZ-aT.rA.y*a1);a9.x+=a2*(bd+a1);a9.y+=a2*(bb+aZ);aW+=aG*(aV.rB.x*bb-aV.rB.y*bd+aT.rB.x*aZ-aT.rB.y*a1);aV.normalImpulse=bk;aT.normalImpulse=bj;break}bk=0;bj=0;bn=aC;bl=aB;if(bn>=0&&bl>=0){aQ=bk-aN;aP=bj-aM;bd=aQ*a8;bb=aQ*a7;a1=aP*a8;aZ=aP*a7;ba.x-=a3*(bd+a1);ba.y-=a3*(bb+aZ);a0-=aH*(aV.rA.x*bb-aV.rA.y*bd+aT.rA.x*aZ-aT.rA.y*a1);a9.x+=a2*(bd+a1);a9.y+=a2*(bb+aZ);aW+=aG*(aV.rB.x*bb-aV.rB.y*bd+aT.rB.x*aZ-aT.rB.y*a1);aV.normalImpulse=bk;aT.normalImpulse=bj;break}break}}bv.m_angularVelocity=a0;bu.m_angularVelocity=aW}};M.prototype.FinalizeVelocityConstraints=function(){for(var aC=0;aC<this.m_constraintCount;++aC){var aE=this.m_constraints[aC];var az=aE.manifold;for(var aA=0;aA<aE.pointCount;++aA){var aD=az.m_points[aA];var aB=aE.points[aA];aD.m_normalImpulse=aB.normalImpulse;aD.m_tangentImpulse=aB.tangentImpulse}}};M.prototype.SolvePositionConstraints=function(aQ){if(aQ===undefined){aQ=0}var aH=0;for(var aR=0;aR<this.m_constraintCount;aR++){var aS=this.m_constraints[aR];var aB=aS.bodyA;var aA=aS.bodyB;var aD=aB.m_mass*aB.m_invMass;var aU=aB.m_mass*aB.m_invI;var aC=aA.m_mass*aA.m_invMass;var aT=aA.m_mass*aA.m_invI;M.s_psm.Initialize(aS);var aV=M.s_psm.m_normal;for(var aP=0;aP<aS.pointCount;aP++){var az=aS.points[aP];var aO=M.s_psm.m_points[aP];var aK=M.s_psm.m_separations[aP];var aF=aO.x-aB.m_sweep.c.x;var aE=aO.y-aB.m_sweep.c.y;var aN=aO.x-aA.m_sweep.c.x;var aM=aO.y-aA.m_sweep.c.y;aH=aH<aK?aH:aK;var aL=P.Clamp(aQ*(aK+u.b2_linearSlop),(-u.b2_maxLinearCorrection),0);var aJ=(-az.equalizedMass*aL);var aI=aJ*aV.x;var aG=aJ*aV.y;aB.m_sweep.c.x-=aD*aI;aB.m_sweep.c.y-=aD*aG;aB.m_sweep.a-=aU*(aF*aG-aE*aI);aB.SynchronizeTransform();aA.m_sweep.c.x+=aC*aI;aA.m_sweep.c.y+=aC*aG;aA.m_sweep.a+=aT*(aN*aG-aM*aI);aA.SynchronizeTransform()}}return aH>(-1.5*u.b2_linearSlop)};Box2D.postDefs.push(function(){Box2D.Dynamics.Contacts.b2ContactSolver.s_worldManifold=new ao();Box2D.Dynamics.Contacts.b2ContactSolver.s_psm=new ab()});Box2D.inherit(ay,Box2D.Dynamics.Contacts.b2Contact);ay.prototype.__super=Box2D.Dynamics.Contacts.b2Contact.prototype;ay.b2EdgeAndCircleContact=function(){Box2D.Dynamics.Contacts.b2Contact.b2Contact.apply(this,arguments)};ay.Create=function(az){return new ay()};ay.Destroy=function(az,aA){};ay.prototype.Reset=function(az,aA){this.__super.Reset.call(this,az,aA)};ay.prototype.Evaluate=function(){var aA=this.m_fixtureA.GetBody();var az=this.m_fixtureB.GetBody();this.b2CollideEdgeAndCircle(this.m_manifold,(this.m_fixtureA.GetShape() instanceof an?this.m_fixtureA.GetShape():null),aA.m_xf,(this.m_fixtureB.GetShape() instanceof av?this.m_fixtureB.GetShape():null),az.m_xf)};ay.prototype.b2CollideEdgeAndCircle=function(az,aC,aB,aD,aA){};Box2D.inherit(n,Box2D.Dynamics.Contacts.b2Contact);n.prototype.__super=Box2D.Dynamics.Contacts.b2Contact.prototype;n.b2NullContact=function(){Box2D.Dynamics.Contacts.b2Contact.b2Contact.apply(this,arguments)};n.prototype.b2NullContact=function(){this.__super.b2Contact.call(this)};n.prototype.Evaluate=function(){};Box2D.inherit(ac,Box2D.Dynamics.Contacts.b2Contact);ac.prototype.__super=Box2D.Dynamics.Contacts.b2Contact.prototype;ac.b2PolyAndCircleContact=function(){Box2D.Dynamics.Contacts.b2Contact.b2Contact.apply(this,arguments)};ac.Create=function(az){return new ac()};ac.Destroy=function(az,aA){};ac.prototype.Reset=function(az,aA){this.__super.Reset.call(this,az,aA);u.b2Assert(az.GetType()==aa.e_polygonShape);u.b2Assert(aA.GetType()==aa.e_circleShape)};ac.prototype.Evaluate=function(){var aA=this.m_fixtureA.m_body;var az=this.m_fixtureB.m_body;y.CollidePolygonAndCircle(this.m_manifold,(this.m_fixtureA.GetShape() instanceof am?this.m_fixtureA.GetShape():null),aA.m_xf,(this.m_fixtureB.GetShape() instanceof av?this.m_fixtureB.GetShape():null),az.m_xf)};Box2D.inherit(v,Box2D.Dynamics.Contacts.b2Contact);v.prototype.__super=Box2D.Dynamics.Contacts.b2Contact.prototype;v.b2PolyAndEdgeContact=function(){Box2D.Dynamics.Contacts.b2Contact.b2Contact.apply(this,arguments)};v.Create=function(az){return new v()};v.Destroy=function(az,aA){};v.prototype.Reset=function(az,aA){this.__super.Reset.call(this,az,aA);u.b2Assert(az.GetType()==aa.e_polygonShape);u.b2Assert(aA.GetType()==aa.e_edgeShape)};v.prototype.Evaluate=function(){var aA=this.m_fixtureA.GetBody();var az=this.m_fixtureB.GetBody();this.b2CollidePolyAndEdge(this.m_manifold,(this.m_fixtureA.GetShape() instanceof am?this.m_fixtureA.GetShape():null),aA.m_xf,(this.m_fixtureB.GetShape() instanceof an?this.m_fixtureB.GetShape():null),az.m_xf)};v.prototype.b2CollidePolyAndEdge=function(az,aC,aB,aD,aA){};Box2D.inherit(L,Box2D.Dynamics.Contacts.b2Contact);L.prototype.__super=Box2D.Dynamics.Contacts.b2Contact.prototype;L.b2PolygonContact=function(){Box2D.Dynamics.Contacts.b2Contact.b2Contact.apply(this,arguments)};L.Create=function(az){return new L()};L.Destroy=function(az,aA){};L.prototype.Reset=function(az,aA){this.__super.Reset.call(this,az,aA)};L.prototype.Evaluate=function(){var aA=this.m_fixtureA.GetBody();var az=this.m_fixtureB.GetBody();y.CollidePolygons(this.m_manifold,(this.m_fixtureA.GetShape() instanceof am?this.m_fixtureA.GetShape():null),aA.m_xf,(this.m_fixtureB.GetShape() instanceof am?this.m_fixtureB.GetShape():null),az.m_xf)};ab.b2PositionSolverManifold=function(){};ab.prototype.b2PositionSolverManifold=function(){this.m_normal=new Y();this.m_separations=new Vector_a2j_Number(u.b2_maxManifoldPoints);this.m_points=new Vector(u.b2_maxManifoldPoints);for(var az=0;az<u.b2_maxManifoldPoints;az++){this.m_points[az]=new Y()}};ab.prototype.Initialize=function(aC){u.b2Assert(aC.pointCount>0);var aI=0;var aJ=0;var aH=0;var aN;var aO;var aB=0;var aA=0;switch(aC.type){case H.e_circles:aN=aC.bodyA.m_xf.R;aO=aC.localPoint;var aM=aC.bodyA.m_xf.position.x+(aN.col1.x*aO.x+aN.col2.x*aO.y);var aL=aC.bodyA.m_xf.position.y+(aN.col1.y*aO.x+aN.col2.y*aO.y);aN=aC.bodyB.m_xf.R;aO=aC.points[0].localPoint;var aF=aC.bodyB.m_xf.position.x+(aN.col1.x*aO.x+aN.col2.x*aO.y);var aD=aC.bodyB.m_xf.position.y+(aN.col1.y*aO.x+aN.col2.y*aO.y);var aG=aF-aM;var aE=aD-aL;var az=aG*aG+aE*aE;if(az>Number.MIN_VALUE*Number.MIN_VALUE){var aK=Math.sqrt(az);this.m_normal.x=aG/aK;this.m_normal.y=aE/aK}else{this.m_normal.x=1;this.m_normal.y=0}this.m_points[0].x=0.5*(aM+aF);this.m_points[0].y=0.5*(aL+aD);this.m_separations[0]=aG*this.m_normal.x+aE*this.m_normal.y-aC.radius;break;case H.e_faceA:aN=aC.bodyA.m_xf.R;aO=aC.localPlaneNormal;this.m_normal.x=aN.col1.x*aO.x+aN.col2.x*aO.y;this.m_normal.y=aN.col1.y*aO.x+aN.col2.y*aO.y;aN=aC.bodyA.m_xf.R;aO=aC.localPoint;aB=aC.bodyA.m_xf.position.x+(aN.col1.x*aO.x+aN.col2.x*aO.y);aA=aC.bodyA.m_xf.position.y+(aN.col1.y*aO.x+aN.col2.y*aO.y);aN=aC.bodyB.m_xf.R;for(aI=0;aI<aC.pointCount;++aI){aO=aC.points[aI].localPoint;aJ=aC.bodyB.m_xf.position.x+(aN.col1.x*aO.x+aN.col2.x*aO.y);aH=aC.bodyB.m_xf.position.y+(aN.col1.y*aO.x+aN.col2.y*aO.y);this.m_separations[aI]=(aJ-aB)*this.m_normal.x+(aH-aA)*this.m_normal.y-aC.radius;this.m_points[aI].x=aJ;this.m_points[aI].y=aH}break;case H.e_faceB:aN=aC.bodyB.m_xf.R;aO=aC.localPlaneNormal;this.m_normal.x=aN.col1.x*aO.x+aN.col2.x*aO.y;this.m_normal.y=aN.col1.y*aO.x+aN.col2.y*aO.y;aN=aC.bodyB.m_xf.R;aO=aC.localPoint;aB=aC.bodyB.m_xf.position.x+(aN.col1.x*aO.x+aN.col2.x*aO.y);aA=aC.bodyB.m_xf.position.y+(aN.col1.y*aO.x+aN.col2.y*aO.y);aN=aC.bodyA.m_xf.R;for(aI=0;aI<aC.pointCount;++aI){aO=aC.points[aI].localPoint;aJ=aC.bodyA.m_xf.position.x+(aN.col1.x*aO.x+aN.col2.x*aO.y);aH=aC.bodyA.m_xf.position.y+(aN.col1.y*aO.x+aN.col2.y*aO.y);this.m_separations[aI]=(aJ-aB)*this.m_normal.x+(aH-aA)*this.m_normal.y-aC.radius;this.m_points[aI].Set(aJ,aH)}this.m_normal.x*=(-1);this.m_normal.y*=(-1);break}};Box2D.postDefs.push(function(){Box2D.Dynamics.Contacts.b2PositionSolverManifold.circlePointA=new Y();Box2D.Dynamics.Contacts.b2PositionSolverManifold.circlePointB=new Y()})})();(function(){var k=Box2D.Dynamics.b2Body,u=Box2D.Dynamics.b2BodyDef,G=Box2D.Dynamics.b2ContactFilter,t=Box2D.Dynamics.b2ContactImpulse,y=Box2D.Dynamics.b2ContactListener,B=Box2D.Dynamics.b2ContactManager,l=Box2D.Dynamics.b2DebugDraw,f=Box2D.Dynamics.b2DestructionListener,s=Box2D.Dynamics.b2FilterData,L=Box2D.Dynamics.b2Fixture,p=Box2D.Dynamics.b2FixtureDef,g=Box2D.Dynamics.b2Island,z=Box2D.Dynamics.b2TimeStep,m=Box2D.Dynamics.b2World,w=Box2D.Common.Math.b2Mat22,h=Box2D.Common.Math.b2Mat33,n=Box2D.Common.Math.b2Math,r=Box2D.Common.Math.b2Sweep,e=Box2D.Common.Math.b2Transform,E=Box2D.Common.Math.b2Vec2,D=Box2D.Common.Math.b2Vec3,q=Box2D.Common.b2Color,C=Box2D.Common.b2internal,d=Box2D.Common.b2Settings,x=Box2D.Collision.Shapes.b2CircleShape,I=Box2D.Collision.Shapes.b2EdgeChainDef,K=Box2D.Collision.Shapes.b2EdgeShape,A=Box2D.Collision.Shapes.b2MassData,o=Box2D.Collision.Shapes.b2PolygonShape,j=Box2D.Collision.Shapes.b2Shape,b=Box2D.Dynamics.Controllers.b2BuoyancyController,H=Box2D.Dynamics.Controllers.b2ConstantAccelController,a=Box2D.Dynamics.Controllers.b2ConstantForceController,J=Box2D.Dynamics.Controllers.b2Controller,c=Box2D.Dynamics.Controllers.b2ControllerEdge,v=Box2D.Dynamics.Controllers.b2GravityController,F=Box2D.Dynamics.Controllers.b2TensorDampingController;Box2D.inherit(b,Box2D.Dynamics.Controllers.b2Controller);b.prototype.__super=Box2D.Dynamics.Controllers.b2Controller.prototype;b.b2BuoyancyController=function(){Box2D.Dynamics.Controllers.b2Controller.b2Controller.apply(this,arguments);this.normal=new E(0,(-1));this.offset=0;this.density=0;this.velocity=new E(0,0);this.linearDrag=2;this.angularDrag=1;this.useDensity=false;this.useWorldGravity=true;this.gravity=null};b.prototype.Step=function(O){if(!this.m_bodyList){return}if(this.useWorldGravity){this.gravity=this.GetWorld().GetGravity().Copy()}for(var R=this.m_bodyList;R;R=R.nextBody){var T=R.body;if(T.IsAwake()==false){continue}var W=new E();var Y=new E();var N=0;var U=0;for(var P=T.GetFixtureList();P;P=P.GetNext()){var V=new E();var M=P.GetShape().ComputeSubmergedArea(this.normal,this.offset,T.GetTransform(),V);N+=M;W.x+=M*V.x;W.y+=M*V.y;var Q=0;if(this.useDensity){Q=1}else{Q=1}U+=M*Q;Y.x+=M*V.x*Q;Y.y+=M*V.y*Q}W.x/=N;W.y/=N;Y.x/=U;Y.y/=U;if(N<Number.MIN_VALUE){continue}var S=this.gravity.GetNegative();S.Multiply(this.density*N);T.ApplyForce(S,Y);var X=T.GetLinearVelocityFromWorldPoint(W);X.Subtract(this.velocity);X.Multiply((-this.linearDrag*N));T.ApplyForce(X,W);T.ApplyTorque((-T.GetInertia()/T.GetMass()*N*T.GetAngularVelocity()*this.angularDrag))}};b.prototype.Draw=function(Q){var N=1000;var P=new E();var O=new E();P.x=this.normal.x*this.offset+this.normal.y*N;P.y=this.normal.y*this.offset-this.normal.x*N;O.x=this.normal.x*this.offset-this.normal.y*N;O.y=this.normal.y*this.offset+this.normal.x*N;var M=new q(0,0,1);Q.DrawSegment(P,O,M)};Box2D.inherit(H,Box2D.Dynamics.Controllers.b2Controller);H.prototype.__super=Box2D.Dynamics.Controllers.b2Controller.prototype;H.b2ConstantAccelController=function(){Box2D.Dynamics.Controllers.b2Controller.b2Controller.apply(this,arguments);this.A=new E(0,0)};H.prototype.Step=function(P){var N=new E(this.A.x*P.dt,this.A.y*P.dt);for(var O=this.m_bodyList;O;O=O.nextBody){var M=O.body;if(!M.IsAwake()){continue}M.SetLinearVelocity(new E(M.GetLinearVelocity().x+N.x,M.GetLinearVelocity().y+N.y))}};Box2D.inherit(a,Box2D.Dynamics.Controllers.b2Controller);a.prototype.__super=Box2D.Dynamics.Controllers.b2Controller.prototype;a.b2ConstantForceController=function(){Box2D.Dynamics.Controllers.b2Controller.b2Controller.apply(this,arguments);this.F=new E(0,0)};a.prototype.Step=function(O){for(var N=this.m_bodyList;N;N=N.nextBody){var M=N.body;if(!M.IsAwake()){continue}M.ApplyForce(this.F,M.GetWorldCenter())}};J.b2Controller=function(){};J.prototype.Step=function(M){};J.prototype.Draw=function(M){};J.prototype.AddBody=function(M){var N=new c();N.controller=this;N.body=M;N.nextBody=this.m_bodyList;N.prevBody=null;this.m_bodyList=N;if(N.nextBody){N.nextBody.prevBody=N}this.m_bodyCount++;N.nextController=M.m_controllerList;N.prevController=null;M.m_controllerList=N;if(N.nextController){N.nextController.prevController=N}M.m_controllerCount++};J.prototype.RemoveBody=function(M){var N=M.m_controllerList;while(N&&N.controller!=this){N=N.nextController}if(N.prevBody){N.prevBody.nextBody=N.nextBody}if(N.nextBody){N.nextBody.prevBody=N.prevBody}if(N.nextController){N.nextController.prevController=N.prevController}if(N.prevController){N.prevController.nextController=N.nextController}if(this.m_bodyList==N){this.m_bodyList=N.nextBody}if(M.m_controllerList==N){M.m_controllerList=N.nextController}M.m_controllerCount--;this.m_bodyCount--};J.prototype.Clear=function(){while(this.m_bodyList){this.RemoveBody(this.m_bodyList.body)}};J.prototype.GetNext=function(){return this.m_next};J.prototype.GetWorld=function(){return this.m_world};J.prototype.GetBodyList=function(){return this.m_bodyList};c.b2ControllerEdge=function(){};Box2D.inherit(v,Box2D.Dynamics.Controllers.b2Controller);v.prototype.__super=Box2D.Dynamics.Controllers.b2Controller.prototype;v.b2GravityController=function(){Box2D.Dynamics.Controllers.b2Controller.b2Controller.apply(this,arguments);this.G=1;this.invSqr=true};v.prototype.Step=function(P){var R=null;var M=null;var U=null;var N=0;var Q=null;var X=null;var T=null;var W=0;var V=0;var O=0;var S=null;if(this.invSqr){for(R=this.m_bodyList;R;R=R.nextBody){M=R.body;U=M.GetWorldCenter();N=M.GetMass();for(Q=this.m_bodyList;Q!=R;Q=Q.nextBody){X=Q.body;T=X.GetWorldCenter();W=T.x-U.x;V=T.y-U.y;O=W*W+V*V;if(O<Number.MIN_VALUE){continue}S=new E(W,V);S.Multiply(this.G/O/Math.sqrt(O)*N*X.GetMass());if(M.IsAwake()){M.ApplyForce(S,U)}S.Multiply((-1));if(X.IsAwake()){X.ApplyForce(S,T)}}}}else{for(R=this.m_bodyList;R;R=R.nextBody){M=R.body;U=M.GetWorldCenter();N=M.GetMass();for(Q=this.m_bodyList;Q!=R;Q=Q.nextBody){X=Q.body;T=X.GetWorldCenter();W=T.x-U.x;V=T.y-U.y;O=W*W+V*V;if(O<Number.MIN_VALUE){continue}S=new E(W,V);S.Multiply(this.G/O*N*X.GetMass());if(M.IsAwake()){M.ApplyForce(S,U)}S.Multiply((-1));if(X.IsAwake()){X.ApplyForce(S,T)}}}}};Box2D.inherit(F,Box2D.Dynamics.Controllers.b2Controller);F.prototype.__super=Box2D.Dynamics.Controllers.b2Controller.prototype;F.b2TensorDampingController=function(){Box2D.Dynamics.Controllers.b2Controller.b2Controller.apply(this,arguments);this.T=new w();this.maxTimestep=0};F.prototype.SetAxisAligned=function(N,M){if(N===undefined){N=0}if(M===undefined){M=0}this.T.col1.x=(-N);this.T.col1.y=0;this.T.col2.x=0;this.T.col2.y=(-M);if(N>0||M>0){this.maxTimestep=1/Math.max(N,M)}else{this.maxTimestep=0}};F.prototype.Step=function(Q){var N=Q.dt;if(N<=Number.MIN_VALUE){return}if(N>this.maxTimestep&&this.maxTimestep>0){N=this.maxTimestep}for(var P=this.m_bodyList;P;P=P.nextBody){var M=P.body;if(!M.IsAwake()){continue}var O=M.GetWorldVector(n.MulMV(this.T,M.GetLocalVector(M.GetLinearVelocity())));M.SetLinearVelocity(new E(M.GetLinearVelocity().x+O.x*N,M.GetLinearVelocity().y+O.y*N))}}})();(function(){var w=Box2D.Common.b2Color,M=Box2D.Common.b2internal,c=Box2D.Common.b2Settings,H=Box2D.Common.Math.b2Mat22,m=Box2D.Common.Math.b2Mat33,t=Box2D.Common.Math.b2Math,x=Box2D.Common.Math.b2Sweep,k=Box2D.Common.Math.b2Transform,P=Box2D.Common.Math.b2Vec2,O=Box2D.Common.Math.b2Vec3,s=Box2D.Dynamics.Joints.b2DistanceJoint,S=Box2D.Dynamics.Joints.b2DistanceJointDef,b=Box2D.Dynamics.Joints.b2FrictionJoint,A=Box2D.Dynamics.Joints.b2FrictionJointDef,B=Box2D.Dynamics.Joints.b2GearJoint,C=Box2D.Dynamics.Joints.b2GearJointDef,N=Box2D.Dynamics.Joints.b2Jacobian,j=Box2D.Dynamics.Joints.b2Joint,I=Box2D.Dynamics.Joints.b2JointDef,Q=Box2D.Dynamics.Joints.b2JointEdge,n=Box2D.Dynamics.Joints.b2LineJoint,g=Box2D.Dynamics.Joints.b2LineJointDef,G=Box2D.Dynamics.Joints.b2MouseJoint,d=Box2D.Dynamics.Joints.b2MouseJointDef,o=Box2D.Dynamics.Joints.b2PrismaticJoint,v=Box2D.Dynamics.Joints.b2PrismaticJointDef,f=Box2D.Dynamics.Joints.b2PulleyJoint,T=Box2D.Dynamics.Joints.b2PulleyJointDef,F=Box2D.Dynamics.Joints.b2RevoluteJoint,a=Box2D.Dynamics.Joints.b2RevoluteJointDef,e=Box2D.Dynamics.Joints.b2WeldJoint,z=Box2D.Dynamics.Joints.b2WeldJointDef,p=Box2D.Dynamics.b2Body,E=Box2D.Dynamics.b2BodyDef,R=Box2D.Dynamics.b2ContactFilter,D=Box2D.Dynamics.b2ContactImpulse,J=Box2D.Dynamics.b2ContactListener,L=Box2D.Dynamics.b2ContactManager,r=Box2D.Dynamics.b2DebugDraw,h=Box2D.Dynamics.b2DestructionListener,y=Box2D.Dynamics.b2FilterData,U=Box2D.Dynamics.b2Fixture,u=Box2D.Dynamics.b2FixtureDef,l=Box2D.Dynamics.b2Island,K=Box2D.Dynamics.b2TimeStep,q=Box2D.Dynamics.b2World;Box2D.inherit(s,Box2D.Dynamics.Joints.b2Joint);s.prototype.__super=Box2D.Dynamics.Joints.b2Joint.prototype;s.b2DistanceJoint=function(){Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments);this.m_localAnchor1=new P();this.m_localAnchor2=new P();this.m_u=new P()};s.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchor1)};s.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchor2)};s.prototype.GetReactionForce=function(V){if(V===undefined){V=0}return new P(V*this.m_impulse*this.m_u.x,V*this.m_impulse*this.m_u.y)};s.prototype.GetReactionTorque=function(V){if(V===undefined){V=0}return 0};s.prototype.GetLength=function(){return this.m_length};s.prototype.SetLength=function(V){if(V===undefined){V=0}this.m_length=V};s.prototype.GetFrequency=function(){return this.m_frequencyHz};s.prototype.SetFrequency=function(V){if(V===undefined){V=0}this.m_frequencyHz=V};s.prototype.GetDampingRatio=function(){return this.m_dampingRatio};s.prototype.SetDampingRatio=function(V){if(V===undefined){V=0}this.m_dampingRatio=V};s.prototype.b2DistanceJoint=function(X){this.__super.b2Joint.call(this,X);var W;var V=0;var Y=0;this.m_localAnchor1.SetV(X.localAnchorA);this.m_localAnchor2.SetV(X.localAnchorB);this.m_length=X.length;this.m_frequencyHz=X.frequencyHz;this.m_dampingRatio=X.dampingRatio;this.m_impulse=0;this.m_gamma=0;this.m_bias=0};s.prototype.InitVelocityConstraints=function(Y){var ac;var af=0;var am=this.m_bodyA;var al=this.m_bodyB;ac=am.m_xf.R;var ai=this.m_localAnchor1.x-am.m_sweep.localCenter.x;var ah=this.m_localAnchor1.y-am.m_sweep.localCenter.y;af=(ac.col1.x*ai+ac.col2.x*ah);ah=(ac.col1.y*ai+ac.col2.y*ah);ai=af;ac=al.m_xf.R;var X=this.m_localAnchor2.x-al.m_sweep.localCenter.x;var V=this.m_localAnchor2.y-al.m_sweep.localCenter.y;af=(ac.col1.x*X+ac.col2.x*V);V=(ac.col1.y*X+ac.col2.y*V);X=af;this.m_u.x=al.m_sweep.c.x+X-am.m_sweep.c.x-ai;this.m_u.y=al.m_sweep.c.y+V-am.m_sweep.c.y-ah;var W=Math.sqrt(this.m_u.x*this.m_u.x+this.m_u.y*this.m_u.y);if(W>c.b2_linearSlop){this.m_u.Multiply(1/W)}else{this.m_u.SetZero()}var an=(ai*this.m_u.y-ah*this.m_u.x);var aa=(X*this.m_u.y-V*this.m_u.x);var ak=am.m_invMass+am.m_invI*an*an+al.m_invMass+al.m_invI*aa*aa;this.m_mass=ak!=0?1/ak:0;if(this.m_frequencyHz>0){var ad=W-this.m_length;var ae=2*Math.PI*this.m_frequencyHz;var aj=2*this.m_mass*this.m_dampingRatio*ae;var ag=this.m_mass*ae*ae;this.m_gamma=Y.dt*(aj+Y.dt*ag);this.m_gamma=this.m_gamma!=0?1/this.m_gamma:0;this.m_bias=ad*Y.dt*ag*this.m_gamma;this.m_mass=ak+this.m_gamma;this.m_mass=this.m_mass!=0?1/this.m_mass:0}if(Y.warmStarting){this.m_impulse*=Y.dtRatio;var ab=this.m_impulse*this.m_u.x;var Z=this.m_impulse*this.m_u.y;am.m_linearVelocity.x-=am.m_invMass*ab;am.m_linearVelocity.y-=am.m_invMass*Z;am.m_angularVelocity-=am.m_invI*(ai*Z-ah*ab);al.m_linearVelocity.x+=al.m_invMass*ab;al.m_linearVelocity.y+=al.m_invMass*Z;al.m_angularVelocity+=al.m_invI*(X*Z-V*ab)}else{this.m_impulse=0}};s.prototype.SolveVelocityConstraints=function(Y){var ag;var W=this.m_bodyA;var V=this.m_bodyB;ag=W.m_xf.R;var al=this.m_localAnchor1.x-W.m_sweep.localCenter.x;var ak=this.m_localAnchor1.y-W.m_sweep.localCenter.y;var aj=(ag.col1.x*al+ag.col2.x*ak);ak=(ag.col1.y*al+ag.col2.y*ak);al=aj;ag=V.m_xf.R;var ae=this.m_localAnchor2.x-V.m_sweep.localCenter.x;var ad=this.m_localAnchor2.y-V.m_sweep.localCenter.y;aj=(ag.col1.x*ae+ag.col2.x*ad);ad=(ag.col1.y*ae+ag.col2.y*ad);ae=aj;var ai=W.m_linearVelocity.x+((-W.m_angularVelocity*ak));var ah=W.m_linearVelocity.y+(W.m_angularVelocity*al);var ac=V.m_linearVelocity.x+((-V.m_angularVelocity*ad));var ab=V.m_linearVelocity.y+(V.m_angularVelocity*ae);var af=(this.m_u.x*(ac-ai)+this.m_u.y*(ab-ah));var X=(-this.m_mass*(af+this.m_bias+this.m_gamma*this.m_impulse));this.m_impulse+=X;var aa=X*this.m_u.x;var Z=X*this.m_u.y;W.m_linearVelocity.x-=W.m_invMass*aa;W.m_linearVelocity.y-=W.m_invMass*Z;W.m_angularVelocity-=W.m_invI*(al*Z-ak*aa);V.m_linearVelocity.x+=V.m_invMass*aa;V.m_linearVelocity.y+=V.m_invMass*Z;V.m_angularVelocity+=V.m_invI*(ae*Z-ad*aa)};s.prototype.SolvePositionConstraints=function(ah){if(ah===undefined){ah=0}var ag;if(this.m_frequencyHz>0){return true}var X=this.m_bodyA;var V=this.m_bodyB;ag=X.m_xf.R;var ak=this.m_localAnchor1.x-X.m_sweep.localCenter.x;var aj=this.m_localAnchor1.y-X.m_sweep.localCenter.y;var ai=(ag.col1.x*ak+ag.col2.x*aj);aj=(ag.col1.y*ak+ag.col2.y*aj);ak=ai;ag=V.m_xf.R;var af=this.m_localAnchor2.x-V.m_sweep.localCenter.x;var ae=this.m_localAnchor2.y-V.m_sweep.localCenter.y;ai=(ag.col1.x*af+ag.col2.x*ae);ae=(ag.col1.y*af+ag.col2.y*ae);af=ai;var ad=V.m_sweep.c.x+af-X.m_sweep.c.x-ak;var ac=V.m_sweep.c.y+ae-X.m_sweep.c.y-aj;var Z=Math.sqrt(ad*ad+ac*ac);ad/=Z;ac/=Z;var W=Z-this.m_length;W=t.Clamp(W,(-c.b2_maxLinearCorrection),c.b2_maxLinearCorrection);var Y=(-this.m_mass*W);this.m_u.Set(ad,ac);var ab=Y*this.m_u.x;var aa=Y*this.m_u.y;X.m_sweep.c.x-=X.m_invMass*ab;X.m_sweep.c.y-=X.m_invMass*aa;X.m_sweep.a-=X.m_invI*(ak*aa-aj*ab);V.m_sweep.c.x+=V.m_invMass*ab;V.m_sweep.c.y+=V.m_invMass*aa;V.m_sweep.a+=V.m_invI*(af*aa-ae*ab);X.SynchronizeTransform();V.SynchronizeTransform();return t.Abs(W)<c.b2_linearSlop};Box2D.inherit(S,Box2D.Dynamics.Joints.b2JointDef);S.prototype.__super=Box2D.Dynamics.Joints.b2JointDef.prototype;S.b2DistanceJointDef=function(){Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments);this.localAnchorA=new P();this.localAnchorB=new P()};S.prototype.b2DistanceJointDef=function(){this.__super.b2JointDef.call(this);this.type=j.e_distanceJoint;this.length=1;this.frequencyHz=0;this.dampingRatio=0};S.prototype.Initialize=function(aa,Z,Y,W){this.bodyA=aa;this.bodyB=Z;this.localAnchorA.SetV(this.bodyA.GetLocalPoint(Y));this.localAnchorB.SetV(this.bodyB.GetLocalPoint(W));var X=W.x-Y.x;var V=W.y-Y.y;this.length=Math.sqrt(X*X+V*V);this.frequencyHz=0;this.dampingRatio=0};Box2D.inherit(b,Box2D.Dynamics.Joints.b2Joint);b.prototype.__super=Box2D.Dynamics.Joints.b2Joint.prototype;b.b2FrictionJoint=function(){Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments);this.m_localAnchorA=new P();this.m_localAnchorB=new P();this.m_linearMass=new H();this.m_linearImpulse=new P()};b.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA)};b.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB)};b.prototype.GetReactionForce=function(V){if(V===undefined){V=0}return new P(V*this.m_linearImpulse.x,V*this.m_linearImpulse.y)};b.prototype.GetReactionTorque=function(V){if(V===undefined){V=0}return V*this.m_angularImpulse};b.prototype.SetMaxForce=function(V){if(V===undefined){V=0}this.m_maxForce=V};b.prototype.GetMaxForce=function(){return this.m_maxForce};b.prototype.SetMaxTorque=function(V){if(V===undefined){V=0}this.m_maxTorque=V};b.prototype.GetMaxTorque=function(){return this.m_maxTorque};b.prototype.b2FrictionJoint=function(V){this.__super.b2Joint.call(this,V);this.m_localAnchorA.SetV(V.localAnchorA);this.m_localAnchorB.SetV(V.localAnchorB);this.m_linearMass.SetZero();this.m_angularMass=0;this.m_linearImpulse.SetZero();this.m_angularImpulse=0;this.m_maxForce=V.maxForce;this.m_maxTorque=V.maxTorque};b.prototype.InitVelocityConstraints=function(Y){var af;var ah=0;var W=this.m_bodyA;var V=this.m_bodyB;af=W.m_xf.R;var ab=this.m_localAnchorA.x-W.m_sweep.localCenter.x;var aa=this.m_localAnchorA.y-W.m_sweep.localCenter.y;ah=(af.col1.x*ab+af.col2.x*aa);aa=(af.col1.y*ab+af.col2.y*aa);ab=ah;af=V.m_xf.R;var aj=this.m_localAnchorB.x-V.m_sweep.localCenter.x;var ai=this.m_localAnchorB.y-V.m_sweep.localCenter.y;ah=(af.col1.x*aj+af.col2.x*ai);ai=(af.col1.y*aj+af.col2.y*ai);aj=ah;var Z=W.m_invMass;var X=V.m_invMass;var ae=W.m_invI;var ad=V.m_invI;var ag=new H();ag.col1.x=Z+X;ag.col2.x=0;ag.col1.y=0;ag.col2.y=Z+X;ag.col1.x+=ae*aa*aa;ag.col2.x+=(-ae*ab*aa);ag.col1.y+=(-ae*ab*aa);ag.col2.y+=ae*ab*ab;ag.col1.x+=ad*ai*ai;ag.col2.x+=(-ad*aj*ai);ag.col1.y+=(-ad*aj*ai);ag.col2.y+=ad*aj*aj;ag.GetInverse(this.m_linearMass);this.m_angularMass=ae+ad;if(this.m_angularMass>0){this.m_angularMass=1/this.m_angularMass}if(Y.warmStarting){this.m_linearImpulse.x*=Y.dtRatio;this.m_linearImpulse.y*=Y.dtRatio;this.m_angularImpulse*=Y.dtRatio;var ac=this.m_linearImpulse;W.m_linearVelocity.x-=Z*ac.x;W.m_linearVelocity.y-=Z*ac.y;W.m_angularVelocity-=ae*(ab*ac.y-aa*ac.x+this.m_angularImpulse);V.m_linearVelocity.x+=X*ac.x;V.m_linearVelocity.y+=X*ac.y;V.m_angularVelocity+=ad*(aj*ac.y-ai*ac.x+this.m_angularImpulse)}else{this.m_linearImpulse.SetZero();this.m_angularImpulse=0}};b.prototype.SolveVelocityConstraints=function(ac){var ah;var ak=0;var au=this.m_bodyA;var at=this.m_bodyB;var ar=au.m_linearVelocity;var X=au.m_angularVelocity;var aq=at.m_linearVelocity;var W=at.m_angularVelocity;var ap=au.m_invMass;var ao=at.m_invMass;var af=au.m_invI;var ae=at.m_invI;ah=au.m_xf.R;var ad=this.m_localAnchorA.x-au.m_sweep.localCenter.x;var ab=this.m_localAnchorA.y-au.m_sweep.localCenter.y;ak=(ah.col1.x*ad+ah.col2.x*ab);ab=(ah.col1.y*ad+ah.col2.y*ab);ad=ak;ah=at.m_xf.R;var am=this.m_localAnchorB.x-at.m_sweep.localCenter.x;var al=this.m_localAnchorB.y-at.m_sweep.localCenter.y;ak=(ah.col1.x*am+ah.col2.x*al);al=(ah.col1.y*am+ah.col2.y*al);am=ak;var ai=0;var aj=W-X;var ag=(-this.m_angularMass*aj);var Z=this.m_angularImpulse;ai=ac.dt*this.m_maxTorque;this.m_angularImpulse=t.Clamp(this.m_angularImpulse+ag,(-ai),ai);ag=this.m_angularImpulse-Z;X-=af*ag;W+=ae*ag;var aa=aq.x-W*al-ar.x+X*ab;var Y=aq.y+W*am-ar.y-X*ad;var V=t.MulMV(this.m_linearMass,new P((-aa),(-Y)));var an=this.m_linearImpulse.Copy();this.m_linearImpulse.Add(V);ai=ac.dt*this.m_maxForce;if(this.m_linearImpulse.LengthSquared()>ai*ai){this.m_linearImpulse.Normalize();this.m_linearImpulse.Multiply(ai)}V=t.SubtractVV(this.m_linearImpulse,an);ar.x-=ap*V.x;ar.y-=ap*V.y;X-=af*(ad*V.y-ab*V.x);aq.x+=ao*V.x;aq.y+=ao*V.y;W+=ae*(am*V.y-al*V.x);au.m_angularVelocity=X;at.m_angularVelocity=W};b.prototype.SolvePositionConstraints=function(V){if(V===undefined){V=0}return true};Box2D.inherit(A,Box2D.Dynamics.Joints.b2JointDef);A.prototype.__super=Box2D.Dynamics.Joints.b2JointDef.prototype;A.b2FrictionJointDef=function(){Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments);this.localAnchorA=new P();this.localAnchorB=new P()};A.prototype.b2FrictionJointDef=function(){this.__super.b2JointDef.call(this);this.type=j.e_frictionJoint;this.maxForce=0;this.maxTorque=0};A.prototype.Initialize=function(X,W,V){this.bodyA=X;this.bodyB=W;this.localAnchorA.SetV(this.bodyA.GetLocalPoint(V));this.localAnchorB.SetV(this.bodyB.GetLocalPoint(V))};Box2D.inherit(B,Box2D.Dynamics.Joints.b2Joint);B.prototype.__super=Box2D.Dynamics.Joints.b2Joint.prototype;B.b2GearJoint=function(){Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments);this.m_groundAnchor1=new P();this.m_groundAnchor2=new P();this.m_localAnchor1=new P();this.m_localAnchor2=new P();this.m_J=new N()};B.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchor1)};B.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchor2)};B.prototype.GetReactionForce=function(V){if(V===undefined){V=0}return new P(V*this.m_impulse*this.m_J.linearB.x,V*this.m_impulse*this.m_J.linearB.y)};B.prototype.GetReactionTorque=function(Z){if(Z===undefined){Z=0}var X=this.m_bodyB.m_xf.R;var ab=this.m_localAnchor1.x-this.m_bodyB.m_sweep.localCenter.x;var aa=this.m_localAnchor1.y-this.m_bodyB.m_sweep.localCenter.y;var V=X.col1.x*ab+X.col2.x*aa;aa=X.col1.y*ab+X.col2.y*aa;ab=V;var Y=this.m_impulse*this.m_J.linearB.x;var W=this.m_impulse*this.m_J.linearB.y;return Z*(this.m_impulse*this.m_J.angularB-ab*W+aa*Y)};B.prototype.GetRatio=function(){return this.m_ratio};B.prototype.SetRatio=function(V){if(V===undefined){V=0}this.m_ratio=V};B.prototype.b2GearJoint=function(X){this.__super.b2Joint.call(this,X);var W=parseInt(X.joint1.m_type);var V=parseInt(X.joint2.m_type);this.m_revolute1=null;this.m_prismatic1=null;this.m_revolute2=null;this.m_prismatic2=null;var Z=0;var Y=0;this.m_ground1=X.joint1.GetBodyA();this.m_bodyA=X.joint1.GetBodyB();if(W==j.e_revoluteJoint){this.m_revolute1=(X.joint1 instanceof F?X.joint1:null);this.m_groundAnchor1.SetV(this.m_revolute1.m_localAnchor1);this.m_localAnchor1.SetV(this.m_revolute1.m_localAnchor2);Z=this.m_revolute1.GetJointAngle()}else{this.m_prismatic1=(X.joint1 instanceof o?X.joint1:null);this.m_groundAnchor1.SetV(this.m_prismatic1.m_localAnchor1);this.m_localAnchor1.SetV(this.m_prismatic1.m_localAnchor2);Z=this.m_prismatic1.GetJointTranslation()}this.m_ground2=X.joint2.GetBodyA();this.m_bodyB=X.joint2.GetBodyB();if(V==j.e_revoluteJoint){this.m_revolute2=(X.joint2 instanceof F?X.joint2:null);this.m_groundAnchor2.SetV(this.m_revolute2.m_localAnchor1);this.m_localAnchor2.SetV(this.m_revolute2.m_localAnchor2);Y=this.m_revolute2.GetJointAngle()}else{this.m_prismatic2=(X.joint2 instanceof o?X.joint2:null);this.m_groundAnchor2.SetV(this.m_prismatic2.m_localAnchor1);this.m_localAnchor2.SetV(this.m_prismatic2.m_localAnchor2);Y=this.m_prismatic2.GetJointTranslation()}this.m_ratio=X.ratio;this.m_constant=Z+this.m_ratio*Y;this.m_impulse=0};B.prototype.InitVelocityConstraints=function(Y){var W=this.m_ground1;var ai=this.m_ground2;var X=this.m_bodyA;var V=this.m_bodyB;var af=0;var ad=0;var aa=0;var Z=0;var ab;var ah;var ae=0;var ag=0;var ac=0;this.m_J.SetZero();if(this.m_revolute1){this.m_J.angularA=(-1);ac+=X.m_invI}else{ab=W.m_xf.R;ah=this.m_prismatic1.m_localXAxis1;af=ab.col1.x*ah.x+ab.col2.x*ah.y;ad=ab.col1.y*ah.x+ab.col2.y*ah.y;ab=X.m_xf.R;aa=this.m_localAnchor1.x-X.m_sweep.localCenter.x;Z=this.m_localAnchor1.y-X.m_sweep.localCenter.y;ag=ab.col1.x*aa+ab.col2.x*Z;Z=ab.col1.y*aa+ab.col2.y*Z;aa=ag;ae=aa*ad-Z*af;this.m_J.linearA.Set((-af),(-ad));this.m_J.angularA=(-ae);ac+=X.m_invMass+X.m_invI*ae*ae}if(this.m_revolute2){this.m_J.angularB=(-this.m_ratio);ac+=this.m_ratio*this.m_ratio*V.m_invI}else{ab=ai.m_xf.R;ah=this.m_prismatic2.m_localXAxis1;af=ab.col1.x*ah.x+ab.col2.x*ah.y;ad=ab.col1.y*ah.x+ab.col2.y*ah.y;ab=V.m_xf.R;aa=this.m_localAnchor2.x-V.m_sweep.localCenter.x;Z=this.m_localAnchor2.y-V.m_sweep.localCenter.y;ag=ab.col1.x*aa+ab.col2.x*Z;Z=ab.col1.y*aa+ab.col2.y*Z;aa=ag;ae=aa*ad-Z*af;this.m_J.linearB.Set((-this.m_ratio*af),(-this.m_ratio*ad));this.m_J.angularB=(-this.m_ratio*ae);ac+=this.m_ratio*this.m_ratio*(V.m_invMass+V.m_invI*ae*ae)}this.m_mass=ac>0?1/ac:0;if(Y.warmStarting){X.m_linearVelocity.x+=X.m_invMass*this.m_impulse*this.m_J.linearA.x;X.m_linearVelocity.y+=X.m_invMass*this.m_impulse*this.m_J.linearA.y;X.m_angularVelocity+=X.m_invI*this.m_impulse*this.m_J.angularA;V.m_linearVelocity.x+=V.m_invMass*this.m_impulse*this.m_J.linearB.x;V.m_linearVelocity.y+=V.m_invMass*this.m_impulse*this.m_J.linearB.y;V.m_angularVelocity+=V.m_invI*this.m_impulse*this.m_J.angularB}else{this.m_impulse=0}};B.prototype.SolveVelocityConstraints=function(V){var Y=this.m_bodyA;var X=this.m_bodyB;var Z=this.m_J.Compute(Y.m_linearVelocity,Y.m_angularVelocity,X.m_linearVelocity,X.m_angularVelocity);var W=(-this.m_mass*Z);this.m_impulse+=W;Y.m_linearVelocity.x+=Y.m_invMass*W*this.m_J.linearA.x;Y.m_linearVelocity.y+=Y.m_invMass*W*this.m_J.linearA.y;Y.m_angularVelocity+=Y.m_invI*W*this.m_J.angularA;X.m_linearVelocity.x+=X.m_invMass*W*this.m_J.linearB.x;X.m_linearVelocity.y+=X.m_invMass*W*this.m_J.linearB.y;X.m_angularVelocity+=X.m_invI*W*this.m_J.angularB};B.prototype.SolvePositionConstraints=function(V){if(V===undefined){V=0}var ac=0;var ab=this.m_bodyA;var Y=this.m_bodyB;var aa=0;var X=0;if(this.m_revolute1){aa=this.m_revolute1.GetJointAngle()}else{aa=this.m_prismatic1.GetJointTranslation()}if(this.m_revolute2){X=this.m_revolute2.GetJointAngle()}else{X=this.m_prismatic2.GetJointTranslation()}var Z=this.m_constant-(aa+this.m_ratio*X);var W=(-this.m_mass*Z);ab.m_sweep.c.x+=ab.m_invMass*W*this.m_J.linearA.x;ab.m_sweep.c.y+=ab.m_invMass*W*this.m_J.linearA.y;ab.m_sweep.a+=ab.m_invI*W*this.m_J.angularA;Y.m_sweep.c.x+=Y.m_invMass*W*this.m_J.linearB.x;Y.m_sweep.c.y+=Y.m_invMass*W*this.m_J.linearB.y;Y.m_sweep.a+=Y.m_invI*W*this.m_J.angularB;ab.SynchronizeTransform();Y.SynchronizeTransform();return ac<c.b2_linearSlop};Box2D.inherit(C,Box2D.Dynamics.Joints.b2JointDef);C.prototype.__super=Box2D.Dynamics.Joints.b2JointDef.prototype;C.b2GearJointDef=function(){Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments)};C.prototype.b2GearJointDef=function(){this.__super.b2JointDef.call(this);this.type=j.e_gearJoint;this.joint1=null;this.joint2=null;this.ratio=1};N.b2Jacobian=function(){this.linearA=new P();this.linearB=new P()};N.prototype.SetZero=function(){this.linearA.SetZero();this.angularA=0;this.linearB.SetZero();this.angularB=0};N.prototype.Set=function(Y,W,X,V){if(W===undefined){W=0}if(V===undefined){V=0}this.linearA.SetV(Y);this.angularA=W;this.linearB.SetV(X);this.angularB=V};N.prototype.Compute=function(Y,W,X,V){if(W===undefined){W=0}if(V===undefined){V=0}return(this.linearA.x*Y.x+this.linearA.y*Y.y)+this.angularA*W+(this.linearB.x*X.x+this.linearB.y*X.y)+this.angularB*V};j.b2Joint=function(){this.m_edgeA=new Q();this.m_edgeB=new Q();this.m_localCenterA=new P();this.m_localCenterB=new P()};j.prototype.GetType=function(){return this.m_type};j.prototype.GetAnchorA=function(){return null};j.prototype.GetAnchorB=function(){return null};j.prototype.GetReactionForce=function(V){if(V===undefined){V=0}return null};j.prototype.GetReactionTorque=function(V){if(V===undefined){V=0}return 0};j.prototype.GetBodyA=function(){return this.m_bodyA};j.prototype.GetBodyB=function(){return this.m_bodyB};j.prototype.GetNext=function(){return this.m_next};j.prototype.GetUserData=function(){return this.m_userData};j.prototype.SetUserData=function(V){this.m_userData=V};j.prototype.IsActive=function(){return this.m_bodyA.IsActive()&&this.m_bodyB.IsActive()};j.Create=function(W,V){var X=null;switch(W.type){case j.e_distanceJoint:X=new s((W instanceof S?W:null));break;case j.e_mouseJoint:X=new G((W instanceof d?W:null));break;case j.e_prismaticJoint:X=new o((W instanceof v?W:null));break;case j.e_revoluteJoint:X=new F((W instanceof a?W:null));break;case j.e_pulleyJoint:X=new f((W instanceof T?W:null));break;case j.e_gearJoint:X=new B((W instanceof C?W:null));break;case j.e_lineJoint:X=new n((W instanceof g?W:null));break;case j.e_weldJoint:X=new e((W instanceof z?W:null));break;case j.e_frictionJoint:X=new b((W instanceof A?W:null));break;default:break}return X};j.Destroy=function(W,V){};j.prototype.b2Joint=function(V){c.b2Assert(V.bodyA!=V.bodyB);this.m_type=V.type;this.m_prev=null;this.m_next=null;this.m_bodyA=V.bodyA;this.m_bodyB=V.bodyB;this.m_collideConnected=V.collideConnected;this.m_islandFlag=false;this.m_userData=V.userData};j.prototype.InitVelocityConstraints=function(V){};j.prototype.SolveVelocityConstraints=function(V){};j.prototype.FinalizeVelocityConstraints=function(){};j.prototype.SolvePositionConstraints=function(V){if(V===undefined){V=0}return false};Box2D.postDefs.push(function(){Box2D.Dynamics.Joints.b2Joint.e_unknownJoint=0;Box2D.Dynamics.Joints.b2Joint.e_revoluteJoint=1;Box2D.Dynamics.Joints.b2Joint.e_prismaticJoint=2;Box2D.Dynamics.Joints.b2Joint.e_distanceJoint=3;Box2D.Dynamics.Joints.b2Joint.e_pulleyJoint=4;Box2D.Dynamics.Joints.b2Joint.e_mouseJoint=5;Box2D.Dynamics.Joints.b2Joint.e_gearJoint=6;Box2D.Dynamics.Joints.b2Joint.e_lineJoint=7;Box2D.Dynamics.Joints.b2Joint.e_weldJoint=8;Box2D.Dynamics.Joints.b2Joint.e_frictionJoint=9;Box2D.Dynamics.Joints.b2Joint.e_inactiveLimit=0;Box2D.Dynamics.Joints.b2Joint.e_atLowerLimit=1;Box2D.Dynamics.Joints.b2Joint.e_atUpperLimit=2;Box2D.Dynamics.Joints.b2Joint.e_equalLimits=3});I.b2JointDef=function(){};I.prototype.b2JointDef=function(){this.type=j.e_unknownJoint;this.userData=null;this.bodyA=null;this.bodyB=null;this.collideConnected=false};Q.b2JointEdge=function(){};Box2D.inherit(n,Box2D.Dynamics.Joints.b2Joint);n.prototype.__super=Box2D.Dynamics.Joints.b2Joint.prototype;n.b2LineJoint=function(){Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments);this.m_localAnchor1=new P();this.m_localAnchor2=new P();this.m_localXAxis1=new P();this.m_localYAxis1=new P();this.m_axis=new P();this.m_perp=new P();this.m_K=new H();this.m_impulse=new P()};n.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchor1)};n.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchor2)};n.prototype.GetReactionForce=function(V){if(V===undefined){V=0}return new P(V*(this.m_impulse.x*this.m_perp.x+(this.m_motorImpulse+this.m_impulse.y)*this.m_axis.x),V*(this.m_impulse.x*this.m_perp.y+(this.m_motorImpulse+this.m_impulse.y)*this.m_axis.y))};n.prototype.GetReactionTorque=function(V){if(V===undefined){V=0}return V*this.m_impulse.y};n.prototype.GetJointTranslation=function(){var X=this.m_bodyA;var W=this.m_bodyB;var ab;var ad=X.GetWorldPoint(this.m_localAnchor1);var ac=W.GetWorldPoint(this.m_localAnchor2);var aa=ac.x-ad.x;var Z=ac.y-ad.y;var Y=X.GetWorldVector(this.m_localXAxis1);var V=Y.x*aa+Y.y*Z;return V};n.prototype.GetJointSpeed=function(){var ao=this.m_bodyA;var an=this.m_bodyB;var ae;ae=ao.m_xf.R;var am=this.m_localAnchor1.x-ao.m_sweep.localCenter.x;var al=this.m_localAnchor1.y-ao.m_sweep.localCenter.y;var ah=(ae.col1.x*am+ae.col2.x*al);al=(ae.col1.y*am+ae.col2.y*al);am=ah;ae=an.m_xf.R;var ad=this.m_localAnchor2.x-an.m_sweep.localCenter.x;var ac=this.m_localAnchor2.y-an.m_sweep.localCenter.y;ah=(ae.col1.x*ad+ae.col2.x*ac);ac=(ae.col1.y*ad+ae.col2.y*ac);ad=ah;var ak=ao.m_sweep.c.x+am;var ai=ao.m_sweep.c.y+al;var X=an.m_sweep.c.x+ad;var V=an.m_sweep.c.y+ac;var ab=X-ak;var aa=V-ai;var Z=ao.GetWorldVector(this.m_localXAxis1);var Y=ao.m_linearVelocity;var W=an.m_linearVelocity;var ag=ao.m_angularVelocity;var af=an.m_angularVelocity;var aj=(ab*((-ag*Z.y))+aa*(ag*Z.x))+(Z.x*(((W.x+((-af*ac)))-Y.x)-((-ag*al)))+Z.y*(((W.y+(af*ad))-Y.y)-(ag*am)));return aj};n.prototype.IsLimitEnabled=function(){return this.m_enableLimit};n.prototype.EnableLimit=function(V){this.m_bodyA.SetAwake(true);this.m_bodyB.SetAwake(true);this.m_enableLimit=V};n.prototype.GetLowerLimit=function(){return this.m_lowerTranslation};n.prototype.GetUpperLimit=function(){return this.m_upperTranslation};n.prototype.SetLimits=function(V,W){if(V===undefined){V=0}if(W===undefined){W=0}this.m_bodyA.SetAwake(true);this.m_bodyB.SetAwake(true);this.m_lowerTranslation=V;this.m_upperTranslation=W};n.prototype.IsMotorEnabled=function(){return this.m_enableMotor};n.prototype.EnableMotor=function(V){this.m_bodyA.SetAwake(true);this.m_bodyB.SetAwake(true);this.m_enableMotor=V};n.prototype.SetMotorSpeed=function(V){if(V===undefined){V=0}this.m_bodyA.SetAwake(true);this.m_bodyB.SetAwake(true);this.m_motorSpeed=V};n.prototype.GetMotorSpeed=function(){return this.m_motorSpeed};n.prototype.SetMaxMotorForce=function(V){if(V===undefined){V=0}this.m_bodyA.SetAwake(true);this.m_bodyB.SetAwake(true);this.m_maxMotorForce=V};n.prototype.GetMaxMotorForce=function(){return this.m_maxMotorForce};n.prototype.GetMotorForce=function(){return this.m_motorImpulse};n.prototype.b2LineJoint=function(X){this.__super.b2Joint.call(this,X);var W;var V=0;var Y=0;this.m_localAnchor1.SetV(X.localAnchorA);this.m_localAnchor2.SetV(X.localAnchorB);this.m_localXAxis1.SetV(X.localAxisA);this.m_localYAxis1.x=(-this.m_localXAxis1.y);this.m_localYAxis1.y=this.m_localXAxis1.x;this.m_impulse.SetZero();this.m_motorMass=0;this.m_motorImpulse=0;this.m_lowerTranslation=X.lowerTranslation;this.m_upperTranslation=X.upperTranslation;this.m_maxMotorForce=X.maxMotorForce;this.m_motorSpeed=X.motorSpeed;this.m_enableLimit=X.enableLimit;this.m_enableMotor=X.enableMotor;this.m_limitState=j.e_inactiveLimit;this.m_axis.SetZero();this.m_perp.SetZero()};n.prototype.InitVelocityConstraints=function(ad){var aq=this.m_bodyA;var ap=this.m_bodyB;var ag;var ah=0;this.m_localCenterA.SetV(aq.GetLocalCenter());this.m_localCenterB.SetV(ap.GetLocalCenter());var Y=aq.GetTransform();var W=ap.GetTransform();ag=aq.m_xf.R;var ao=this.m_localAnchor1.x-this.m_localCenterA.x;var am=this.m_localAnchor1.y-this.m_localCenterA.y;ah=(ag.col1.x*ao+ag.col2.x*am);am=(ag.col1.y*ao+ag.col2.y*am);ao=ah;ag=ap.m_xf.R;var ac=this.m_localAnchor2.x-this.m_localCenterB.x;var ab=this.m_localAnchor2.y-this.m_localCenterB.y;ah=(ag.col1.x*ac+ag.col2.x*ab);ab=(ag.col1.y*ac+ag.col2.y*ab);ac=ah;var aa=ap.m_sweep.c.x+ac-aq.m_sweep.c.x-ao;var Z=ap.m_sweep.c.y+ab-aq.m_sweep.c.y-am;this.m_invMassA=aq.m_invMass;this.m_invMassB=ap.m_invMass;this.m_invIA=aq.m_invI;this.m_invIB=ap.m_invI;this.m_axis.SetV(t.MulMV(Y.R,this.m_localXAxis1));this.m_a1=(aa+ao)*this.m_axis.y-(Z+am)*this.m_axis.x;this.m_a2=ac*this.m_axis.y-ab*this.m_axis.x;this.m_motorMass=this.m_invMassA+this.m_invMassB+this.m_invIA*this.m_a1*this.m_a1+this.m_invIB*this.m_a2*this.m_a2;this.m_motorMass=this.m_motorMass>Number.MIN_VALUE?1/this.m_motorMass:0;this.m_perp.SetV(t.MulMV(Y.R,this.m_localYAxis1));this.m_s1=(aa+ao)*this.m_perp.y-(Z+am)*this.m_perp.x;this.m_s2=ac*this.m_perp.y-ab*this.m_perp.x;var X=this.m_invMassA;var V=this.m_invMassB;var aj=this.m_invIA;var ai=this.m_invIB;this.m_K.col1.x=X+V+aj*this.m_s1*this.m_s1+ai*this.m_s2*this.m_s2;this.m_K.col1.y=aj*this.m_s1*this.m_a1+ai*this.m_s2*this.m_a2;this.m_K.col2.x=this.m_K.col1.y;this.m_K.col2.y=X+V+aj*this.m_a1*this.m_a1+ai*this.m_a2*this.m_a2;if(this.m_enableLimit){var an=this.m_axis.x*aa+this.m_axis.y*Z;if(t.Abs(this.m_upperTranslation-this.m_lowerTranslation)<2*c.b2_linearSlop){this.m_limitState=j.e_equalLimits}else{if(an<=this.m_lowerTranslation){if(this.m_limitState!=j.e_atLowerLimit){this.m_limitState=j.e_atLowerLimit;this.m_impulse.y=0}}else{if(an>=this.m_upperTranslation){if(this.m_limitState!=j.e_atUpperLimit){this.m_limitState=j.e_atUpperLimit;this.m_impulse.y=0}}else{this.m_limitState=j.e_inactiveLimit;this.m_impulse.y=0}}}}else{this.m_limitState=j.e_inactiveLimit}if(this.m_enableMotor==false){this.m_motorImpulse=0}if(ad.warmStarting){this.m_impulse.x*=ad.dtRatio;this.m_impulse.y*=ad.dtRatio;this.m_motorImpulse*=ad.dtRatio;var af=this.m_impulse.x*this.m_perp.x+(this.m_motorImpulse+this.m_impulse.y)*this.m_axis.x;var ae=this.m_impulse.x*this.m_perp.y+(this.m_motorImpulse+this.m_impulse.y)*this.m_axis.y;var al=this.m_impulse.x*this.m_s1+(this.m_motorImpulse+this.m_impulse.y)*this.m_a1;var ak=this.m_impulse.x*this.m_s2+(this.m_motorImpulse+this.m_impulse.y)*this.m_a2;aq.m_linearVelocity.x-=this.m_invMassA*af;aq.m_linearVelocity.y-=this.m_invMassA*ae;aq.m_angularVelocity-=this.m_invIA*al;ap.m_linearVelocity.x+=this.m_invMassB*af;ap.m_linearVelocity.y+=this.m_invMassB*ae;ap.m_angularVelocity+=this.m_invIB*ak}else{this.m_impulse.SetZero();this.m_motorImpulse=0}};n.prototype.SolveVelocityConstraints=function(ab){var aq=this.m_bodyA;var ao=this.m_bodyB;var Z=aq.m_linearVelocity;var ag=aq.m_angularVelocity;var Y=ao.m_linearVelocity;var af=ao.m_angularVelocity;var ad=0;var ac=0;var al=0;var ak=0;if(this.m_enableMotor&&this.m_limitState!=j.e_equalLimits){var ai=this.m_axis.x*(Y.x-Z.x)+this.m_axis.y*(Y.y-Z.y)+this.m_a2*af-this.m_a1*ag;var ae=this.m_motorMass*(this.m_motorSpeed-ai);var aa=this.m_motorImpulse;var ah=ab.dt*this.m_maxMotorForce;this.m_motorImpulse=t.Clamp(this.m_motorImpulse+ae,(-ah),ah);ae=this.m_motorImpulse-aa;ad=ae*this.m_axis.x;ac=ae*this.m_axis.y;al=ae*this.m_a1;ak=ae*this.m_a2;Z.x-=this.m_invMassA*ad;Z.y-=this.m_invMassA*ac;ag-=this.m_invIA*al;Y.x+=this.m_invMassB*ad;Y.y+=this.m_invMassB*ac;af+=this.m_invIB*ak}var X=this.m_perp.x*(Y.x-Z.x)+this.m_perp.y*(Y.y-Z.y)+this.m_s2*af-this.m_s1*ag;if(this.m_enableLimit&&this.m_limitState!=j.e_inactiveLimit){var W=this.m_axis.x*(Y.x-Z.x)+this.m_axis.y*(Y.y-Z.y)+this.m_a2*af-this.m_a1*ag;var aj=this.m_impulse.Copy();var am=this.m_K.Solve(new P(),(-X),(-W));this.m_impulse.Add(am);if(this.m_limitState==j.e_atLowerLimit){this.m_impulse.y=t.Max(this.m_impulse.y,0)}else{if(this.m_limitState==j.e_atUpperLimit){this.m_impulse.y=t.Min(this.m_impulse.y,0)}}var an=(-X)-(this.m_impulse.y-aj.y)*this.m_K.col2.x;var V=0;if(this.m_K.col1.x!=0){V=an/this.m_K.col1.x+aj.x}else{V=aj.x}this.m_impulse.x=V;am.x=this.m_impulse.x-aj.x;am.y=this.m_impulse.y-aj.y;ad=am.x*this.m_perp.x+am.y*this.m_axis.x;ac=am.x*this.m_perp.y+am.y*this.m_axis.y;al=am.x*this.m_s1+am.y*this.m_a1;ak=am.x*this.m_s2+am.y*this.m_a2;Z.x-=this.m_invMassA*ad;Z.y-=this.m_invMassA*ac;ag-=this.m_invIA*al;Y.x+=this.m_invMassB*ad;Y.y+=this.m_invMassB*ac;af+=this.m_invIB*ak}else{var ap=0;if(this.m_K.col1.x!=0){ap=((-X))/this.m_K.col1.x}else{ap=0}this.m_impulse.x+=ap;ad=ap*this.m_perp.x;ac=ap*this.m_perp.y;al=ap*this.m_s1;ak=ap*this.m_s2;Z.x-=this.m_invMassA*ad;Z.y-=this.m_invMassA*ac;ag-=this.m_invIA*al;Y.x+=this.m_invMassB*ad;Y.y+=this.m_invMassB*ac;af+=this.m_invIB*ak}aq.m_linearVelocity.SetV(Z);aq.m_angularVelocity=ag;ao.m_linearVelocity.SetV(Y);ao.m_angularVelocity=af};n.prototype.SolvePositionConstraints=function(ag){if(ag===undefined){ag=0}var V=0;var ar=0;var ae=this.m_bodyA;var ad=this.m_bodyB;var Z=ae.m_sweep.c;var aw=ae.m_sweep.a;var Y=ad.m_sweep.c;var av=ad.m_sweep.a;var ax;var ac=0;var aD=0;var aC=0;var ab=0;var aa=0;var X=0;var af=0;var az=false;var al=0;var aq=H.FromAngle(aw);var ap=H.FromAngle(av);ax=aq;var aB=this.m_localAnchor1.x-this.m_localCenterA.x;var aA=this.m_localAnchor1.y-this.m_localCenterA.y;ac=(ax.col1.x*aB+ax.col2.x*aA);aA=(ax.col1.y*aB+ax.col2.y*aA);aB=ac;ax=ap;var ak=this.m_localAnchor2.x-this.m_localCenterB.x;var aj=this.m_localAnchor2.y-this.m_localCenterB.y;ac=(ax.col1.x*ak+ax.col2.x*aj);aj=(ax.col1.y*ak+ax.col2.y*aj);ak=ac;var ai=Y.x+ak-Z.x-aB;var ah=Y.y+aj-Z.y-aA;if(this.m_enableLimit){this.m_axis=t.MulMV(aq,this.m_localXAxis1);this.m_a1=(ai+aB)*this.m_axis.y-(ah+aA)*this.m_axis.x;this.m_a2=ak*this.m_axis.y-aj*this.m_axis.x;var ay=this.m_axis.x*ai+this.m_axis.y*ah;if(t.Abs(this.m_upperTranslation-this.m_lowerTranslation)<2*c.b2_linearSlop){al=t.Clamp(ay,(-c.b2_maxLinearCorrection),c.b2_maxLinearCorrection);X=t.Abs(ay);az=true}else{if(ay<=this.m_lowerTranslation){al=t.Clamp(ay-this.m_lowerTranslation+c.b2_linearSlop,(-c.b2_maxLinearCorrection),0);X=this.m_lowerTranslation-ay;az=true}else{if(ay>=this.m_upperTranslation){al=t.Clamp(ay-this.m_upperTranslation+c.b2_linearSlop,0,c.b2_maxLinearCorrection);X=ay-this.m_upperTranslation;az=true}}}}this.m_perp=t.MulMV(aq,this.m_localYAxis1);this.m_s1=(ai+aB)*this.m_perp.y-(ah+aA)*this.m_perp.x;this.m_s2=ak*this.m_perp.y-aj*this.m_perp.x;var at=new P();var am=this.m_perp.x*ai+this.m_perp.y*ah;X=t.Max(X,t.Abs(am));af=0;if(az){aD=this.m_invMassA;aC=this.m_invMassB;ab=this.m_invIA;aa=this.m_invIB;this.m_K.col1.x=aD+aC+ab*this.m_s1*this.m_s1+aa*this.m_s2*this.m_s2;this.m_K.col1.y=ab*this.m_s1*this.m_a1+aa*this.m_s2*this.m_a2;this.m_K.col2.x=this.m_K.col1.y;this.m_K.col2.y=aD+aC+ab*this.m_a1*this.m_a1+aa*this.m_a2*this.m_a2;this.m_K.Solve(at,(-am),(-al))}else{aD=this.m_invMassA;aC=this.m_invMassB;ab=this.m_invIA;aa=this.m_invIB;var W=aD+aC+ab*this.m_s1*this.m_s1+aa*this.m_s2*this.m_s2;var au=0;if(W!=0){au=((-am))/W}else{au=0}at.x=au;at.y=0}var aF=at.x*this.m_perp.x+at.y*this.m_axis.x;var aE=at.x*this.m_perp.y+at.y*this.m_axis.y;var ao=at.x*this.m_s1+at.y*this.m_a1;var an=at.x*this.m_s2+at.y*this.m_a2;Z.x-=this.m_invMassA*aF;Z.y-=this.m_invMassA*aE;aw-=this.m_invIA*ao;Y.x+=this.m_invMassB*aF;Y.y+=this.m_invMassB*aE;av+=this.m_invIB*an;ae.m_sweep.a=aw;ad.m_sweep.a=av;ae.SynchronizeTransform();ad.SynchronizeTransform();return X<=c.b2_linearSlop&&af<=c.b2_angularSlop};Box2D.inherit(g,Box2D.Dynamics.Joints.b2JointDef);g.prototype.__super=Box2D.Dynamics.Joints.b2JointDef.prototype;g.b2LineJointDef=function(){Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments);this.localAnchorA=new P();this.localAnchorB=new P();this.localAxisA=new P()};g.prototype.b2LineJointDef=function(){this.__super.b2JointDef.call(this);this.type=j.e_lineJoint;this.localAxisA.Set(1,0);this.enableLimit=false;this.lowerTranslation=0;this.upperTranslation=0;this.enableMotor=false;this.maxMotorForce=0;this.motorSpeed=0};g.prototype.Initialize=function(Y,X,V,W){this.bodyA=Y;this.bodyB=X;this.localAnchorA=this.bodyA.GetLocalPoint(V);this.localAnchorB=this.bodyB.GetLocalPoint(V);this.localAxisA=this.bodyA.GetLocalVector(W)};Box2D.inherit(G,Box2D.Dynamics.Joints.b2Joint);G.prototype.__super=Box2D.Dynamics.Joints.b2Joint.prototype;G.b2MouseJoint=function(){Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments);this.K=new H();this.K1=new H();this.K2=new H();this.m_localAnchor=new P();this.m_target=new P();this.m_impulse=new P();this.m_mass=new H();this.m_C=new P()};G.prototype.GetAnchorA=function(){return this.m_target};G.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchor)};G.prototype.GetReactionForce=function(V){if(V===undefined){V=0}return new P(V*this.m_impulse.x,V*this.m_impulse.y)};G.prototype.GetReactionTorque=function(V){if(V===undefined){V=0}return 0};G.prototype.GetTarget=function(){return this.m_target};G.prototype.SetTarget=function(V){if(this.m_bodyB.IsAwake()==false){this.m_bodyB.SetAwake(true)}this.m_target=V};G.prototype.GetMaxForce=function(){return this.m_maxForce};G.prototype.SetMaxForce=function(V){if(V===undefined){V=0}this.m_maxForce=V};G.prototype.GetFrequency=function(){return this.m_frequencyHz};G.prototype.SetFrequency=function(V){if(V===undefined){V=0}this.m_frequencyHz=V};G.prototype.GetDampingRatio=function(){return this.m_dampingRatio};G.prototype.SetDampingRatio=function(V){if(V===undefined){V=0}this.m_dampingRatio=V};G.prototype.b2MouseJoint=function(X){this.__super.b2Joint.call(this,X);this.m_target.SetV(X.target);var V=this.m_target.x-this.m_bodyB.m_xf.position.x;var Y=this.m_target.y-this.m_bodyB.m_xf.position.y;var W=this.m_bodyB.m_xf.R;this.m_localAnchor.x=(V*W.col1.x+Y*W.col1.y);this.m_localAnchor.y=(V*W.col2.x+Y*W.col2.y);this.m_maxForce=X.maxForce;this.m_impulse.SetZero();this.m_frequencyHz=X.frequencyHz;this.m_dampingRatio=X.dampingRatio;this.m_beta=0;this.m_gamma=0};G.prototype.InitVelocityConstraints=function(V){var ae=this.m_bodyB;var ac=ae.GetMass();var ag=2*Math.PI*this.m_frequencyHz;var ab=2*ac*this.m_dampingRatio*ag;var Y=ac*ag*ag;this.m_gamma=V.dt*(ab+V.dt*Y);this.m_gamma=this.m_gamma!=0?1/this.m_gamma:0;this.m_beta=V.dt*Y*this.m_gamma;var ad;ad=ae.m_xf.R;var aa=this.m_localAnchor.x-ae.m_sweep.localCenter.x;var Z=this.m_localAnchor.y-ae.m_sweep.localCenter.y;var af=(ad.col1.x*aa+ad.col2.x*Z);Z=(ad.col1.y*aa+ad.col2.y*Z);aa=af;var X=ae.m_invMass;var W=ae.m_invI;this.K1.col1.x=X;this.K1.col2.x=0;this.K1.col1.y=0;this.K1.col2.y=X;this.K2.col1.x=W*Z*Z;this.K2.col2.x=(-W*aa*Z);this.K2.col1.y=(-W*aa*Z);this.K2.col2.y=W*aa*aa;this.K.SetM(this.K1);this.K.AddM(this.K2);this.K.col1.x+=this.m_gamma;this.K.col2.y+=this.m_gamma;this.K.GetInverse(this.m_mass);this.m_C.x=ae.m_sweep.c.x+aa-this.m_target.x;this.m_C.y=ae.m_sweep.c.y+Z-this.m_target.y;ae.m_angularVelocity*=0.98;this.m_impulse.x*=V.dtRatio;this.m_impulse.y*=V.dtRatio;ae.m_linearVelocity.x+=X*this.m_impulse.x;ae.m_linearVelocity.y+=X*this.m_impulse.y;ae.m_angularVelocity+=W*(aa*this.m_impulse.y-Z*this.m_impulse.x)};G.prototype.SolveVelocityConstraints=function(Y){var af=this.m_bodyB;var ae;var ah=0;var ag=0;ae=af.m_xf.R;var ac=this.m_localAnchor.x-af.m_sweep.localCenter.x;var aa=this.m_localAnchor.y-af.m_sweep.localCenter.y;ah=(ae.col1.x*ac+ae.col2.x*aa);aa=(ae.col1.y*ac+ae.col2.y*aa);ac=ah;var V=af.m_linearVelocity.x+((-af.m_angularVelocity*aa));var ai=af.m_linearVelocity.y+(af.m_angularVelocity*ac);ae=this.m_mass;ah=V+this.m_beta*this.m_C.x+this.m_gamma*this.m_impulse.x;ag=ai+this.m_beta*this.m_C.y+this.m_gamma*this.m_impulse.y;var Z=(-(ae.col1.x*ah+ae.col2.x*ag));var X=(-(ae.col1.y*ah+ae.col2.y*ag));var ad=this.m_impulse.x;var ab=this.m_impulse.y;this.m_impulse.x+=Z;this.m_impulse.y+=X;var W=Y.dt*this.m_maxForce;if(this.m_impulse.LengthSquared()>W*W){this.m_impulse.Multiply(W/this.m_impulse.Length())}Z=this.m_impulse.x-ad;X=this.m_impulse.y-ab;af.m_linearVelocity.x+=af.m_invMass*Z;af.m_linearVelocity.y+=af.m_invMass*X;af.m_angularVelocity+=af.m_invI*(ac*X-aa*Z)};G.prototype.SolvePositionConstraints=function(V){if(V===undefined){V=0}return true};Box2D.inherit(d,Box2D.Dynamics.Joints.b2JointDef);d.prototype.__super=Box2D.Dynamics.Joints.b2JointDef.prototype;d.b2MouseJointDef=function(){Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments);this.target=new P()};d.prototype.b2MouseJointDef=function(){this.__super.b2JointDef.call(this);this.type=j.e_mouseJoint;this.maxForce=0;this.frequencyHz=5;this.dampingRatio=0.7};Box2D.inherit(o,Box2D.Dynamics.Joints.b2Joint);o.prototype.__super=Box2D.Dynamics.Joints.b2Joint.prototype;o.b2PrismaticJoint=function(){Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments);this.m_localAnchor1=new P();this.m_localAnchor2=new P();this.m_localXAxis1=new P();this.m_localYAxis1=new P();this.m_axis=new P();this.m_perp=new P();this.m_K=new m();this.m_impulse=new O()};o.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchor1)};o.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchor2)};o.prototype.GetReactionForce=function(V){if(V===undefined){V=0}return new P(V*(this.m_impulse.x*this.m_perp.x+(this.m_motorImpulse+this.m_impulse.z)*this.m_axis.x),V*(this.m_impulse.x*this.m_perp.y+(this.m_motorImpulse+this.m_impulse.z)*this.m_axis.y))};o.prototype.GetReactionTorque=function(V){if(V===undefined){V=0}return V*this.m_impulse.y};o.prototype.GetJointTranslation=function(){var X=this.m_bodyA;var W=this.m_bodyB;var ab;var ad=X.GetWorldPoint(this.m_localAnchor1);var ac=W.GetWorldPoint(this.m_localAnchor2);var aa=ac.x-ad.x;var Z=ac.y-ad.y;var Y=X.GetWorldVector(this.m_localXAxis1);var V=Y.x*aa+Y.y*Z;return V};o.prototype.GetJointSpeed=function(){var ao=this.m_bodyA;var an=this.m_bodyB;var ae;ae=ao.m_xf.R;var am=this.m_localAnchor1.x-ao.m_sweep.localCenter.x;var al=this.m_localAnchor1.y-ao.m_sweep.localCenter.y;var ah=(ae.col1.x*am+ae.col2.x*al);al=(ae.col1.y*am+ae.col2.y*al);am=ah;ae=an.m_xf.R;var ad=this.m_localAnchor2.x-an.m_sweep.localCenter.x;var ac=this.m_localAnchor2.y-an.m_sweep.localCenter.y;ah=(ae.col1.x*ad+ae.col2.x*ac);ac=(ae.col1.y*ad+ae.col2.y*ac);ad=ah;var ak=ao.m_sweep.c.x+am;var ai=ao.m_sweep.c.y+al;var X=an.m_sweep.c.x+ad;var V=an.m_sweep.c.y+ac;var ab=X-ak;var aa=V-ai;var Z=ao.GetWorldVector(this.m_localXAxis1);var Y=ao.m_linearVelocity;var W=an.m_linearVelocity;var ag=ao.m_angularVelocity;var af=an.m_angularVelocity;var aj=(ab*((-ag*Z.y))+aa*(ag*Z.x))+(Z.x*(((W.x+((-af*ac)))-Y.x)-((-ag*al)))+Z.y*(((W.y+(af*ad))-Y.y)-(ag*am)));return aj};o.prototype.IsLimitEnabled=function(){return this.m_enableLimit};o.prototype.EnableLimit=function(V){this.m_bodyA.SetAwake(true);this.m_bodyB.SetAwake(true);this.m_enableLimit=V};o.prototype.GetLowerLimit=function(){return this.m_lowerTranslation};o.prototype.GetUpperLimit=function(){return this.m_upperTranslation};o.prototype.SetLimits=function(V,W){if(V===undefined){V=0}if(W===undefined){W=0}this.m_bodyA.SetAwake(true);this.m_bodyB.SetAwake(true);this.m_lowerTranslation=V;this.m_upperTranslation=W};o.prototype.IsMotorEnabled=function(){return this.m_enableMotor};o.prototype.EnableMotor=function(V){this.m_bodyA.SetAwake(true);this.m_bodyB.SetAwake(true);this.m_enableMotor=V};o.prototype.SetMotorSpeed=function(V){if(V===undefined){V=0}this.m_bodyA.SetAwake(true);this.m_bodyB.SetAwake(true);this.m_motorSpeed=V};o.prototype.GetMotorSpeed=function(){return this.m_motorSpeed};o.prototype.SetMaxMotorForce=function(V){if(V===undefined){V=0}this.m_bodyA.SetAwake(true);this.m_bodyB.SetAwake(true);this.m_maxMotorForce=V};o.prototype.GetMotorForce=function(){return this.m_motorImpulse};o.prototype.b2PrismaticJoint=function(X){this.__super.b2Joint.call(this,X);var W;var V=0;var Y=0;this.m_localAnchor1.SetV(X.localAnchorA);this.m_localAnchor2.SetV(X.localAnchorB);this.m_localXAxis1.SetV(X.localAxisA);this.m_localYAxis1.x=(-this.m_localXAxis1.y);this.m_localYAxis1.y=this.m_localXAxis1.x;this.m_refAngle=X.referenceAngle;this.m_impulse.SetZero();this.m_motorMass=0;this.m_motorImpulse=0;this.m_lowerTranslation=X.lowerTranslation;this.m_upperTranslation=X.upperTranslation;this.m_maxMotorForce=X.maxMotorForce;this.m_motorSpeed=X.motorSpeed;this.m_enableLimit=X.enableLimit;this.m_enableMotor=X.enableMotor;this.m_limitState=j.e_inactiveLimit;this.m_axis.SetZero();this.m_perp.SetZero()};o.prototype.InitVelocityConstraints=function(ad){var aq=this.m_bodyA;var ap=this.m_bodyB;var ag;var ah=0;this.m_localCenterA.SetV(aq.GetLocalCenter());this.m_localCenterB.SetV(ap.GetLocalCenter());var Y=aq.GetTransform();var W=ap.GetTransform();ag=aq.m_xf.R;var ao=this.m_localAnchor1.x-this.m_localCenterA.x;var am=this.m_localAnchor1.y-this.m_localCenterA.y;ah=(ag.col1.x*ao+ag.col2.x*am);am=(ag.col1.y*ao+ag.col2.y*am);ao=ah;ag=ap.m_xf.R;var ac=this.m_localAnchor2.x-this.m_localCenterB.x;var ab=this.m_localAnchor2.y-this.m_localCenterB.y;ah=(ag.col1.x*ac+ag.col2.x*ab);ab=(ag.col1.y*ac+ag.col2.y*ab);ac=ah;var aa=ap.m_sweep.c.x+ac-aq.m_sweep.c.x-ao;var Z=ap.m_sweep.c.y+ab-aq.m_sweep.c.y-am;this.m_invMassA=aq.m_invMass;this.m_invMassB=ap.m_invMass;this.m_invIA=aq.m_invI;this.m_invIB=ap.m_invI;this.m_axis.SetV(t.MulMV(Y.R,this.m_localXAxis1));this.m_a1=(aa+ao)*this.m_axis.y-(Z+am)*this.m_axis.x;this.m_a2=ac*this.m_axis.y-ab*this.m_axis.x;this.m_motorMass=this.m_invMassA+this.m_invMassB+this.m_invIA*this.m_a1*this.m_a1+this.m_invIB*this.m_a2*this.m_a2;if(this.m_motorMass>Number.MIN_VALUE){this.m_motorMass=1/this.m_motorMass}this.m_perp.SetV(t.MulMV(Y.R,this.m_localYAxis1));this.m_s1=(aa+ao)*this.m_perp.y-(Z+am)*this.m_perp.x;this.m_s2=ac*this.m_perp.y-ab*this.m_perp.x;var X=this.m_invMassA;var V=this.m_invMassB;var aj=this.m_invIA;var ai=this.m_invIB;this.m_K.col1.x=X+V+aj*this.m_s1*this.m_s1+ai*this.m_s2*this.m_s2;this.m_K.col1.y=aj*this.m_s1+ai*this.m_s2;this.m_K.col1.z=aj*this.m_s1*this.m_a1+ai*this.m_s2*this.m_a2;this.m_K.col2.x=this.m_K.col1.y;this.m_K.col2.y=aj+ai;this.m_K.col2.z=aj*this.m_a1+ai*this.m_a2;this.m_K.col3.x=this.m_K.col1.z;this.m_K.col3.y=this.m_K.col2.z;this.m_K.col3.z=X+V+aj*this.m_a1*this.m_a1+ai*this.m_a2*this.m_a2;if(this.m_enableLimit){var an=this.m_axis.x*aa+this.m_axis.y*Z;if(t.Abs(this.m_upperTranslation-this.m_lowerTranslation)<2*c.b2_linearSlop){this.m_limitState=j.e_equalLimits}else{if(an<=this.m_lowerTranslation){if(this.m_limitState!=j.e_atLowerLimit){this.m_limitState=j.e_atLowerLimit;this.m_impulse.z=0}}else{if(an>=this.m_upperTranslation){if(this.m_limitState!=j.e_atUpperLimit){this.m_limitState=j.e_atUpperLimit;this.m_impulse.z=0}}else{this.m_limitState=j.e_inactiveLimit;this.m_impulse.z=0}}}}else{this.m_limitState=j.e_inactiveLimit}if(this.m_enableMotor==false){this.m_motorImpulse=0}if(ad.warmStarting){this.m_impulse.x*=ad.dtRatio;this.m_impulse.y*=ad.dtRatio;this.m_motorImpulse*=ad.dtRatio;var af=this.m_impulse.x*this.m_perp.x+(this.m_motorImpulse+this.m_impulse.z)*this.m_axis.x;var ae=this.m_impulse.x*this.m_perp.y+(this.m_motorImpulse+this.m_impulse.z)*this.m_axis.y;var al=this.m_impulse.x*this.m_s1+this.m_impulse.y+(this.m_motorImpulse+this.m_impulse.z)*this.m_a1;var ak=this.m_impulse.x*this.m_s2+this.m_impulse.y+(this.m_motorImpulse+this.m_impulse.z)*this.m_a2;aq.m_linearVelocity.x-=this.m_invMassA*af;aq.m_linearVelocity.y-=this.m_invMassA*ae;aq.m_angularVelocity-=this.m_invIA*al;ap.m_linearVelocity.x+=this.m_invMassB*af;ap.m_linearVelocity.y+=this.m_invMassB*ae;ap.m_angularVelocity+=this.m_invIB*ak}else{this.m_impulse.SetZero();this.m_motorImpulse=0}};o.prototype.SolveVelocityConstraints=function(aa){var at=this.m_bodyA;var aq=this.m_bodyB;var Y=at.m_linearVelocity;var ag=at.m_angularVelocity;var X=aq.m_linearVelocity;var ae=aq.m_angularVelocity;var ac=0;var ab=0;var ao=0;var an=0;if(this.m_enableMotor&&this.m_limitState!=j.e_equalLimits){var aj=this.m_axis.x*(X.x-Y.x)+this.m_axis.y*(X.y-Y.y)+this.m_a2*ae-this.m_a1*ag;var ad=this.m_motorMass*(this.m_motorSpeed-aj);var Z=this.m_motorImpulse;var ai=aa.dt*this.m_maxMotorForce;this.m_motorImpulse=t.Clamp(this.m_motorImpulse+ad,(-ai),ai);ad=this.m_motorImpulse-Z;ac=ad*this.m_axis.x;ab=ad*this.m_axis.y;ao=ad*this.m_a1;an=ad*this.m_a2;Y.x-=this.m_invMassA*ac;Y.y-=this.m_invMassA*ab;ag-=this.m_invIA*ao;X.x+=this.m_invMassB*ac;X.y+=this.m_invMassB*ab;ae+=this.m_invIB*an}var am=this.m_perp.x*(X.x-Y.x)+this.m_perp.y*(X.y-Y.y)+this.m_s2*ae-this.m_s1*ag;var al=ae-ag;if(this.m_enableLimit&&this.m_limitState!=j.e_inactiveLimit){var W=this.m_axis.x*(X.x-Y.x)+this.m_axis.y*(X.y-Y.y)+this.m_a2*ae-this.m_a1*ag;var ak=this.m_impulse.Copy();var ap=this.m_K.Solve33(new O(),(-am),(-al),(-W));this.m_impulse.Add(ap);if(this.m_limitState==j.e_atLowerLimit){this.m_impulse.z=t.Max(this.m_impulse.z,0)}else{if(this.m_limitState==j.e_atUpperLimit){this.m_impulse.z=t.Min(this.m_impulse.z,0)}}var ah=(-am)-(this.m_impulse.z-ak.z)*this.m_K.col3.x;var af=(-al)-(this.m_impulse.z-ak.z)*this.m_K.col3.y;var V=this.m_K.Solve22(new P(),ah,af);V.x+=ak.x;V.y+=ak.y;this.m_impulse.x=V.x;this.m_impulse.y=V.y;ap.x=this.m_impulse.x-ak.x;ap.y=this.m_impulse.y-ak.y;ap.z=this.m_impulse.z-ak.z;ac=ap.x*this.m_perp.x+ap.z*this.m_axis.x;ab=ap.x*this.m_perp.y+ap.z*this.m_axis.y;ao=ap.x*this.m_s1+ap.y+ap.z*this.m_a1;an=ap.x*this.m_s2+ap.y+ap.z*this.m_a2;Y.x-=this.m_invMassA*ac;Y.y-=this.m_invMassA*ab;ag-=this.m_invIA*ao;X.x+=this.m_invMassB*ac;X.y+=this.m_invMassB*ab;ae+=this.m_invIB*an}else{var ar=this.m_K.Solve22(new P(),(-am),(-al));this.m_impulse.x+=ar.x;this.m_impulse.y+=ar.y;ac=ar.x*this.m_perp.x;ab=ar.x*this.m_perp.y;ao=ar.x*this.m_s1+ar.y;an=ar.x*this.m_s2+ar.y;Y.x-=this.m_invMassA*ac;Y.y-=this.m_invMassA*ab;ag-=this.m_invIA*ao;X.x+=this.m_invMassB*ac;X.y+=this.m_invMassB*ab;ae+=this.m_invIB*an}at.m_linearVelocity.SetV(Y);at.m_angularVelocity=ag;aq.m_linearVelocity.SetV(X);aq.m_angularVelocity=ae};o.prototype.SolvePositionConstraints=function(aj){if(aj===undefined){aj=0}var V=0;var au=0;var ah=this.m_bodyA;var af=this.m_bodyB;var aa=ah.m_sweep.c;var az=ah.m_sweep.a;var Z=af.m_sweep.c;var ay=af.m_sweep.a;var aA;var ad=0;var aG=0;var aF=0;var ac=0;var ab=0;var Y=0;var ai=0;var aC=false;var ao=0;var at=H.FromAngle(az);var ar=H.FromAngle(ay);aA=at;var aE=this.m_localAnchor1.x-this.m_localCenterA.x;var aD=this.m_localAnchor1.y-this.m_localCenterA.y;ad=(aA.col1.x*aE+aA.col2.x*aD);aD=(aA.col1.y*aE+aA.col2.y*aD);aE=ad;aA=ar;var an=this.m_localAnchor2.x-this.m_localCenterB.x;var am=this.m_localAnchor2.y-this.m_localCenterB.y;ad=(aA.col1.x*an+aA.col2.x*am);am=(aA.col1.y*an+aA.col2.y*am);an=ad;var al=Z.x+an-aa.x-aE;var ak=Z.y+am-aa.y-aD;if(this.m_enableLimit){this.m_axis=t.MulMV(at,this.m_localXAxis1);this.m_a1=(al+aE)*this.m_axis.y-(ak+aD)*this.m_axis.x;this.m_a2=an*this.m_axis.y-am*this.m_axis.x;var aB=this.m_axis.x*al+this.m_axis.y*ak;if(t.Abs(this.m_upperTranslation-this.m_lowerTranslation)<2*c.b2_linearSlop){ao=t.Clamp(aB,(-c.b2_maxLinearCorrection),c.b2_maxLinearCorrection);Y=t.Abs(aB);aC=true}else{if(aB<=this.m_lowerTranslation){ao=t.Clamp(aB-this.m_lowerTranslation+c.b2_linearSlop,(-c.b2_maxLinearCorrection),0);Y=this.m_lowerTranslation-aB;aC=true}else{if(aB>=this.m_upperTranslation){ao=t.Clamp(aB-this.m_upperTranslation+c.b2_linearSlop,0,c.b2_maxLinearCorrection);Y=aB-this.m_upperTranslation;aC=true}}}}this.m_perp=t.MulMV(at,this.m_localYAxis1);this.m_s1=(al+aE)*this.m_perp.y-(ak+aD)*this.m_perp.x;this.m_s2=an*this.m_perp.y-am*this.m_perp.x;var aw=new O();var ag=this.m_perp.x*al+this.m_perp.y*ak;var ae=ay-az-this.m_refAngle;Y=t.Max(Y,t.Abs(ag));ai=t.Abs(ae);if(aC){aG=this.m_invMassA;aF=this.m_invMassB;ac=this.m_invIA;ab=this.m_invIB;this.m_K.col1.x=aG+aF+ac*this.m_s1*this.m_s1+ab*this.m_s2*this.m_s2;this.m_K.col1.y=ac*this.m_s1+ab*this.m_s2;this.m_K.col1.z=ac*this.m_s1*this.m_a1+ab*this.m_s2*this.m_a2;this.m_K.col2.x=this.m_K.col1.y;this.m_K.col2.y=ac+ab;this.m_K.col2.z=ac*this.m_a1+ab*this.m_a2;this.m_K.col3.x=this.m_K.col1.z;this.m_K.col3.y=this.m_K.col2.z;this.m_K.col3.z=aG+aF+ac*this.m_a1*this.m_a1+ab*this.m_a2*this.m_a2;this.m_K.Solve33(aw,(-ag),(-ae),(-ao))}else{aG=this.m_invMassA;aF=this.m_invMassB;ac=this.m_invIA;ab=this.m_invIB;var X=aG+aF+ac*this.m_s1*this.m_s1+ab*this.m_s2*this.m_s2;var W=ac*this.m_s1+ab*this.m_s2;var av=ac+ab;this.m_K.col1.Set(X,W,0);this.m_K.col2.Set(W,av,0);var ax=this.m_K.Solve22(new P(),(-ag),(-ae));aw.x=ax.x;aw.y=ax.y;aw.z=0}var aI=aw.x*this.m_perp.x+aw.z*this.m_axis.x;var aH=aw.x*this.m_perp.y+aw.z*this.m_axis.y;var aq=aw.x*this.m_s1+aw.y+aw.z*this.m_a1;var ap=aw.x*this.m_s2+aw.y+aw.z*this.m_a2;aa.x-=this.m_invMassA*aI;aa.y-=this.m_invMassA*aH;az-=this.m_invIA*aq;Z.x+=this.m_invMassB*aI;Z.y+=this.m_invMassB*aH;ay+=this.m_invIB*ap;ah.m_sweep.a=az;af.m_sweep.a=ay;ah.SynchronizeTransform();af.SynchronizeTransform();return Y<=c.b2_linearSlop&&ai<=c.b2_angularSlop};Box2D.inherit(v,Box2D.Dynamics.Joints.b2JointDef);v.prototype.__super=Box2D.Dynamics.Joints.b2JointDef.prototype;v.b2PrismaticJointDef=function(){Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments);this.localAnchorA=new P();this.localAnchorB=new P();this.localAxisA=new P()};v.prototype.b2PrismaticJointDef=function(){this.__super.b2JointDef.call(this);this.type=j.e_prismaticJoint;this.localAxisA.Set(1,0);this.referenceAngle=0;this.enableLimit=false;this.lowerTranslation=0;this.upperTranslation=0;this.enableMotor=false;this.maxMotorForce=0;this.motorSpeed=0};v.prototype.Initialize=function(Y,X,V,W){this.bodyA=Y;this.bodyB=X;this.localAnchorA=this.bodyA.GetLocalPoint(V);this.localAnchorB=this.bodyB.GetLocalPoint(V);this.localAxisA=this.bodyA.GetLocalVector(W);this.referenceAngle=this.bodyB.GetAngle()-this.bodyA.GetAngle()};Box2D.inherit(f,Box2D.Dynamics.Joints.b2Joint);f.prototype.__super=Box2D.Dynamics.Joints.b2Joint.prototype;f.b2PulleyJoint=function(){Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments);this.m_groundAnchor1=new P();this.m_groundAnchor2=new P();this.m_localAnchor1=new P();this.m_localAnchor2=new P();this.m_u1=new P();this.m_u2=new P()};f.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchor1)};f.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchor2)};f.prototype.GetReactionForce=function(V){if(V===undefined){V=0}return new P(V*this.m_impulse*this.m_u2.x,V*this.m_impulse*this.m_u2.y)};f.prototype.GetReactionTorque=function(V){if(V===undefined){V=0}return 0};f.prototype.GetGroundAnchorA=function(){var V=this.m_ground.m_xf.position.Copy();V.Add(this.m_groundAnchor1);return V};f.prototype.GetGroundAnchorB=function(){var V=this.m_ground.m_xf.position.Copy();V.Add(this.m_groundAnchor2);return V};f.prototype.GetLength1=function(){var Y=this.m_bodyA.GetWorldPoint(this.m_localAnchor1);var Z=this.m_ground.m_xf.position.x+this.m_groundAnchor1.x;var X=this.m_ground.m_xf.position.y+this.m_groundAnchor1.y;var W=Y.x-Z;var V=Y.y-X;return Math.sqrt(W*W+V*V)};f.prototype.GetLength2=function(){var Y=this.m_bodyB.GetWorldPoint(this.m_localAnchor2);var Z=this.m_ground.m_xf.position.x+this.m_groundAnchor2.x;var X=this.m_ground.m_xf.position.y+this.m_groundAnchor2.y;var W=Y.x-Z;var V=Y.y-X;return Math.sqrt(W*W+V*V)};f.prototype.GetRatio=function(){return this.m_ratio};f.prototype.b2PulleyJoint=function(X){this.__super.b2Joint.call(this,X);var W;var V=0;var Y=0;this.m_ground=this.m_bodyA.m_world.m_groundBody;this.m_groundAnchor1.x=X.groundAnchorA.x-this.m_ground.m_xf.position.x;this.m_groundAnchor1.y=X.groundAnchorA.y-this.m_ground.m_xf.position.y;this.m_groundAnchor2.x=X.groundAnchorB.x-this.m_ground.m_xf.position.x;this.m_groundAnchor2.y=X.groundAnchorB.y-this.m_ground.m_xf.position.y;this.m_localAnchor1.SetV(X.localAnchorA);this.m_localAnchor2.SetV(X.localAnchorB);this.m_ratio=X.ratio;this.m_constant=X.lengthA+this.m_ratio*X.lengthB;this.m_maxLength1=t.Min(X.maxLengthA,this.m_constant-this.m_ratio*f.b2_minPulleyLength);this.m_maxLength2=t.Min(X.maxLengthB,(this.m_constant-f.b2_minPulleyLength)/this.m_ratio);this.m_impulse=0;this.m_limitImpulse1=0;this.m_limitImpulse2=0};f.prototype.InitVelocityConstraints=function(ab){var av=this.m_bodyA;var au=this.m_bodyB;var af;af=av.m_xf.R;var ar=this.m_localAnchor1.x-av.m_sweep.localCenter.x;var aq=this.m_localAnchor1.y-av.m_sweep.localCenter.y;var al=(af.col1.x*ar+af.col2.x*aq);aq=(af.col1.y*ar+af.col2.y*aq);ar=al;af=au.m_xf.R;var aa=this.m_localAnchor2.x-au.m_sweep.localCenter.x;var Z=this.m_localAnchor2.y-au.m_sweep.localCenter.y;al=(af.col1.x*aa+af.col2.x*Z);Z=(af.col1.y*aa+af.col2.y*Z);aa=al;var ap=av.m_sweep.c.x+ar;var an=av.m_sweep.c.y+aq;var Y=au.m_sweep.c.x+aa;var X=au.m_sweep.c.y+Z;var ag=this.m_ground.m_xf.position.x+this.m_groundAnchor1.x;var ae=this.m_ground.m_xf.position.y+this.m_groundAnchor1.y;var ao=this.m_ground.m_xf.position.x+this.m_groundAnchor2.x;var am=this.m_ground.m_xf.position.y+this.m_groundAnchor2.y;this.m_u1.Set(ap-ag,an-ae);this.m_u2.Set(Y-ao,X-am);var ak=this.m_u1.Length();var aj=this.m_u2.Length();if(ak>c.b2_linearSlop){this.m_u1.Multiply(1/ak)}else{this.m_u1.SetZero()}if(aj>c.b2_linearSlop){this.m_u2.Multiply(1/aj)}else{this.m_u2.SetZero()}var ai=this.m_constant-ak-this.m_ratio*aj;if(ai>0){this.m_state=j.e_inactiveLimit;this.m_impulse=0}else{this.m_state=j.e_atUpperLimit}if(ak<this.m_maxLength1){this.m_limitState1=j.e_inactiveLimit;this.m_limitImpulse1=0}else{this.m_limitState1=j.e_atUpperLimit}if(aj<this.m_maxLength2){this.m_limitState2=j.e_inactiveLimit;this.m_limitImpulse2=0}else{this.m_limitState2=j.e_atUpperLimit}var at=ar*this.m_u1.y-aq*this.m_u1.x;var ah=aa*this.m_u2.y-Z*this.m_u2.x;this.m_limitMass1=av.m_invMass+av.m_invI*at*at;this.m_limitMass2=au.m_invMass+au.m_invI*ah*ah;this.m_pulleyMass=this.m_limitMass1+this.m_ratio*this.m_ratio*this.m_limitMass2;this.m_limitMass1=1/this.m_limitMass1;this.m_limitMass2=1/this.m_limitMass2;this.m_pulleyMass=1/this.m_pulleyMass;if(ab.warmStarting){this.m_impulse*=ab.dtRatio;this.m_limitImpulse1*=ab.dtRatio;this.m_limitImpulse2*=ab.dtRatio;var W=((-this.m_impulse)-this.m_limitImpulse1)*this.m_u1.x;var V=((-this.m_impulse)-this.m_limitImpulse1)*this.m_u1.y;var ad=((-this.m_ratio*this.m_impulse)-this.m_limitImpulse2)*this.m_u2.x;var ac=((-this.m_ratio*this.m_impulse)-this.m_limitImpulse2)*this.m_u2.y;av.m_linearVelocity.x+=av.m_invMass*W;av.m_linearVelocity.y+=av.m_invMass*V;av.m_angularVelocity+=av.m_invI*(ar*V-aq*W);au.m_linearVelocity.x+=au.m_invMass*ad;au.m_linearVelocity.y+=au.m_invMass*ac;au.m_angularVelocity+=au.m_invI*(aa*ac-Z*ad)}else{this.m_impulse=0;this.m_limitImpulse1=0;this.m_limitImpulse2=0}};f.prototype.SolveVelocityConstraints=function(ac){var ao=this.m_bodyA;var an=this.m_bodyB;var ah;ah=ao.m_xf.R;var am=this.m_localAnchor1.x-ao.m_sweep.localCenter.x;var al=this.m_localAnchor1.y-ao.m_sweep.localCenter.y;var ak=(ah.col1.x*am+ah.col2.x*al);al=(ah.col1.y*am+ah.col2.y*al);am=ak;ah=an.m_xf.R;var aa=this.m_localAnchor2.x-an.m_sweep.localCenter.x;var Z=this.m_localAnchor2.y-an.m_sweep.localCenter.y;ak=(ah.col1.x*aa+ah.col2.x*Z);Z=(ah.col1.y*aa+ah.col2.y*Z);aa=ak;var Y=0;var W=0;var ai=0;var af=0;var X=0;var V=0;var ag=0;var ae=0;var aj=0;var ad=0;var ab=0;if(this.m_state==j.e_atUpperLimit){Y=ao.m_linearVelocity.x+((-ao.m_angularVelocity*al));W=ao.m_linearVelocity.y+(ao.m_angularVelocity*am);ai=an.m_linearVelocity.x+((-an.m_angularVelocity*Z));af=an.m_linearVelocity.y+(an.m_angularVelocity*aa);aj=(-(this.m_u1.x*Y+this.m_u1.y*W))-this.m_ratio*(this.m_u2.x*ai+this.m_u2.y*af);ad=this.m_pulleyMass*((-aj));ab=this.m_impulse;this.m_impulse=t.Max(0,this.m_impulse+ad);ad=this.m_impulse-ab;X=(-ad*this.m_u1.x);V=(-ad*this.m_u1.y);ag=(-this.m_ratio*ad*this.m_u2.x);ae=(-this.m_ratio*ad*this.m_u2.y);ao.m_linearVelocity.x+=ao.m_invMass*X;ao.m_linearVelocity.y+=ao.m_invMass*V;ao.m_angularVelocity+=ao.m_invI*(am*V-al*X);an.m_linearVelocity.x+=an.m_invMass*ag;an.m_linearVelocity.y+=an.m_invMass*ae;an.m_angularVelocity+=an.m_invI*(aa*ae-Z*ag)}if(this.m_limitState1==j.e_atUpperLimit){Y=ao.m_linearVelocity.x+((-ao.m_angularVelocity*al));W=ao.m_linearVelocity.y+(ao.m_angularVelocity*am);aj=(-(this.m_u1.x*Y+this.m_u1.y*W));ad=(-this.m_limitMass1*aj);ab=this.m_limitImpulse1;this.m_limitImpulse1=t.Max(0,this.m_limitImpulse1+ad);ad=this.m_limitImpulse1-ab;X=(-ad*this.m_u1.x);V=(-ad*this.m_u1.y);ao.m_linearVelocity.x+=ao.m_invMass*X;ao.m_linearVelocity.y+=ao.m_invMass*V;ao.m_angularVelocity+=ao.m_invI*(am*V-al*X)}if(this.m_limitState2==j.e_atUpperLimit){ai=an.m_linearVelocity.x+((-an.m_angularVelocity*Z));af=an.m_linearVelocity.y+(an.m_angularVelocity*aa);aj=(-(this.m_u2.x*ai+this.m_u2.y*af));ad=(-this.m_limitMass2*aj);ab=this.m_limitImpulse2;this.m_limitImpulse2=t.Max(0,this.m_limitImpulse2+ad);ad=this.m_limitImpulse2-ab;ag=(-ad*this.m_u2.x);ae=(-ad*this.m_u2.y);an.m_linearVelocity.x+=an.m_invMass*ag;an.m_linearVelocity.y+=an.m_invMass*ae;an.m_angularVelocity+=an.m_invI*(aa*ae-Z*ag)}};f.prototype.SolvePositionConstraints=function(al){if(al===undefined){al=0}var at=this.m_bodyA;var ar=this.m_bodyB;var ad;var ae=this.m_ground.m_xf.position.x+this.m_groundAnchor1.x;var ac=this.m_ground.m_xf.position.y+this.m_groundAnchor1.y;var am=this.m_ground.m_xf.position.x+this.m_groundAnchor2.x;var aj=this.m_ground.m_xf.position.y+this.m_groundAnchor2.y;var aq=0;var ap=0;var Y=0;var X=0;var an=0;var ak=0;var W=0;var V=0;var ah=0;var ag=0;var af=0;var ab=0;var aa=0;var ao=0;var ai=0;var Z=0;if(this.m_state==j.e_atUpperLimit){ad=at.m_xf.R;aq=this.m_localAnchor1.x-at.m_sweep.localCenter.x;ap=this.m_localAnchor1.y-at.m_sweep.localCenter.y;ai=(ad.col1.x*aq+ad.col2.x*ap);ap=(ad.col1.y*aq+ad.col2.y*ap);aq=ai;ad=ar.m_xf.R;Y=this.m_localAnchor2.x-ar.m_sweep.localCenter.x;X=this.m_localAnchor2.y-ar.m_sweep.localCenter.y;ai=(ad.col1.x*Y+ad.col2.x*X);X=(ad.col1.y*Y+ad.col2.y*X);Y=ai;an=at.m_sweep.c.x+aq;ak=at.m_sweep.c.y+ap;W=ar.m_sweep.c.x+Y;V=ar.m_sweep.c.y+X;this.m_u1.Set(an-ae,ak-ac);this.m_u2.Set(W-am,V-aj);ah=this.m_u1.Length();ag=this.m_u2.Length();if(ah>c.b2_linearSlop){this.m_u1.Multiply(1/ah)}else{this.m_u1.SetZero()}if(ag>c.b2_linearSlop){this.m_u2.Multiply(1/ag)}else{this.m_u2.SetZero()}af=this.m_constant-ah-this.m_ratio*ag;Z=t.Max(Z,(-af));af=t.Clamp(af+c.b2_linearSlop,(-c.b2_maxLinearCorrection),0);ab=(-this.m_pulleyMass*af);an=(-ab*this.m_u1.x);ak=(-ab*this.m_u1.y);W=(-this.m_ratio*ab*this.m_u2.x);V=(-this.m_ratio*ab*this.m_u2.y);at.m_sweep.c.x+=at.m_invMass*an;at.m_sweep.c.y+=at.m_invMass*ak;at.m_sweep.a+=at.m_invI*(aq*ak-ap*an);ar.m_sweep.c.x+=ar.m_invMass*W;ar.m_sweep.c.y+=ar.m_invMass*V;ar.m_sweep.a+=ar.m_invI*(Y*V-X*W);at.SynchronizeTransform();ar.SynchronizeTransform()}if(this.m_limitState1==j.e_atUpperLimit){ad=at.m_xf.R;aq=this.m_localAnchor1.x-at.m_sweep.localCenter.x;ap=this.m_localAnchor1.y-at.m_sweep.localCenter.y;ai=(ad.col1.x*aq+ad.col2.x*ap);ap=(ad.col1.y*aq+ad.col2.y*ap);aq=ai;an=at.m_sweep.c.x+aq;ak=at.m_sweep.c.y+ap;this.m_u1.Set(an-ae,ak-ac);ah=this.m_u1.Length();if(ah>c.b2_linearSlop){this.m_u1.x*=1/ah;this.m_u1.y*=1/ah}else{this.m_u1.SetZero()}af=this.m_maxLength1-ah;Z=t.Max(Z,(-af));af=t.Clamp(af+c.b2_linearSlop,(-c.b2_maxLinearCorrection),0);ab=(-this.m_limitMass1*af);an=(-ab*this.m_u1.x);ak=(-ab*this.m_u1.y);at.m_sweep.c.x+=at.m_invMass*an;at.m_sweep.c.y+=at.m_invMass*ak;at.m_sweep.a+=at.m_invI*(aq*ak-ap*an);at.SynchronizeTransform()}if(this.m_limitState2==j.e_atUpperLimit){ad=ar.m_xf.R;Y=this.m_localAnchor2.x-ar.m_sweep.localCenter.x;X=this.m_localAnchor2.y-ar.m_sweep.localCenter.y;ai=(ad.col1.x*Y+ad.col2.x*X);X=(ad.col1.y*Y+ad.col2.y*X);Y=ai;W=ar.m_sweep.c.x+Y;V=ar.m_sweep.c.y+X;this.m_u2.Set(W-am,V-aj);ag=this.m_u2.Length();if(ag>c.b2_linearSlop){this.m_u2.x*=1/ag;this.m_u2.y*=1/ag}else{this.m_u2.SetZero()}af=this.m_maxLength2-ag;Z=t.Max(Z,(-af));af=t.Clamp(af+c.b2_linearSlop,(-c.b2_maxLinearCorrection),0);ab=(-this.m_limitMass2*af);W=(-ab*this.m_u2.x);V=(-ab*this.m_u2.y);ar.m_sweep.c.x+=ar.m_invMass*W;ar.m_sweep.c.y+=ar.m_invMass*V;ar.m_sweep.a+=ar.m_invI*(Y*V-X*W);ar.SynchronizeTransform()}return Z<c.b2_linearSlop};Box2D.postDefs.push(function(){Box2D.Dynamics.Joints.b2PulleyJoint.b2_minPulleyLength=2});Box2D.inherit(T,Box2D.Dynamics.Joints.b2JointDef);T.prototype.__super=Box2D.Dynamics.Joints.b2JointDef.prototype;T.b2PulleyJointDef=function(){Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments);this.groundAnchorA=new P();this.groundAnchorB=new P();this.localAnchorA=new P();this.localAnchorB=new P()};T.prototype.b2PulleyJointDef=function(){this.__super.b2JointDef.call(this);this.type=j.e_pulleyJoint;this.groundAnchorA.Set((-1),1);this.groundAnchorB.Set(1,1);this.localAnchorA.Set((-1),0);this.localAnchorB.Set(1,0);this.lengthA=0;this.maxLengthA=0;this.lengthB=0;this.maxLengthB=0;this.ratio=1;this.collideConnected=true};T.prototype.Initialize=function(Y,V,af,ad,aa,Z,W){if(W===undefined){W=0}this.bodyA=Y;this.bodyB=V;this.groundAnchorA.SetV(af);this.groundAnchorB.SetV(ad);this.localAnchorA=this.bodyA.GetLocalPoint(aa);this.localAnchorB=this.bodyB.GetLocalPoint(Z);var ag=aa.x-af.x;var ae=aa.y-af.y;this.lengthA=Math.sqrt(ag*ag+ae*ae);var ac=Z.x-ad.x;var ab=Z.y-ad.y;this.lengthB=Math.sqrt(ac*ac+ab*ab);this.ratio=W;var X=this.lengthA+this.ratio*this.lengthB;this.maxLengthA=X-this.ratio*f.b2_minPulleyLength;this.maxLengthB=(X-f.b2_minPulleyLength)/this.ratio};Box2D.inherit(F,Box2D.Dynamics.Joints.b2Joint);F.prototype.__super=Box2D.Dynamics.Joints.b2Joint.prototype;F.b2RevoluteJoint=function(){Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments);this.K=new H();this.K1=new H();this.K2=new H();this.K3=new H();this.impulse3=new O();this.impulse2=new P();this.reduced=new P();this.m_localAnchor1=new P();this.m_localAnchor2=new P();this.m_impulse=new O();this.m_mass=new m()};F.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchor1)};F.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchor2)};F.prototype.GetReactionForce=function(V){if(V===undefined){V=0}return new P(V*this.m_impulse.x,V*this.m_impulse.y)};F.prototype.GetReactionTorque=function(V){if(V===undefined){V=0}return V*this.m_impulse.z};F.prototype.GetJointAngle=function(){return this.m_bodyB.m_sweep.a-this.m_bodyA.m_sweep.a-this.m_referenceAngle};F.prototype.GetJointSpeed=function(){return this.m_bodyB.m_angularVelocity-this.m_bodyA.m_angularVelocity};F.prototype.IsLimitEnabled=function(){return this.m_enableLimit};F.prototype.EnableLimit=function(V){this.m_enableLimit=V};F.prototype.GetLowerLimit=function(){return this.m_lowerAngle};F.prototype.GetUpperLimit=function(){return this.m_upperAngle};F.prototype.SetLimits=function(V,W){if(V===undefined){V=0}if(W===undefined){W=0}this.m_lowerAngle=V;this.m_upperAngle=W};F.prototype.IsMotorEnabled=function(){this.m_bodyA.SetAwake(true);this.m_bodyB.SetAwake(true);return this.m_enableMotor};F.prototype.EnableMotor=function(V){this.m_enableMotor=V};F.prototype.SetMotorSpeed=function(V){if(V===undefined){V=0}this.m_bodyA.SetAwake(true);this.m_bodyB.SetAwake(true);this.m_motorSpeed=V};F.prototype.GetMotorSpeed=function(){return this.m_motorSpeed};F.prototype.SetMaxMotorTorque=function(V){if(V===undefined){V=0}this.m_maxMotorTorque=V};F.prototype.GetMotorTorque=function(){return this.m_maxMotorTorque};F.prototype.b2RevoluteJoint=function(V){this.__super.b2Joint.call(this,V);this.m_localAnchor1.SetV(V.localAnchorA);this.m_localAnchor2.SetV(V.localAnchorB);this.m_referenceAngle=V.referenceAngle;this.m_impulse.SetZero();this.m_motorImpulse=0;this.m_lowerAngle=V.lowerAngle;this.m_upperAngle=V.upperAngle;this.m_maxMotorTorque=V.maxMotorTorque;this.m_motorSpeed=V.motorSpeed;this.m_enableLimit=V.enableLimit;this.m_enableMotor=V.enableMotor;this.m_limitState=j.e_inactiveLimit};F.prototype.InitVelocityConstraints=function(Y){var W=this.m_bodyA;var V=this.m_bodyB;var af;var ag=0;if(this.m_enableMotor||this.m_enableLimit){}af=W.m_xf.R;var aj=this.m_localAnchor1.x-W.m_sweep.localCenter.x;var ah=this.m_localAnchor1.y-W.m_sweep.localCenter.y;ag=(af.col1.x*aj+af.col2.x*ah);ah=(af.col1.y*aj+af.col2.y*ah);aj=ag;af=V.m_xf.R;var ae=this.m_localAnchor2.x-V.m_sweep.localCenter.x;var ad=this.m_localAnchor2.y-V.m_sweep.localCenter.y;ag=(af.col1.x*ae+af.col2.x*ad);ad=(af.col1.y*ae+af.col2.y*ad);ae=ag;var ak=W.m_invMass;var ai=V.m_invMass;var ac=W.m_invI;var aa=V.m_invI;this.m_mass.col1.x=ak+ai+ah*ah*ac+ad*ad*aa;this.m_mass.col2.x=(-ah*aj*ac)-ad*ae*aa;this.m_mass.col3.x=(-ah*ac)-ad*aa;this.m_mass.col1.y=this.m_mass.col2.x;this.m_mass.col2.y=ak+ai+aj*aj*ac+ae*ae*aa;this.m_mass.col3.y=aj*ac+ae*aa;this.m_mass.col1.z=this.m_mass.col3.x;this.m_mass.col2.z=this.m_mass.col3.y;this.m_mass.col3.z=ac+aa;this.m_motorMass=1/(ac+aa);if(this.m_enableMotor==false){this.m_motorImpulse=0}if(this.m_enableLimit){var X=V.m_sweep.a-W.m_sweep.a-this.m_referenceAngle;if(t.Abs(this.m_upperAngle-this.m_lowerAngle)<2*c.b2_angularSlop){this.m_limitState=j.e_equalLimits}else{if(X<=this.m_lowerAngle){if(this.m_limitState!=j.e_atLowerLimit){this.m_impulse.z=0}this.m_limitState=j.e_atLowerLimit}else{if(X>=this.m_upperAngle){if(this.m_limitState!=j.e_atUpperLimit){this.m_impulse.z=0}this.m_limitState=j.e_atUpperLimit}else{this.m_limitState=j.e_inactiveLimit;this.m_impulse.z=0}}}}else{this.m_limitState=j.e_inactiveLimit}if(Y.warmStarting){this.m_impulse.x*=Y.dtRatio;this.m_impulse.y*=Y.dtRatio;this.m_motorImpulse*=Y.dtRatio;var ab=this.m_impulse.x;var Z=this.m_impulse.y;W.m_linearVelocity.x-=ak*ab;W.m_linearVelocity.y-=ak*Z;W.m_angularVelocity-=ac*((aj*Z-ah*ab)+this.m_motorImpulse+this.m_impulse.z);V.m_linearVelocity.x+=ai*ab;V.m_linearVelocity.y+=ai*Z;V.m_angularVelocity+=aa*((ae*Z-ad*ab)+this.m_motorImpulse+this.m_impulse.z)}else{this.m_impulse.SetZero();this.m_motorImpulse=0}};F.prototype.SolveVelocityConstraints=function(af){var aw=this.m_bodyA;var av=this.m_bodyB;var ah;var am=0;var au=0;var at=0;var ar=0;var ab=0;var aa=0;var Z=aw.m_linearVelocity;var aj=aw.m_angularVelocity;var Y=av.m_linearVelocity;var ai=av.m_angularVelocity;var X=aw.m_invMass;var V=av.m_invMass;var ao=aw.m_invI;var an=av.m_invI;if(this.m_enableMotor&&this.m_limitState!=j.e_equalLimits){var al=ai-aj-this.m_motorSpeed;var ag=this.m_motorMass*((-al));var ad=this.m_motorImpulse;var ak=af.dt*this.m_maxMotorTorque;this.m_motorImpulse=t.Clamp(this.m_motorImpulse+ag,(-ak),ak);ag=this.m_motorImpulse-ad;aj-=ao*ag;ai+=an*ag}if(this.m_enableLimit&&this.m_limitState!=j.e_inactiveLimit){ah=aw.m_xf.R;at=this.m_localAnchor1.x-aw.m_sweep.localCenter.x;ar=this.m_localAnchor1.y-aw.m_sweep.localCenter.y;am=(ah.col1.x*at+ah.col2.x*ar);ar=(ah.col1.y*at+ah.col2.y*ar);at=am;ah=av.m_xf.R;ab=this.m_localAnchor2.x-av.m_sweep.localCenter.x;aa=this.m_localAnchor2.y-av.m_sweep.localCenter.y;am=(ah.col1.x*ab+ah.col2.x*aa);aa=(ah.col1.y*ab+ah.col2.y*aa);ab=am;var aq=Y.x+((-ai*aa))-Z.x-((-aj*ar));var ap=Y.y+(ai*ab)-Z.y-(aj*at);var W=ai-aj;this.m_mass.Solve33(this.impulse3,(-aq),(-ap),(-W));if(this.m_limitState==j.e_equalLimits){this.m_impulse.Add(this.impulse3)}else{if(this.m_limitState==j.e_atLowerLimit){au=this.m_impulse.z+this.impulse3.z;if(au<0){this.m_mass.Solve22(this.reduced,(-aq),(-ap));this.impulse3.x=this.reduced.x;this.impulse3.y=this.reduced.y;this.impulse3.z=(-this.m_impulse.z);this.m_impulse.x+=this.reduced.x;this.m_impulse.y+=this.reduced.y;this.m_impulse.z=0}}else{if(this.m_limitState==j.e_atUpperLimit){au=this.m_impulse.z+this.impulse3.z;if(au>0){this.m_mass.Solve22(this.reduced,(-aq),(-ap));this.impulse3.x=this.reduced.x;this.impulse3.y=this.reduced.y;this.impulse3.z=(-this.m_impulse.z);this.m_impulse.x+=this.reduced.x;this.m_impulse.y+=this.reduced.y;this.m_impulse.z=0}}}}Z.x-=X*this.impulse3.x;Z.y-=X*this.impulse3.y;aj-=ao*(at*this.impulse3.y-ar*this.impulse3.x+this.impulse3.z);Y.x+=V*this.impulse3.x;Y.y+=V*this.impulse3.y;ai+=an*(ab*this.impulse3.y-aa*this.impulse3.x+this.impulse3.z)}else{ah=aw.m_xf.R;at=this.m_localAnchor1.x-aw.m_sweep.localCenter.x;ar=this.m_localAnchor1.y-aw.m_sweep.localCenter.y;am=(ah.col1.x*at+ah.col2.x*ar);ar=(ah.col1.y*at+ah.col2.y*ar);at=am;ah=av.m_xf.R;ab=this.m_localAnchor2.x-av.m_sweep.localCenter.x;aa=this.m_localAnchor2.y-av.m_sweep.localCenter.y;am=(ah.col1.x*ab+ah.col2.x*aa);aa=(ah.col1.y*ab+ah.col2.y*aa);ab=am;var ae=Y.x+((-ai*aa))-Z.x-((-aj*ar));var ac=Y.y+(ai*ab)-Z.y-(aj*at);this.m_mass.Solve22(this.impulse2,(-ae),(-ac));this.m_impulse.x+=this.impulse2.x;this.m_impulse.y+=this.impulse2.y;Z.x-=X*this.impulse2.x;Z.y-=X*this.impulse2.y;aj-=ao*(at*this.impulse2.y-ar*this.impulse2.x);Y.x+=V*this.impulse2.x;Y.y+=V*this.impulse2.y;ai+=an*(ab*this.impulse2.y-aa*this.impulse2.x)}aw.m_linearVelocity.SetV(Z);aw.m_angularVelocity=aj;av.m_linearVelocity.SetV(Y);av.m_angularVelocity=ai};F.prototype.SolvePositionConstraints=function(ap){if(ap===undefined){ap=0}var ao=0;var ai=0;var ae;var aA=this.m_bodyA;var az=this.m_bodyB;var at=0;var af=0;var ak=0;var W=0;var V=0;if(this.m_enableLimit&&this.m_limitState!=j.e_inactiveLimit){var aq=az.m_sweep.a-aA.m_sweep.a-this.m_referenceAngle;var al=0;if(this.m_limitState==j.e_equalLimits){ai=t.Clamp(aq-this.m_lowerAngle,(-c.b2_maxAngularCorrection),c.b2_maxAngularCorrection);al=(-this.m_motorMass*ai);at=t.Abs(ai)}else{if(this.m_limitState==j.e_atLowerLimit){ai=aq-this.m_lowerAngle;at=(-ai);ai=t.Clamp(ai+c.b2_angularSlop,(-c.b2_maxAngularCorrection),0);al=(-this.m_motorMass*ai)}else{if(this.m_limitState==j.e_atUpperLimit){ai=aq-this.m_upperAngle;at=ai;ai=t.Clamp(ai-c.b2_angularSlop,0,c.b2_maxAngularCorrection);al=(-this.m_motorMass*ai)}}}aA.m_sweep.a-=aA.m_invI*al;az.m_sweep.a+=az.m_invI*al;aA.SynchronizeTransform();az.SynchronizeTransform()}ae=aA.m_xf.R;var au=this.m_localAnchor1.x-aA.m_sweep.localCenter.x;var ar=this.m_localAnchor1.y-aA.m_sweep.localCenter.y;ak=(ae.col1.x*au+ae.col2.x*ar);ar=(ae.col1.y*au+ae.col2.y*ar);au=ak;ae=az.m_xf.R;var Z=this.m_localAnchor2.x-az.m_sweep.localCenter.x;var Y=this.m_localAnchor2.y-az.m_sweep.localCenter.y;ak=(ae.col1.x*Z+ae.col2.x*Y);Y=(ae.col1.y*Z+ae.col2.y*Y);Z=ak;var ax=az.m_sweep.c.x+Z-aA.m_sweep.c.x-au;var av=az.m_sweep.c.y+Y-aA.m_sweep.c.y-ar;var ad=ax*ax+av*av;var ac=Math.sqrt(ad);af=ac;var ah=aA.m_invMass;var ag=az.m_invMass;var ab=aA.m_invI;var aa=az.m_invI;var X=10*c.b2_linearSlop;if(ad>X*X){var ay=ax/ac;var aw=av/ac;var an=ah+ag;var am=1/an;W=am*((-ax));V=am*((-av));var aj=0.5;aA.m_sweep.c.x-=aj*ah*W;aA.m_sweep.c.y-=aj*ah*V;az.m_sweep.c.x+=aj*ag*W;az.m_sweep.c.y+=aj*ag*V;ax=az.m_sweep.c.x+Z-aA.m_sweep.c.x-au;av=az.m_sweep.c.y+Y-aA.m_sweep.c.y-ar}this.K1.col1.x=ah+ag;this.K1.col2.x=0;this.K1.col1.y=0;this.K1.col2.y=ah+ag;this.K2.col1.x=ab*ar*ar;this.K2.col2.x=(-ab*au*ar);this.K2.col1.y=(-ab*au*ar);this.K2.col2.y=ab*au*au;this.K3.col1.x=aa*Y*Y;this.K3.col2.x=(-aa*Z*Y);this.K3.col1.y=(-aa*Z*Y);this.K3.col2.y=aa*Z*Z;this.K.SetM(this.K1);this.K.AddM(this.K2);this.K.AddM(this.K3);this.K.Solve(F.tImpulse,(-ax),(-av));W=F.tImpulse.x;V=F.tImpulse.y;aA.m_sweep.c.x-=aA.m_invMass*W;aA.m_sweep.c.y-=aA.m_invMass*V;aA.m_sweep.a-=aA.m_invI*(au*V-ar*W);az.m_sweep.c.x+=az.m_invMass*W;az.m_sweep.c.y+=az.m_invMass*V;az.m_sweep.a+=az.m_invI*(Z*V-Y*W);aA.SynchronizeTransform();az.SynchronizeTransform();return af<=c.b2_linearSlop&&at<=c.b2_angularSlop};Box2D.postDefs.push(function(){Box2D.Dynamics.Joints.b2RevoluteJoint.tImpulse=new P()});Box2D.inherit(a,Box2D.Dynamics.Joints.b2JointDef);a.prototype.__super=Box2D.Dynamics.Joints.b2JointDef.prototype;a.b2RevoluteJointDef=function(){Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments);this.localAnchorA=new P();this.localAnchorB=new P()};a.prototype.b2RevoluteJointDef=function(){this.__super.b2JointDef.call(this);this.type=j.e_revoluteJoint;this.localAnchorA.Set(0,0);this.localAnchorB.Set(0,0);this.referenceAngle=0;this.lowerAngle=0;this.upperAngle=0;this.maxMotorTorque=0;this.motorSpeed=0;this.enableLimit=false;this.enableMotor=false};a.prototype.Initialize=function(X,W,V){this.bodyA=X;this.bodyB=W;this.localAnchorA=this.bodyA.GetLocalPoint(V);this.localAnchorB=this.bodyB.GetLocalPoint(V);this.referenceAngle=this.bodyB.GetAngle()-this.bodyA.GetAngle()};Box2D.inherit(e,Box2D.Dynamics.Joints.b2Joint);e.prototype.__super=Box2D.Dynamics.Joints.b2Joint.prototype;e.b2WeldJoint=function(){Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments);this.m_localAnchorA=new P();this.m_localAnchorB=new P();this.m_impulse=new O();this.m_mass=new m()};e.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA)};e.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB)};e.prototype.GetReactionForce=function(V){if(V===undefined){V=0}return new P(V*this.m_impulse.x,V*this.m_impulse.y)};e.prototype.GetReactionTorque=function(V){if(V===undefined){V=0}return V*this.m_impulse.z};e.prototype.b2WeldJoint=function(V){this.__super.b2Joint.call(this,V);this.m_localAnchorA.SetV(V.localAnchorA);this.m_localAnchorB.SetV(V.localAnchorB);this.m_referenceAngle=V.referenceAngle;this.m_impulse.SetZero();this.m_mass=new m()};e.prototype.InitVelocityConstraints=function(Y){var ae;var af=0;var W=this.m_bodyA;var V=this.m_bodyB;ae=W.m_xf.R;var ab=this.m_localAnchorA.x-W.m_sweep.localCenter.x;var aa=this.m_localAnchorA.y-W.m_sweep.localCenter.y;af=(ae.col1.x*ab+ae.col2.x*aa);aa=(ae.col1.y*ab+ae.col2.y*aa);ab=af;ae=V.m_xf.R;var ah=this.m_localAnchorB.x-V.m_sweep.localCenter.x;var ag=this.m_localAnchorB.y-V.m_sweep.localCenter.y;af=(ae.col1.x*ah+ae.col2.x*ag);ag=(ae.col1.y*ah+ae.col2.y*ag);ah=af;var Z=W.m_invMass;var X=V.m_invMass;var ad=W.m_invI;var ac=V.m_invI;this.m_mass.col1.x=Z+X+aa*aa*ad+ag*ag*ac;this.m_mass.col2.x=(-aa*ab*ad)-ag*ah*ac;this.m_mass.col3.x=(-aa*ad)-ag*ac;this.m_mass.col1.y=this.m_mass.col2.x;this.m_mass.col2.y=Z+X+ab*ab*ad+ah*ah*ac;this.m_mass.col3.y=ab*ad+ah*ac;this.m_mass.col1.z=this.m_mass.col3.x;this.m_mass.col2.z=this.m_mass.col3.y;this.m_mass.col3.z=ad+ac;if(Y.warmStarting){this.m_impulse.x*=Y.dtRatio;this.m_impulse.y*=Y.dtRatio;this.m_impulse.z*=Y.dtRatio;W.m_linearVelocity.x-=Z*this.m_impulse.x;W.m_linearVelocity.y-=Z*this.m_impulse.y;W.m_angularVelocity-=ad*(ab*this.m_impulse.y-aa*this.m_impulse.x+this.m_impulse.z);V.m_linearVelocity.x+=X*this.m_impulse.x;V.m_linearVelocity.y+=X*this.m_impulse.y;V.m_angularVelocity+=ac*(ah*this.m_impulse.y-ag*this.m_impulse.x+this.m_impulse.z)}else{this.m_impulse.SetZero()}};e.prototype.SolveVelocityConstraints=function(Z){var ae;var af=0;var ap=this.m_bodyA;var ao=this.m_bodyB;var an=ap.m_linearVelocity;var X=ap.m_angularVelocity;var am=ao.m_linearVelocity;var W=ao.m_angularVelocity;var aj=ap.m_invMass;var ai=ao.m_invMass;var ac=ap.m_invI;var ab=ao.m_invI;ae=ap.m_xf.R;var aa=this.m_localAnchorA.x-ap.m_sweep.localCenter.x;var Y=this.m_localAnchorA.y-ap.m_sweep.localCenter.y;af=(ae.col1.x*aa+ae.col2.x*Y);Y=(ae.col1.y*aa+ae.col2.y*Y);aa=af;ae=ao.m_xf.R;var ah=this.m_localAnchorB.x-ao.m_sweep.localCenter.x;var ag=this.m_localAnchorB.y-ao.m_sweep.localCenter.y;af=(ae.col1.x*ah+ae.col2.x*ag);ag=(ae.col1.y*ah+ae.col2.y*ag);ah=af;var al=am.x-W*ag-an.x+X*Y;var ak=am.y+W*ah-an.y-X*aa;var V=W-X;var ad=new O();this.m_mass.Solve33(ad,(-al),(-ak),(-V));this.m_impulse.Add(ad);an.x-=aj*ad.x;an.y-=aj*ad.y;X-=ac*(aa*ad.y-Y*ad.x+ad.z);am.x+=ai*ad.x;am.y+=ai*ad.y;W+=ab*(ah*ad.y-ag*ad.x+ad.z);ap.m_angularVelocity=X;ao.m_angularVelocity=W};e.prototype.SolvePositionConstraints=function(aj){if(aj===undefined){aj=0}var ac;var ad=0;var ao=this.m_bodyA;var an=this.m_bodyB;ac=ao.m_xf.R;var X=this.m_localAnchorA.x-ao.m_sweep.localCenter.x;var W=this.m_localAnchorA.y-ao.m_sweep.localCenter.y;ad=(ac.col1.x*X+ac.col2.x*W);W=(ac.col1.y*X+ac.col2.y*W);X=ad;ac=an.m_xf.R;var af=this.m_localAnchorB.x-an.m_sweep.localCenter.x;var ae=this.m_localAnchorB.y-an.m_sweep.localCenter.y;ad=(ac.col1.x*af+ac.col2.x*ae);ae=(ac.col1.y*af+ac.col2.y*ae);af=ad;var ah=ao.m_invMass;var ag=an.m_invMass;var Z=ao.m_invI;var Y=an.m_invI;var am=an.m_sweep.c.x+af-ao.m_sweep.c.x-X;var al=an.m_sweep.c.y+ae-ao.m_sweep.c.y-W;var ai=an.m_sweep.a-ao.m_sweep.a-this.m_referenceAngle;var V=10*c.b2_linearSlop;var ab=Math.sqrt(am*am+al*al);var ak=t.Abs(ai);if(ab>V){Z*=1;Y*=1}this.m_mass.col1.x=ah+ag+W*W*Z+ae*ae*Y;this.m_mass.col2.x=(-W*X*Z)-ae*af*Y;this.m_mass.col3.x=(-W*Z)-ae*Y;this.m_mass.col1.y=this.m_mass.col2.x;this.m_mass.col2.y=ah+ag+X*X*Z+af*af*Y;this.m_mass.col3.y=X*Z+af*Y;this.m_mass.col1.z=this.m_mass.col3.x;this.m_mass.col2.z=this.m_mass.col3.y;this.m_mass.col3.z=Z+Y;var aa=new O();this.m_mass.Solve33(aa,(-am),(-al),(-ai));ao.m_sweep.c.x-=ah*aa.x;ao.m_sweep.c.y-=ah*aa.y;ao.m_sweep.a-=Z*(X*aa.y-W*aa.x+aa.z);an.m_sweep.c.x+=ag*aa.x;an.m_sweep.c.y+=ag*aa.y;an.m_sweep.a+=Y*(af*aa.y-ae*aa.x+aa.z);ao.SynchronizeTransform();an.SynchronizeTransform();return ab<=c.b2_linearSlop&&ak<=c.b2_angularSlop};Box2D.inherit(z,Box2D.Dynamics.Joints.b2JointDef);z.prototype.__super=Box2D.Dynamics.Joints.b2JointDef.prototype;z.b2WeldJointDef=function(){Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments);this.localAnchorA=new P();this.localAnchorB=new P()};z.prototype.b2WeldJointDef=function(){this.__super.b2JointDef.call(this);this.type=j.e_weldJoint;this.referenceAngle=0};z.prototype.Initialize=function(X,W,V){this.bodyA=X;this.bodyB=W;this.localAnchorA.SetV(this.bodyA.GetLocalPoint(V));this.localAnchorB.SetV(this.bodyB.GetLocalPoint(V));this.referenceAngle=this.bodyB.GetAngle()-this.bodyA.GetAngle()}})();(function(){var a=Box2D.Dynamics.b2DebugDraw;a.b2DebugDraw=function(){this.m_drawScale=1;this.m_lineThickness=1;this.m_alpha=1;this.m_fillAlpha=1;this.m_xformScale=1;var b=this;this.m_sprite={graphics:{clear:function(){b.m_ctx.clearRect(0,0,b.m_ctx.canvas.width,b.m_ctx.canvas.height)}}}};a.prototype._color=function(b,c){return"rgba("+((b&16711680)>>16)+","+((b&65280)>>8)+","+(b&255)+","+c+")"};a.prototype.b2DebugDraw=function(){this.m_drawFlags=0};a.prototype.SetFlags=function(b){if(b===undefined){b=0}this.m_drawFlags=b};a.prototype.GetFlags=function(){return this.m_drawFlags};a.prototype.AppendFlags=function(b){if(b===undefined){b=0}this.m_drawFlags|=b};a.prototype.ClearFlags=function(b){if(b===undefined){b=0}this.m_drawFlags&=~b};a.prototype.SetSprite=function(b){this.m_ctx=b};a.prototype.GetSprite=function(){return this.m_ctx};a.prototype.SetDrawScale=function(b){if(b===undefined){b=0}this.m_drawScale=b};a.prototype.GetDrawScale=function(){return this.m_drawScale};a.prototype.SetLineThickness=function(b){if(b===undefined){b=0}this.m_lineThickness=b;this.m_ctx.strokeWidth=b};a.prototype.GetLineThickness=function(){return this.m_lineThickness};a.prototype.SetAlpha=function(b){if(b===undefined){b=0}this.m_alpha=b};a.prototype.GetAlpha=function(){return this.m_alpha};a.prototype.SetFillAlpha=function(b){if(b===undefined){b=0}this.m_fillAlpha=b};a.prototype.GetFillAlpha=function(){return this.m_fillAlpha};a.prototype.SetXFormScale=function(b){if(b===undefined){b=0}this.m_xformScale=b};a.prototype.GetXFormScale=function(){return this.m_xformScale};a.prototype.DrawPolygon=function(c,f,b){if(!f){return}var e=this.m_ctx;var g=this.m_drawScale;e.beginPath();e.strokeStyle=this._color(b.color,this.m_alpha);e.moveTo(c[0].x*g,c[0].y*g);for(var d=1;d<f;d++){e.lineTo(c[d].x*g,c[d].y*g)}e.lineTo(c[0].x*g,c[0].y*g);e.closePath();e.stroke()};a.prototype.DrawSolidPolygon=function(c,f,b){if(!f){return}var e=this.m_ctx;var g=this.m_drawScale;e.beginPath();e.strokeStyle=this._color(b.color,this.m_alpha);e.fillStyle=this._color(b.color,this.m_fillAlpha);e.moveTo(c[0].x*g,c[0].y*g);for(var d=1;d<f;d++){e.lineTo(c[d].x*g,c[d].y*g)}e.lineTo(c[0].x*g,c[0].y*g);e.closePath();e.fill();e.stroke()};a.prototype.DrawCircle=function(c,b,d){if(!b){return}var e=this.m_ctx;var f=this.m_drawScale;e.beginPath();e.strokeStyle=this._color(d.color,this.m_alpha);e.arc(c.x*f,c.y*f,b*f,0,Math.PI*2,true);e.closePath();e.stroke()};a.prototype.DrawSolidCircle=function(d,c,g,e){if(!c){return}var f=this.m_ctx,h=this.m_drawScale,b=d.x*h,j=d.y*h;f.moveTo(0,0);f.beginPath();f.strokeStyle=this._color(e.color,this.m_alpha);f.fillStyle=this._color(e.color,this.m_fillAlpha);f.arc(b,j,c*h,0,Math.PI*2,true);f.moveTo(b,j);f.lineTo((d.x+g.x*c)*h,(d.y+g.y*c)*h);f.closePath();f.fill();f.stroke()};a.prototype.DrawSegment=function(f,e,b){var c=this.m_ctx,d=this.m_drawScale;c.strokeStyle=this._color(b.color,this.m_alpha);c.beginPath();c.moveTo(f.x*d,f.y*d);c.lineTo(e.x*d,e.y*d);c.closePath();c.stroke()};a.prototype.DrawTransform=function(c){var b=this.m_ctx,d=this.m_drawScale;b.beginPath();b.strokeStyle=this._color(16711680,this.m_alpha);b.moveTo(c.position.x*d,c.position.y*d);b.lineTo((c.position.x+this.m_xformScale*c.R.col1.x)*d,(c.position.y+this.m_xformScale*c.R.col1.y)*d);b.strokeStyle=this._color(65280,this.m_alpha);b.moveTo(c.position.x*d,c.position.y*d);b.lineTo((c.position.x+this.m_xformScale*c.R.col2.x)*d,(c.position.y+this.m_xformScale*c.R.col2.y)*d);b.closePath();b.stroke()}})();var i;for(i=0;i<Box2D.postDefs.length;++i){Box2D.postDefs[i]()}delete Box2D.postDefs;