YUI.add("inputex-datatable",function(c){var b=c.inputEx,a=c.inputEx.messages;c.namespace("inputEx.Plugin");b.Plugin.InputExDataTable=function(d){b.Plugin.InputExDataTable.superclass.constructor.call(this,d)};b.Plugin.InputExDataTable.NS="InputExDataTable";c.extend(b.Plugin.InputExDataTable,c.Plugin.Base,{initializer:function(){var d=this.get("host");this.enrichData();this.enrichColumns();this.addAddButton();if(!this.get("disableModifyFunc")){d.delegate("click",this.modifyRecord,"td.inputEx-DataTable-modify",this)}if(!this.get("disableDeleteFunc")){d.delegate("click",this.deleteRecord,"td.inputEx-DataTable-delete",this)}},enrichData:function(g){var d=this,f=this.get("host").get("data");f.each(function(e){if(!this.get("disableModifyFunc")){d.addModifyAttr(e)}if(!this.get("disableDeleteFunc")){d.addDeleteAttr(e)}})},enrichColumns:function(){if(!this.get("disableModifyFunc")){this.addModifyColumn()}if(!this.get("disableDeleteFunc")){this.addDeleteColumn()}},addAddButton:function(){if(!this.get("disableAddFunc")){var e=c.Node.create("<button id='addButton'>"+a.addButtonText+"</button"),d=this.get("panel");this.get("host").get("contentBox").append(e);e.on("click",function(f){d.set("headerContent",a.addItemHeader);d.get("field").clear();d.show()},this)}},modifyRecord:function(g){g.stopPropagation();var f=this.get("host").getRecord(g.currentTarget),d=this.get("panel");d.set("headerContent",a.modifyItemHeader);d.get("field").setValue(f.getAttrs());d.show()},deleteRecord:function(f){f.stopPropagation();var d=this.get("host").getRecord(f.currentTarget);if(!this.get("confirmDelete")||confirm(a.confirmDeletion)){this.get("host").get("data").remove(d)}},deleteExtraColumns:function(){if(!this.get("disableModifyFunc")){this.removeModifyColumn()}if(!this.get("disableDeleteFunc")){this.removeDeleteColumn()}},_initPanel:function(){var e=this;var d=new c.inputEx.Panel({centered:true,width:500,modal:true,zIndex:5,visible:false,inputEx:e.get("inputEx"),buttons:[{value:a.cancelText,action:function(f){f.preventDefault();d.hide()}},{value:a.saveText,action:function(j){j.preventDefault();var i=e.get("panel").get("field"),g=i.getValue(),h=e.get("host"),f;if(i.validate()){if(g.id){h.get("data").getById(g.id).setAttrs(g)}else{g.id=e.generateId(e.get("idSize"));var k=h.get("recordType");f=new k();f.setAttrs(g);e.addModifyAttr(f);e.addDeleteAttr(f);h.get("data").add(f)}d.hide()}}}]});d.render();return d},destructor:function(){var d=this,e=this.get("host").get("data");e.each(function(f){if(!this.get("disableModifyFunc")){d.delModifyAttr(f)}if(!this.get("disableDeleteFunc")){d.delDeleteAttr(f)}});this.deleteExtraColumns();if(!this.get("disableAddFunc")){c.one("#addButton").remove()}this.get("panel").destroy()},addModifyAttr:function(d){d.addAttr("modify")},addDeleteAttr:function(d){d.addAttr("delete")},delModifyAttr:function(d){d.removeAttr("modify")},delDeleteAttr:function(d){d.removeAttr("delete")},addModifyColumn:function(){this.get("host").addColumn({key:this.get("modifyColumnLabel"),className:"inputEx-DataTable-modify"})},addDeleteColumn:function(){this.get("host").addColumn({key:this.get("deleteColumnLabel"),className:"inputEx-DataTable-delete"})},removeModifyColumn:function(){this.get("host").removeColumn("modify")},removeDeleteColumn:function(){this.get("host").removeColumn("delete")},generateId:function(d){var f=this.get("prefixId"),e=d?d:5;f=f?f:"";return f+Math.floor(Math.random()*Math.pow(10,e))}},{ATTRS:{inputEx:{},prefixId:{value:""},idSize:{value:5},disableAddFunc:{value:false},disableModifyFunc:{value:false},disableDeleteFunc:{value:false},modifyColumnLabel:{value:a.modifyText},deleteColumnLabel:{value:a.deleteText},confirmDelete:{value:true},panel:{valueFn:"_initPanel",lazyAdd:true}}})},"",{requires:["inputex-group","inputex-panel","datatable"]});