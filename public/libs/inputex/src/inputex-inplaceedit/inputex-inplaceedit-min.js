YUI.add("inputex-inplaceedit",function(d){var c=d.Lang,a=d.inputEx,b="inputEx-";a.InPlaceEdit=function(e){a.InPlaceEdit.superclass.constructor.call(this,e);this.publish("openEditor");this.publish("closeEditor")};d.extend(a.InPlaceEdit,a.Field,{setOptions:function(e){a.InPlaceEdit.superclass.setOptions.call(this,e);this.options.visu=e.visu;this.options.editorField=e.editorField;this.options.buttonConfigs=e.buttonConfigs||[{type:"submit",value:a.messages.okEditor,className:"inputEx-Button "+b+"OkButton",onClick:{fn:this.onOkEditor,scope:this}},{type:"link",value:a.messages.cancelEditor,className:"inputEx-Button "+b+"CancelLink",onClick:{fn:this.onCancelEditor,scope:this}}];this.options.animColors=e.animColors||null},renderComponent:function(){this.renderVisuDiv();this.renderEditor()},renderEditor:function(){var g;this.editorContainer=a.cn("div",{className:b+"editor"},{display:"none"});this.editorField=a(this.options.editorField,this);var f=this.editorField.getEl();this.editorContainer.appendChild(f);d.one(f).addClass(b+"editorDiv");this.buttons=[];for(g=0;g<this.options.buttonConfigs.length;g++){var e=this.options.buttonConfigs[g];e.parentEl=this.editorContainer;this.buttons.push(new a.widget.Button(e))}this.editorContainer.appendChild(a.cn("div",null,{clear:"both"}));this.fieldContainer.appendChild(this.editorContainer)},onVisuMouseOver:function(f){if(this.disabled){return}if(this.colorAnim){this.colorAnim.stop(true)}a.sn(this.formattedContainer,null,{backgroundColor:this.options.animColors.from})},onVisuMouseOut:function(g){var h;if(this.disabled){return}if(this.colorAnim){this.colorAnim.stop(true)}if(!this.options.animColors){return}h={node:this.formattedContainer};if(this.options.animColors.from){h.from={backgroundColor:this.options.animColors.from}}if(this.options.animColors.from){h.to={backgroundColor:this.options.animColors.to}}this.colorAnim=new d.Anim(h);var f=this;this.colorAnim.on("end",function(){d.one(f.formattedContainer).setStyle("backgroundColor","")});this.colorAnim.run()},renderVisuDiv:function(){this.formattedContainer=a.cn("div",{className:"inputEx-InPlaceEdit-visu"});if(c.isFunction(this.options.formatDom)){this.formattedContainer.appendChild(this.options.formatDom(this.options.value))}else{if(c.isFunction(this.options.formatValue)){this.formattedContainer.innerHTML=this.options.formatValue(this.options.value)}else{this.formattedContainer.innerHTML=c.isUndefined(this.options.value)?a.messages.emptyInPlaceEdit:this.options.value}}this.fieldContainer.appendChild(this.formattedContainer)},initEvents:function(){d.one(this.formattedContainer).on("click",this.openEditor,this,true);if(this.options.animColors){d.one(this.formattedContainer).on("mouseover",this.onVisuMouseOver,this);d.one(this.formattedContainer).on("mouseout",this.onVisuMouseOut,this)}if(this.editorField.el){var e=this;d.on("keyup",function(f){e.onKeyUp(f)},"#"+d.one(this.editorField.el).get("id"));d.on("keydown",function(f){e.onKeyDown(f)},"#"+d.one(this.editorField.el).get("id"))}},onKeyUp:function(f){if(f.keyCode===13){this.onOkEditor(f)}if(f.keyCode===27){this.onCancelEditor(f)}},onKeyDown:function(f){if(f.keyCode===9){this.onOkEditor(f)}},onOkEditor:function(h){if(h){h.halt()}var g=this.editorField.getValue();this.setValue(g);this.closeEditor();var f=this;setTimeout(function(){f.fire("updated",g)},50)},onCancelEditor:function(f){if(f){f.halt()}this.closeEditor()},closeEditor:function(){this.editorContainer.style.display="none";this.formattedContainer.style.display="";this.fire("closeEditor")},enable:function(){this.disabled=false;a.sn(this.formattedContainer,{className:"inputEx-InPlaceEdit-visu"})},disable:function(){this.disabled=true;a.sn(this.formattedContainer,{className:"inputEx-InPlaceEdit-visu-disable"})},openEditor:function(){if(this.disabled){return}var e=this.getValue();this.editorContainer.style.display="";this.formattedContainer.style.display="none";if(!c.isUndefined(e)){this.editorField.setValue(e)}this.editorField.focus();if(this.editorField.el&&c.isFunction(this.editorField.el.setSelectionRange)&&(!!e&&!!e.length)){this.editorField.el.setSelectionRange(0,e.length)}this.fire("openEditor")},getValue:function(){var e=(this.editorContainer.style.display==="");return e?this.editorField.getValue():this.value},setValue:function(f,e){this.value=f;if(c.isUndefined(f)||f===""){a.renderVisu(this.options.visu,a.messages.emptyInPlaceEdit,this.formattedContainer)}else{a.renderVisu(this.options.visu,this.value,this.formattedContainer)}if(this.editorContainer.style.display===""){this.editorField.setValue(f)}a.InPlaceEdit.superclass.setValue.call(this,f,e)},close:function(){this.editorContainer.style.display="none";this.formattedContainer.style.display="";this.fire("openEditor")}});a.registerType("inplaceedit",a.InPlaceEdit,[{type:"type",label:"Editor",name:"editorField"}])},"3.1.0",{requires:["inputex-field","inputex-button","anim","inputex-visus"]});