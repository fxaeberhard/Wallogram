YUI.add("inputex-datepicker",function(c){var a=c.inputEx,b=c.Lang;a.DatePickerField=function(d){a.DatePickerField.superclass.constructor.call(this,d)};c.extend(a.DatePickerField,a.DateField,{setOptions:function(d){a.DatePickerField.superclass.setOptions.call(this,d);this.options.className=d.className?d.className:"inputEx-Field inputEx-DateField inputEx-PickerField inputEx-DatePickerField";this.options.readonly=b.isUndefined(d.readonly)?true:d.readonly;this.options.calendar=d.calendar||a.messages.defaultCalendarOpts;this.options.zIndex=d.zIndex||4},renderOverlay:function(){this.oOverlay=new c.Overlay({visible:false,zIndex:this.options.zIndex});this.oOverlay.render(this.fieldContainer);this.oOverlay.on("visibleChange",function(d){if(d.newVal){this.beforeShowOverlay();this.calendar.show();this.oOverlay.set("align",{node:this.button,points:[c.WidgetPositionAlign.TL,c.WidgetPositionAlign.BL]});this.outsideHandler=this.oOverlay.get("boundingBox").on("mousedownoutside",function(f){this.oOverlay.hide()},this)}else{this.calendar.hide();if(this.outsideHandler){this.outsideHandler.detach()}}},this)},_toggleOverlay:function(d){if(!this.oOverlay){this.renderOverlay();this.renderCalendar()}var f=this.oOverlay.get("visible")?"hide":"show";this.oOverlay[f]()},renderComponent:function(){a.DatePickerField.superclass.renderComponent.call(this);this.button=c.Node.create("<button>&nbsp;</button>").addClass("inputEx-DatePicker-button");this.button.appendTo(this.wrapEl);if(this.options.readonly){c.one(this.el).on("click",this._toggleOverlay,this)}this.button.on("click",this._toggleOverlay,this)},renderCalendar:function(){if(!!this.calendarRendered){return}this.calendar=new c.Calendar({width:"250px",showPrevMonth:true,showNextMonth:true,date:new Date()});this.calendar.setAttrs(this.options.calendar);this.calendar.render(this.oOverlay.get("contentBox"));this.calendar.on("selectionChange",function(e){var d=e.newSelection[0];this.setValue(d);this.oOverlay.hide()},this);this.calendarRendered=true},beforeShowOverlay:function(g){if(!!this.calendar){var d=this.getValue(true),f=this.validate();if(f&&!!d){this.calendar.set("date",d);this.calendar.deselectDates();this.calendar.selectDates(d)}}},close:function(){console.log("DATEPICKER CLOSE",this.oOverlay);if(this.oOverlay){this.oOverlay.hide()}},disable:function(){a.DatePickerField.superclass.disable.call(this);this.button.set("disabled",true)},enable:function(){a.DatePickerField.superclass.enable.call(this);this.button.set("disabled",false)}});a.messages.defaultCalendarOpts={navigator:true};a.registerType("datepicker",a.DatePickerField)},"3.1.0",{requires:["inputex-date","event-outside","node-event-delegate","overlay","calendar"]});