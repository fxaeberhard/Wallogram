YUI.add("inputex-menu",function(g){var d=g.inputEx,f=g.Lang,a=g.substitute,c=g.Node.create,e="vertical",b="horizontal";d.MenuField=function(h){d.MenuField.superclass.constructor.call(this,h)};d.MenuField.MENU_TEMPLATE='<div class="yui3-menu" id="{menu_id}"><div class="yui3-menu-content"><ul>{menu_items}</ul></div></div>';d.MenuField.MENU_ITEM_TEMPLATE='<li class="{item_class}"><a href="{href}" class="{label_class}">{label}</a>{submenu}</li>';g.extend(d.MenuField,d.Field,{setOptions:function(h){d.MenuField.superclass.setOptions.call(this,h);this.options.className=h.className?h.className:"inputEx-Field inputEx-MenuField";this.options.typeInvite=h.typeInvite||d.messages.menuTypeInvite;this.options.colorInvite=h.colorInvite||"FFFFFF";this.options.menuTrigger=h.menuTrigger||"click";this.options.menuOrientation=h.menuOrientation||e;this.options.menuItems=h.menuItems;this.options.menuConfig=h.menuConfig||{autoSubmenuDisplay:(this.options.menuTrigger=="mouseover")}},renderComponent:function(){this.hiddenEl=d.cn("input",{type:"hidden",name:this.options.name||"",value:this.options.value||""});this.fieldContainer.appendChild(this.hiddenEl);this.renderMenu(this.fieldContainer);this.setBackgroundColorOfRootLabel(this.options.colorInvite)},renderMenu:function(h){var j=this;this._textFromValue={};var i=function(r,k,q){if(q>5){throw new Error("MenuField : too much recursion, menuItems property should be 5 level deep at most.")}var m="",p=k.length,o,n,l;for(l=0;l<p;l++){o=k[l];if(f.isUndefined(o.text)&&!f.isUndefined(o.value)){o.text=o.value}if(f.isUndefined(o.value)&&!f.isUndefined(o.text)){o.value=o.text}n={label:o.text,href:"#"+o.value,submenu:"",label_class:"yui3-menuitem-content",item_class:o.classname};if(!f.isUndefined(o.submenu)){n.label_class="yui3-menu-label";n.submenu=i(o.value,o.submenu.itemdata,q+1)}else{n.item_class+=" yui3-menuitem";j._textFromValue[o.value]=o.text}m+=a(d.MenuField.MENU_ITEM_TEMPLATE,n)}return a(d.MenuField.MENU_TEMPLATE,{menu_id:r,menu_items:m})};this._menu=c(i(g.guid(),[{text:this.options.typeInvite,submenu:{itemdata:this.options.menuItems}}],0));if(this.options.menuOrientation===b){this._menu.addClass("yui3-menu-horizontal  yui3-menubuttonnav")}this._rootItemLabel=this._menu.one(".yui3-menu-label");if(this.options.menuOrientation===b){this._rootItemLabel.setContent("<em>"+this.options.typeInvite+"</em>");this._rootItemLabel=this._rootItemLabel.one("em")}this._menu.plug(g.Plugin.NodeMenuNav,this.options.menuConfig);this._menu.appendTo(h)},initEvents:function(){var h=this;this._menu.delegate("click",g.bind(this.onItemClick,this),"a");if(this.options.menuTrigger=="click"){this._menu.menuNav._rootMenu.on(["mousedown","click"],function(j){var i=h._menu.menuNav;i._toggleSubmenuDisplay.call(i,j)},this._menu.menuNav)}},setBackgroundColorOfRootLabel:function(h){this._menu.one(".yui3-menu-label").setStyle("backgroundColor",h)},onItemClick:function(j){var i=j.currentTarget,h;j.preventDefault();if(i.hasClass("yui3-menuitem-content")){h=i.getAttribute("href",2);this.setValue(h.substr(h.indexOf("#")+1),true);this._menu.menuNav._hideAllSubmenus(this._menu.menuNav._rootMenu)}},getValue:function(){return this.hiddenEl.value},setValue:function(i,h){this._rootItemLabel.setContent(this._textFromValue[i]||this.options.typeInvite);this.hiddenEl.value=(!!this._textFromValue[i])?i:"";d.MenuField.superclass.setValue.call(this,i,h)}});d.registerType("menu",d.MenuField)},"3.1.0",{requires:["inputex-field","node-event-delegate","node-menunav","substitute"]});