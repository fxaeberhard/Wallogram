YUI.add("inputex-jsonschema",function(c){var b=c.Lang,a=c.inputEx;a.JsonSchema={inputExToSchema:function(d){var g=d.type||"string",j=d||{};if(g=="group"){var e={type:"object",title:j.legend,properties:{}};for(var f=0;f<j.fields.length;f++){var h=j.fields[f];var k=h.name;e.properties[k]=a.JsonSchema.inputExToSchema(h)}return e}else{if(g=="number"){return{type:"number",optional:typeof j.required=="undefined"?true:!j.required,title:j.label}}else{if(g=="string"){return{type:"string",optional:typeof j.required=="undefined"?true:!j.required,title:j.label}}else{if(g=="text"){return{type:"string",format:"text",optional:typeof j.required=="undefined"?true:!j.required,title:j.label,_inputex:{rows:5,cols:50}}}else{if(g=="html"){return{type:"string",format:"html",optional:typeof j.required=="undefined"?true:!j.required,title:j.label,_inputex:{}}}else{if(g=="list"){return{type:"array",title:j.label,items:a.JsonSchema.inputExToSchema(j.elementType),_inputex:{}}}else{if(g=="email"){return{type:"string",optional:typeof j.required=="undefined"?true:!j.required,title:j.label,format:"email"}}else{if(g=="url"){return{type:"string",optional:typeof j.required=="undefined"?true:!j.required,title:j.label,format:"url"}}else{if(g=="time"){return{type:"string",optional:typeof j.required=="undefined"?true:!j.required,title:j.label,format:"time"}}else{if(g=="IPv4"){return{type:"string",optional:typeof j.required=="undefined"?true:!j.required,title:j.label,format:"ip-address"}}else{if(g=="color"){return{type:"string",optional:typeof j.required=="undefined"?true:!j.required,title:j.label,format:"color"}}else{if(g=="date"){return{type:"string",optional:typeof j.required=="undefined"?true:!j.required,title:j.label,format:"date"}}else{if(g=="multiselect"||g=="multiautocomplete"){return{type:"array",optional:typeof j.required=="undefined"?true:!j.required,title:j.label,items:typeof j.jsonSchemaRef=="undefined"?{type:"string"}:j.jsonSchemaRef,_inputex:j}}else{return{type:"string",title:j.label,optional:typeof j.required=="undefined"?true:!j.required,_inputex:j}}}}}}}}}}}}}}}};a.JsonSchema.Builder=function(e){var d=e||{};this.options=d;this.schemaToParamMap=d.schemaToParamMap||{title:"label",description:"description",_inputex:null};this.referenceResolver=d.referenceResolver||null;this.defaultOptions=d.defaultOptions||{};this.schemaIdentifierMap=d.schemaIdentifierMap||{}};a.JsonSchema.Builder.prototype={defaultReferenceResolver:function(d){return this.schemaIdentifierMap[d]||null},schemaToInputEx:function(f,r){var j={label:r,name:r};var s=this.schemaToParamMap;var h=f["$ref"];var w;if(h){var n=null;if(this.referenceResolver){n=this.referenceResolver(h)}if(n===null){n=this.defaultReferenceResolver(h)}if(n===null){throw new Error('Schema for property : "'+r+'" $references "'+h+'", not found')}n=c.mix({},n);for(var k in f){if(f.hasOwnProperty(k)&&b.isUndefined(n[k])&&k!="$ref"){n[k]=f[k]}}f=n}if(!f.optional){j.required=true}for(w in s){if(s.hasOwnProperty(w)){var m=s[w];var u=f[w];if(!b.isUndefined(u)){if(m===null){if(b.isObject(u)){for(var d in u){if(u.hasOwnProperty(d)){j[d]=u[d]}}}}else{j[m]=u}}}}if(!f.type){f.type="object"}var t=f.type;if(b.isArray(t)){if(t.length===0||(t.length==1&&t[0]=="any")){t="array"}else{t=t[0]}}j.type=t;if(!b.isUndefined(f["default"])){j.value=f["default"]}if(t=="array"){j.type="list";if(b.isObject(f.items)&&!b.isArray(f.items)){j.elementType=this.schemaToInputEx(f.items,r)}if(f.minItems){j.minItems=f.minItems}if(f.maxItems){j.maxItems=f.maxItems}}else{if(t=="object"){j.type="group";if(f.title&&b.isUndefined(j.legend)){j.legend=f.title}var q=[];if(r){j.name=r}if(!f._inputex||!f._inputex.fields){for(w in f.properties){if(f.properties.hasOwnProperty(w)){q.push(this.schemaToInputEx(f.properties[w],w))}}j.fields=q}}else{if(t=="string"&&(f["enum"]||f.choices)){j.type="select";if(f.choices){j.choices=[];for(var l=0;l<f.choices.length;l++){var g=f.choices[l];j.choices[l]={label:g.label,value:g.value}}}else{j.choices=[];for(var l=0;l<f["enum"].length;l++){var g=f["enum"][l];if(b.isObject(g)){j.choices[l]={label:g.label,value:g.value}}else{j.choices[l]={value:g}}}}}else{if(t=="string"){if(!b.isUndefined(f.pattern)&&b.isUndefined(j.regexp)){if(b.isString(f.pattern)){j.regexp=new RegExp(f.pattern)}else{j.regexp=f.pattern}}if(!b.isUndefined(f.maxLength)&&b.isUndefined(j.maxLength)){j.maxLength=f.maxLength}if(!b.isUndefined(f.minLength)&&b.isUndefined(j.minLength)){j.minLength=f.minLength}if(!b.isUndefined(f.readonly)&&b.isUndefined(j.readonly)){j.readonly=f.readonly}if(f.format){if(f.format=="html"){j.type="html"}else{if(f.format=="date"){j.type="date";j.tooltipIcon=true}else{if(f.format=="url"){j.type="url"}else{if(f.format=="email"){j.type="email"}else{if(f.format=="text"){j.type="text"}else{if(f.format=="time"){j.type="time"}else{if(f.format=="ip-address"){j.type="IPv4"}else{if(f.format=="color"){j.type="color"}}}}}}}}}}}}}if(!!f._inputex&&!!f._inputex["_type"]){j.type=f._inputex["_type"]}for(var e in this.defaultOptions){if(this.defaultOptions.hasOwnProperty(e)&&b.isUndefined(j[e])){j[e]=this.defaultOptions[e]}}return j},formFromInstance:function(g){if(!g||!g["$schema"]){throw new Error("Invalid json schema instance object. Object must have a '$schema' property.")}var d=this.schemaToInputEx(g["$schema"]);for(var e=0;e<d.fields.length;e++){var f=d.fields[e].name;d.fields[e].value=g[f]}return d}}},"3.1.0",{requires:["inputex"]});